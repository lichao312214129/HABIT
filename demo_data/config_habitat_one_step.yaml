# Habitat Analysis Configuration (One-Step Strategy)

# Run mode and pipeline settings (check these first!)
run_mode: train  # train (if you want to train a new model, set to train) or predict(if you want to use a pre-trained model, set to predict)
pipeline_path:   # Path to trained pipeline for predict mode (required for predict mode)

# Data paths
data_dir: H:\young_funding_dms
out_dir: H:\young_funding_dms_results

# Feature extraction settings (only needed for train mode)
FeatureConstruction:
  voxel_level:
    method: kinetic(raw(pre_contrast,params_file), raw(LAP,params_file), raw(PVP,params_file), raw(delay_3min,params_file), timestamps)
    params:
      params_file: ./parameter.yaml
      timestamps: F:\work\research\radiomics_TLSs\data\scan_time_of_phases.xlsx

  preprocessing_for_subject_level: 
    methods:
      - method: winsorize
        winsor_limits: [0.01, 0.01]
        global_normalize: false


# Habitat segmentation settings (only needed for train mode)
HabitatsSegmention:
  # Clustering strategy: "one_step", "two_step", or "direct_pooling"
  clustering_mode: one_step
  
  # Supervoxel clustering settings (used as habitat clustering in one_step mode)
  supervoxel:
    algorithm: kmeans
    n_clusters: 50
    random_state: 42
    max_iter: 300
    n_init: 10
    
    # Settings for one_step mode: automatic cluster number selection for each tumor
    one_step_settings:
      fixed_n_clusters: 10
      min_clusters: 2
      max_clusters: 10
      selection_method: inertia
      plot_validation_curves: true
  
# General settings
processes: 2  # Number of parallel processes
plot_curves: true  # Whether to generate and save plots
save_results_csv: true  # Whether to save results as CSV files
random_state: 42  # Random seed for reproducibility
debug: false  # Enable debug mode for detailed logging
