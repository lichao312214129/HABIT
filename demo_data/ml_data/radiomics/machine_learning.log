2026-01-18 16:25:10 - habit - INFO - [log_utils.py:127] - Log file initialized: F:\work\habit_project\demo_data\ml_data\radiomics\machine_learning.log
2026-01-18 16:25:10 - habit.cli.ml - INFO - [cmd_ml.py:54] - Starting machine learning training with config: ./demo_data/config_machine_learning_radiomics.yaml
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:70] - Using existing logging configuration from CLI entry point
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:79] - Initializing modeling with config: {'input': [{'path': 'F:\\work\\habit_project\\demo_data\\ml_data\\breast_cancer_dataset.csv', 'name': 'radiomics_', 'subject_id_col': 'subjID', 'label_col': 'label', 'features': None}], 'output': 'F:\\work\\habit_project\\demo_data\\ml_data\\radiomics', 'split_method': 'custom', 'train_ids_file': 'F:\\work\\habit_project\\demo_data\\ml_data\\train_ids.txt', 'test_ids_file': 'F:\\work\\habit_project\\demo_data\\ml_data\\test_ids.txt', 'normalization': {'method': 'z_score'}, 'feature_selection_methods': [{'method': 'variance', 'params': {'before_z_score': True, 'threshold': 0.2, 'plot_variances': True}}, {'method': 'statistical_test', 'params': {'p_threshold': 0.05, 'normality_test_threshold': 0.05, 'plot_importance': True, 'before_z_score': False, 'force_test': 'ttest'}}, {'method': 'vif', 'params': {'max_vif': 10, 'visualize': False, 'before_z_score': False}}, {'method': 'correlation', 'params': {'threshold': 0.8, 'method': 'spearman', 'visualize': False, 'before_z_score': False}}], 'models': {'LogisticRegression': {'params': {'random_state': 42, 'max_iter': 1000, 'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}}, 'AutoGluonTabular': {'params': {'path': 'F:\\work\\habit_project\\demo_data\\ml_data\\autogluon_models', 'label': 'label', 'time_limit': 30, 'random_state': 42, 'presets': 'high_quality', 'verbosity': 4, 'eval_metric': 'roc_auc'}}}, 'is_visualize': False, 'is_save_model': True}
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:94] - Available feature selectors: ['correlation', 'icc', 'lasso', 'stepwise', 'rfecv', 'anova', 'chi2', 'variance', 'statistical_test', 'stepwise_r', 'univariate_logistic', 'vif']
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:102] - Modeling initialization completed
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:115] - Reading data from multiple files: 1 files
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:146] - Reading file: F:\work\habit_project\demo_data\ml_data\breast_cancer_dataset.csv, Dataset name: radiomics_
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:147] - Subject ID column: subjID, Label column: label
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:152] - File loaded with shape: (569, 14)
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:172] - Using label column: label
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:178] - Using subject ID column: subjID
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:224] - Created initial merged dataframe with shape: (569, 12)
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:240] - Adding unified label column: label
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:245] - Final merged dataframe shape: (569, 13) with 12 features
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:263] - Converting data to numeric types
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:265] - Data converted to numeric types
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:269] - Missing values: label                                0
radiomics_compactness error          0
radiomics_concavity error            0
radiomics_concave points error       0
radiomics_symmetry error             0
radiomics_fractal dimension error    0
radiomics_worst radius               0
radiomics_worst texture              0
radiomics_worst perimeter            0
radiomics_worst area                 0
radiomics_worst smoothness           0
radiomics_worst compactness          0
radiomics_worst fractal dimension    0
dtype: int64
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:272] - Starting data preprocessing
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:273] - Sample size before removing missing values: 569
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:277] - Sample size after removing missing values: 569
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:287] - Data preprocessing completed
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:297] - Splitting data using method: custom
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:337] - Reading custom train IDs from F:\work\habit_project\demo_data\ml_data\train_ids.txt
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:414] - Reading subject IDs from file: F:\work\habit_project\demo_data\ml_data\train_ids.txt
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:443] - Parsed 300 subject IDs from line-by-line format
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:339] - Read 300 train subject IDs
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:341] - Reading custom test IDs from F:\work\habit_project\demo_data\ml_data\test_ids.txt
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:414] - Reading subject IDs from file: F:\work\habit_project\demo_data\ml_data\test_ids.txt
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:443] - Parsed 269 subject IDs from line-by-line format
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:343] - Read 269 test subject IDs
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:379] - Custom split completed: train=300, test=269
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:396] - Extracted features and labels: 12 features
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:454] - Saving train/test split information
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:468] - Split information saved to: F:\work\habit_project\demo_data\ml_data\radiomics\split_info.json
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:400] - Split information saved
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:489] - Checking for feature selection methods to run before normalization
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:514] - Running 1 feature selection methods before normalization
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:518] - Starting with 12 features
2026-01-18 16:25:10 - habit.modeling - INFO - [machine_learning.py:526] - Executing variance feature selection before normalization with params: {'before_z_score': True, 'threshold': 0.2, 'plot_variances': True}
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:547] - variance selected 4 features, removed 8 features
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:565] - Pre-normalization feature selection completed. Selected 4 features
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:587] - Starting data normalization using method: z_score
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:595] - Using StandardScaler (Z-score normalization)
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:636] - Fitting scaler on training data with shape: (300, 4)
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:638] - Transforming test data with shape: (269, 4)
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:647] - Data normalization completed using z_score method
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:666] - Starting feature selection
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:678] - Starting with 4 features
2026-01-18 16:25:11 - habit.modeling - INFO - [machine_learning.py:688] - Executing statistical_test feature selection with params: {'p_threshold': 0.05, 'normality_test_threshold': 0.05, 'plot_importance': True, 'before_z_score': False, 'force_test': 'ttest'}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:716] - statistical_test selected 4 features, removed 0 features
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:718] - Selected features: ['radiomics_worst radius', 'radiomics_worst texture', 'radiomics_worst perimeter', 'radiomics_worst area']
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:688] - Executing vif feature selection with params: {'max_vif': 10, 'visualize': False, 'before_z_score': False}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:716] - vif selected 2 features, removed 2 features
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:718] - Selected features: ['radiomics_worst area', 'radiomics_worst texture']
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:688] - Executing correlation feature selection with params: {'threshold': 0.8, 'method': 'spearman', 'visualize': False, 'before_z_score': False}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:716] - correlation selected 2 features, removed 0 features
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:718] - Selected features: ['radiomics_worst area', 'radiomics_worst texture']
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:736] - Feature selection completed. Final number of selected features: 2
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:750] - Feature selection results saved to: F:\work\habit_project\demo_data\ml_data\radiomics\feature_selection_results.json
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:761] - Starting model training
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:772] - Training 2 models: ['LogisticRegression', 'AutoGluonTabular']
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:776] - Training model: LogisticRegression with config: {'params': {'random_state': 42, 'max_iter': 1000, 'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:790] - Training model with 2 features
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:795] - Model LogisticRegression trained successfully
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:776] - Training model: AutoGluonTabular with config: {'params': {'path': 'F:\\work\\habit_project\\demo_data\\ml_data\\autogluon_models', 'label': 'label', 'time_limit': 30, 'random_state': 42, 'presets': 'high_quality', 'verbosity': 4, 'eval_metric': 'roc_auc'}}
2026-01-18 16:25:12 - habit.modeling - ERROR - [machine_learning.py:784] - Failed to create model AutoGluonTabular: Model 'AutoGluonTabular' not registered. Available models: ['LogisticRegression', 'RandomForest', 'SVM', 'XGBoost', 'AdaBoost', 'CustomEnsemble', 'DecisionTree', 'GradientBoosting', 'KNN', 'MLP', 'GaussianNB', 'MultinomialNB', 'BernoulliNB']
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:808] - Model training completed. Trained 1 models successfully
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:819] - Starting model evaluation
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:831] - Evaluating model: LogisticRegression
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:835] - Evaluating LogisticRegression on training set
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:838] - Training set metrics: {'accuracy': 0.9333333333333333, 'sensitivity': 0.9545454545454546, 'specificity': 0.910958904109589, 'ppv': 0.91875, 'npv': 0.95, 'auc': 0.9820761430350471, 'auc_ci_lower': 0.9704840580214635, 'auc_ci_high': 0.9936682780991419, 'hosmer_lemeshow_chi2': 5.7492184467114535, 'hosmer_lemeshow_p_value': 0.6752996204006105, 'spiegelhalter_z_statistic': -1.3753870547329284e-05, 'spiegelhalter_z_p_value': 0.9999890259990394}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:841] - Evaluating LogisticRegression on test set
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:844] - Test set metrics: {'accuracy': 0.9219330855018587, 'sensitivity': 0.9014778325123153, 'specificity': 0.9848484848484849, 'ppv': 0.9945652173913043, 'npv': 0.7647058823529411, 'auc': 0.9908195253022838, 'auc_ci_lower': 0.9821003308551982, 'auc_ci_high': 0.9995385775310323, 'hosmer_lemeshow_chi2': 42.519506496034616, 'hosmer_lemeshow_p_value': 1.0817229803006256e-06, 'spiegelhalter_z_statistic': 6.262778112497963, 'spiegelhalter_z_p_value': 3.7817859954714095e-10}
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:850] - Feature importance calculated for LogisticRegression
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:870] - Performance table generated
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:878] - Performance table saved
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:895] - Saving detailed prediction results
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:919] - Saving detailed prediction results
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:947] - Saved complete prediction results to: F:\work\habit_project\demo_data\ml_data\radiomics\all_prediction_results.csv
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:897] - Prediction results saved
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:905] - Saving trained models and preprocessing information
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:953] - Saving trained models and preprocessing information
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:978] - Saved complete model package to: F:\work\habit_project\demo_data\ml_data\radiomics\model_package.pkl
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:1075] - Saved model usage instructions to: F:\work\habit_project\demo_data\ml_data\radiomics\model_usage_instructions.txt
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:907] - Models and preprocessing information saved
2026-01-18 16:25:12 - habit.modeling - INFO - [machine_learning.py:912] - Model evaluation completed
