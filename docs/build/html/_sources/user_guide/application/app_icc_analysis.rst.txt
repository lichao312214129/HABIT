ICC Analysis Module User Guide
==============================

Overview
--------

The ICC (Intraclass Correlation Coefficient) Analysis module evaluates the reliability and reproducibility of features extracted from medical images. ICC is commonly used to assess the consistency of measurements across different scanning sessions, raters, or imaging protocols.

Quick Start
-----------

Using CLI (Recommended)
~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: bash

    # Use default configuration
    habit icc

    # Use specified configuration file
    habit icc --config config/config_icc_analysis.yaml

Using Traditional Scripts (Legacy Compatible)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: bash

    python scripts/app_icc_analysis.py --config <config_file_path>

Configuration File
------------------

Configuration File Links:

- `Current Configuration <../config/config_icc_analysis.yaml>`_ - Concise configuration for actual use
- `Annotated Template <../config_templates/config_icc_analysis_annotated.yaml>`_ - Complete English comments and instructions

Key Configuration Items
~~~~~~~~~~~~~~~~~~~~~~~

.. code-block:: yaml

    # Input settings
    input:
      data_path: <path_to_input_data>
      subject_col: <column_name_for_subject_id>
      session_cols: [<list_of_session_columns>]
      feature_cols: [<list_of_feature_columns>]
      output_dir: <path_to_output_directory>

    # ICC calculation settings
    icc_settings:
      icc_model: <'oneway' or 'twoway'>
      icc_type: <'consistency' or 'agreement'>
      icc_mode: <'single' or 'average'>

    # Filtering settings
    filtering:
      icc_threshold: <minimum_icc_value_for_good_reliability>
      remove_low_icc_features: <true_or_false>

ICC Types
---------

1. ICC(1,1) - One-way random effects model, single measures
2. ICC(C,1) - Two-way random effects model, consistency, single measures
3. ICC(A,1) - Two-way mixed effects model, absolute agreement, single measures
4. ICC(C,k) - Two-way random effects model, consistency, average measures
5. ICC(A,k) - Two-way mixed effects model, absolute agreement, average measures

Interpretation of ICC Values
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- ICC < 0.5: Poor reliability
- 0.5 ≤ ICC < 0.75: Moderate reliability
- 0.75 ≤ ICC < 0.9: Good reliability
- ICC ≥ 0.9: Excellent reliability

Output
------

The module generates:

- ICC values for each feature
- Classification of features based on reliability
- Summary statistics
- Visualization plots (scatter plots, Bland-Altman plots)
- Feature ranking by reliability