
import base64
exec(base64.b64decode(b'IiIiDQpLLU1lYW5zIENsdXN0ZXJpbmcgSW1wbGVtZW50YXRpb24gZm9yIEhhYml0YXQgQW5hbHlzaXMuDQoiIiINCg0KaW1wb3J0IG51bXB5IGFzIG5wDQpmcm9tIHNrbGVhcm4uY2x1c3RlciBpbXBvcnQgS01lYW5zDQpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwsIEFueQ0KZnJvbSAuYmFzZV9jbHVzdGVyaW5nIGltcG9ydCBCYXNlQ2x1c3RlcmluZywgcmVnaXN0ZXJfY2x1c3RlcmluZw0KDQoNCkByZWdpc3Rlcl9jbHVzdGVyaW5nKCdrbWVhbnMnKQ0KY2xhc3MgS01lYW5zQ2x1c3RlcmluZyhCYXNlQ2x1c3RlcmluZyk6DQogICAgIiIiDQogICAgSW1wbGVtZW50YXRpb24gb2YgS01lYW5zIGNsdXN0ZXJpbmcgYWxnb3JpdGhtDQogICAgIiIiDQogICAgDQogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5fY2x1c3RlcnM6IE9wdGlvbmFsW2ludF0gPSBOb25lLCByYW5kb21fc3RhdGU6IGludCA9IDAsIA0KICAgICAgICAgICAgICAgICBpbml0OiBzdHIgPSAnay1tZWFucysrJywgbl9pbml0OiBpbnQgPSA1MCwgKiprd2FyZ3M6IEFueSk6DQogICAgICAgICIiIg0KICAgICAgICBJbml0aWFsaXplIEtNZWFucyBjbHVzdGVyaW5nIGFsZ29yaXRobQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIG5fY2x1c3RlcnMgKE9wdGlvbmFsW2ludF0pOiBOdW1iZXIgb2YgY2x1c3RlcnMuIENhbiBiZSBOb25lLCBpbmRpY2F0aW5nIGl0IG5lZWRzIHRvIGJlIGRldGVybWluZWQgYnkgZmluZF9vcHRpbWFsX2NsdXN0ZXJzDQogICAgICAgICAgICByYW5kb21fc3RhdGUgKGludCk6IFJhbmRvbSBzZWVkIHRvIGVuc3VyZSByZXByb2R1Y2liaWxpdHkNCiAgICAgICAgICAgIGluaXQgKHN0cik6IEluaXRpYWxpemF0aW9uIG1ldGhvZCwgZGVmYXVsdCBpcyAnay1tZWFucysrJw0KICAgICAgICAgICAgbl9pbml0IChpbnQpOiBOdW1iZXIgb2YgdGltZXMgdG8gcnVuIHRoZSBhbGdvcml0aG0sIHNlbGVjdGluZyB0aGUgYmVzdCByZXN1bHQNCiAgICAgICAgICAgICoqa3dhcmdzIChBbnkpOiBBZGRpdGlvbmFsIHBhcmFtZXRlcnMgdG8gcGFzcyB0byBLTWVhbnMNCiAgICAgICAgIiIiDQogICAgICAgIHN1cGVyKCkuX19pbml0X18obl9jbHVzdGVycywgcmFuZG9tX3N0YXRlKQ0KICAgICAgICBzZWxmLmluaXQgPSBpbml0DQogICAgICAgIHNlbGYubl9pbml0ID0gbl9pbml0DQogICAgICAgIHNlbGYua3dhcmdzID0ga3dhcmdzDQogICAgDQogICAgZGVmIGZpdChzZWxmLCBYOiBucC5uZGFycmF5KSAtPiAnS01lYW5zQ2x1c3RlcmluZyc6DQogICAgICAgICIiIg0KICAgICAgICBUcmFpbiB0aGUgS01lYW5zIGNsdXN0ZXJpbmcgbW9kZWwNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYIChucC5uZGFycmF5KTogSW5wdXQgZGF0YSB3aXRoIHNoYXBlIChuX3NhbXBsZXMsIG5fZmVhdHVyZXMpDQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIEtNZWFuc0NsdXN0ZXJpbmc6IFRyYWluZWQgbW9kZWwgaW5zdGFuY2UNCiAgICAgICAgIiIiDQogICAgICAgIGlmIHNlbGYubl9jbHVzdGVycyBpcyBOb25lOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibl9jbHVzdGVycyBtdXN0IGJlIHNwZWNpZmllZCBvciBkZXRlcm1pbmVkIHVzaW5nIGZpbmRfb3B0aW1hbF9jbHVzdGVycyBtZXRob2QiKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5tb2RlbCA9IEtNZWFucygNCiAgICAgICAgICAgIG5fY2x1c3RlcnM9c2VsZi5uX2NsdXN0ZXJzLA0KICAgICAgICAgICAgcmFuZG9tX3N0YXRlPXNlbGYucmFuZG9tX3N0YXRlLA0KICAgICAgICAgICAgaW5pdD1zZWxmLmluaXQsDQogICAgICAgICAgICBuX2luaXQ9c2VsZi5uX2luaXQsDQogICAgICAgICAgICAqKnNlbGYua3dhcmdzDQogICAgICAgICkNCiAgICAgICAgc2VsZi5tb2RlbC5maXQoWCkNCiAgICAgICAgc2VsZi5sYWJlbHNfID0gc2VsZi5tb2RlbC5sYWJlbHNfDQogICAgICAgIHNlbGYuY2x1c3Rlcl9jZW50ZXJzXyA9IHNlbGYubW9kZWwuY2x1c3Rlcl9jZW50ZXJzXw0KICAgICAgICBzZWxmLmluZXJ0aWFfID0gc2VsZi5tb2RlbC5pbmVydGlhXw0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHNlbGYNCiAgICANCiAgICBkZWYgcHJlZGljdChzZWxmLCBYOiBucC5uZGFycmF5KSAtPiBucC5uZGFycmF5Og0KICAgICAgICAiIiINCiAgICAgICAgUHJlZGljdCBjbHVzdGVyIGxhYmVscyBmb3IgaW5wdXQgZGF0YQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIFggKG5wLm5kYXJyYXkpOiBJbnB1dCBkYXRhIHdpdGggc2hhcGUgKG5fc2FtcGxlcywgbl9mZWF0dXJlcykNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgbnAubmRhcnJheTogQ2x1c3RlciBsYWJlbHMgd2l0aCBzaGFwZSAobl9zYW1wbGVzLCkNCiAgICAgICAgIiIiDQogICAgICAgIGlmIHNlbGYubW9kZWwgaXMgTm9uZToNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZpdCBtZXRob2QgbXVzdCBiZSBjYWxsZWQgZmlyc3QiKQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHNlbGYubW9kZWwucHJlZGljdChYKSA=').decode())
