
import base64
exec(base64.b64decode(b'IiIiDQpWb3hlbC1sZXZlbCBsb2NhbCBlbnRyb3B5IGZlYXR1cmUgZXh0cmFjdG9yDQoNClRoaXMgbW9kdWxlIHByb3ZpZGVzIGEgZmVhdHVyZSBleHRyYWN0b3IgdGhhdCBjYWxjdWxhdGVzIGxvY2FsIGVudHJvcHkgZm9yIGVhY2ggdm94ZWwNCndpdGhpbiBhIG1hc2sgcmVnaW9uLiBMb2NhbCBlbnRyb3B5IGlzIGEgbWVhc3VyZSBvZiB0aGUgcmFuZG9tbmVzcyBvciBpbmZvcm1hdGlvbiBjb250ZW50DQppbiB0aGUgbG9jYWwgbmVpZ2hib3Job29kIG9mIGEgdm94ZWwuDQoNCkV4YW1wbGUgdXNhZ2U6DQogICAgYGBgcHl0aG9uDQogICAgZnJvbSBoYWJpdC5jb3JlLmhhYml0YXRfYW5hbHlzaXMuZmVhdHVyZXMgaW1wb3J0IExvY2FsRW50cm9weUV4dHJhY3Rvcg0KICAgIA0KICAgICMgSW5pdGlhbGl6ZSBleHRyYWN0b3Igd2l0aCBjdXN0b20gcGFyYW1ldGVycw0KICAgIGV4dHJhY3RvciA9IExvY2FsRW50cm9weUV4dHJhY3RvcigNCiAgICAgICAga2VybmVsX3NpemU9NSwgICMgNXg1eDUgbmVpZ2hib3Job29kDQogICAgICAgIGJpbnM9MzIsICAgICAgICAjIDMyIGludGVuc2l0eSBiaW5zIGZvciBoaXN0b2dyYW0NCiAgICApDQogICAgDQogICAgIyBFeHRyYWN0IGZlYXR1cmVzDQogICAgZmVhdHVyZXNfZGYgPSBleHRyYWN0b3IuZXh0cmFjdF9mZWF0dXJlcygNCiAgICAgICAgaW1hZ2VfZGF0YT0ncGF0aC90by9pbWFnZS5uaWkuZ3onLA0KICAgICAgICBtYXNrX2RhdGE9J3BhdGgvdG8vbWFzay5uaWkuZ3onDQogICAgKQ0KICAgIGBgYA0KIiIiDQoNCmltcG9ydCBvcw0KaW1wb3J0IGxvZ2dpbmcNCmltcG9ydCBudW1weSBhcyBucA0KaW1wb3J0IHBhbmRhcyBhcyBwZA0KaW1wb3J0IFNpbXBsZUlUSyBhcyBzaXRrDQpmcm9tIHNjaXB5IGltcG9ydCBuZGltYWdlDQpmcm9tIHR5cGluZyBpbXBvcnQgVW5pb24sIExpc3QsIERpY3QsIE9wdGlvbmFsLCBUdXBsZQ0KZnJvbSAuYmFzZV9mZWF0dXJlX2V4dHJhY3RvciBpbXBvcnQgQmFzZUZlYXR1cmVFeHRyYWN0b3IsIHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yDQpmcm9tIGhhYml0LnV0aWxzLnByb2dyZXNzX3V0aWxzIGltcG9ydCBDdXN0b21UcWRtDQoNCkByZWdpc3Rlcl9mZWF0dXJlX2V4dHJhY3RvcignbG9jYWxfZW50cm9weScpDQpjbGFzcyBMb2NhbEVudHJvcHlFeHRyYWN0b3IoQmFzZUZlYXR1cmVFeHRyYWN0b3IpOg0KICAgICIiIg0KICAgIEV4dHJhY3Qgdm94ZWwtbGV2ZWwgbG9jYWwgZW50cm9weSBmZWF0dXJlcyBmcm9tIGltYWdlIHdpdGhpbiBtYXNrIHJlZ2lvbg0KICAgIExvY2FsIGVudHJvcHkgaXMgYSBtZWFzdXJlIG9mIHRoZSByYW5kb21uZXNzIGluIHRoZSBsb2NhbCBuZWlnaGJvcmhvb2Qgb2YgYSB2b3hlbA0KICAgICIiIg0KICAgIA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqKmt3YXJncyk6DQogICAgICAgICIiIg0KICAgICAgICBJbml0aWFsaXplIGxvY2FsIGVudHJvcHkgZmVhdHVyZSBleHRyYWN0b3INCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICAqKmt3YXJnczogQWRkaXRpb25hbCBwYXJhbWV0ZXJzIGluY2x1ZGluZzoNCiAgICAgICAgICAgICAgICAtIGtlcm5lbF9zaXplOiBTaXplIG9mIHRoZSBsb2NhbCBuZWlnaGJvcmhvb2Qga2VybmVsIChkZWZhdWx0OiAzKQ0KICAgICAgICAgICAgICAgIC0gYmluczogTnVtYmVyIG9mIGJpbnMgZm9yIGhpc3RvZ3JhbSBjYWxjdWxhdGlvbiAoZGVmYXVsdDogMzIpDQogICAgICAgICIiIg0KICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQ0KICAgICAgICBzZWxmLmtlcm5lbF9zaXplID0ga3dhcmdzLmdldCgna2VybmVsX3NpemUnLCAzKQ0KICAgICAgICBzZWxmLmJpbnMgPSBrd2FyZ3MuZ2V0KCdiaW5zJywgMzIpDQogICAgICAgIHNlbGYuZmVhdHVyZV9uYW1lcyA9IGYnbG9jYWxfZW50cm9weS17a3dhcmdzWyJpbWFnZSJdfScNCiAgICANCiAgICBkZWYgX2NhbGN1bGF0ZV9lbnRyb3B5KHNlbGYsIGltYWdlX2FycmF5OiBucC5uZGFycmF5LCBtYXNrX2FycmF5OiBucC5uZGFycmF5KSAtPiBucC5uZGFycmF5Og0KICAgICAgICAiIiINCiAgICAgICAgQ2FsY3VsYXRlIGxvY2FsIGVudHJvcHkgZm9yIGVhY2ggdm94ZWwgdXNpbmcgc2NpcHkubmRpbWFnZSBmb3IgZmFzdGVyIHByb2Nlc3NpbmcNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBpbWFnZV9hcnJheTogM0QgaW1hZ2UgYXJyYXkNCiAgICAgICAgICAgIG1hc2tfYXJyYXk6IDNEIG1hc2sgYXJyYXkNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgbnAubmRhcnJheTogTG9jYWwgZW50cm9weSB2YWx1ZXMgZm9yIGVhY2ggdm94ZWwgaW4gdGhlIG1hc2sNCiAgICAgICAgIiIiDQogICAgICAgICMgQ3JlYXRlIHByb2dyZXNzIGJhciBmb3IgdHJhY2tpbmcNCiAgICAgICAgcGJhciA9IEN1c3RvbVRxZG0odG90YWw9NCwgZGVzYz0iQ2FsY3VsYXRpbmcgbG9jYWwgZW50cm9weSIpDQogICAgICAgIA0KICAgICAgICAjIE5vcm1hbGl6ZSBpbWFnZSB0byBbMCwgMV0gZm9yIGVudHJvcHkgY2FsY3VsYXRpb24NCiAgICAgICAgaW1nX21pbiA9IG5wLm1pbihpbWFnZV9hcnJheSkNCiAgICAgICAgaW1nX21heCA9IG5wLm1heChpbWFnZV9hcnJheSkNCiAgICAgICAgaWYgaW1nX21heCA+IGltZ19taW46DQogICAgICAgICAgICBub3JtX2ltYWdlID0gKGltYWdlX2FycmF5IC0gaW1nX21pbikgLyAoaW1nX21heCAtIGltZ19taW4pDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICAjIEhhbmRsZSBjb25zdGFudCBpbWFnZSBjYXNlDQogICAgICAgICAgICBub3JtX2ltYWdlID0gbnAuemVyb3NfbGlrZShpbWFnZV9hcnJheSkNCiAgICAgICAgcGJhci51cGRhdGUoMSkNCiAgICAgICAgDQogICAgICAgICMgRGVmaW5lIGtlcm5lbCBzaXplIChtdXN0IGJlIG9kZCkNCiAgICAgICAgaWYgc2VsZi5rZXJuZWxfc2l6ZSAlIDIgPT0gMDoNCiAgICAgICAgICAgIGtlcm5lbF9zaXplID0gc2VsZi5rZXJuZWxfc2l6ZSArIDENCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGtlcm5lbF9zaXplID0gc2VsZi5rZXJuZWxfc2l6ZQ0KICAgICAgICAgICAgDQogICAgICAgICMgQ3JlYXRlIGEgZm9vdHByaW50IGZvciB0aGUgbG9jYWwgbmVpZ2hib3Job29kDQogICAgICAgIGZvb3RwcmludCA9IG5wLm9uZXMoKGtlcm5lbF9zaXplLCBrZXJuZWxfc2l6ZSwga2VybmVsX3NpemUpKQ0KICAgICAgICANCiAgICAgICAgIyBDYWxjdWxhdGUgZW50cm9weSBmb3IgdGhlIGVudGlyZSBpbWFnZSB1c2luZyBzY2lweS5uZGltYWdlDQogICAgICAgICMgRmlyc3QgZGlzY3JldGl6ZSB0aGUgaW1hZ2UgaW50byBiaW5zDQogICAgICAgIGJpbm5lZF9pbWFnZSA9IG5wLnJvdW5kKG5vcm1faW1hZ2UgKiAoc2VsZi5iaW5zIC0gMSkpLmFzdHlwZShpbnQpDQogICAgICAgIHBiYXIudXBkYXRlKDEpDQogICAgICAgIA0KICAgICAgICAjIEluaXRpYWxpemUgZW50cm9weSBtYXANCiAgICAgICAgZW50cm9weV9tYXAgPSBucC56ZXJvc19saWtlKG5vcm1faW1hZ2UsIGR0eXBlPWZsb2F0KQ0KICAgICAgICANCiAgICAgICAgIyBGb3IgZWFjaCBwb3NzaWJsZSB2YWx1ZSBpbiB0aGUgYmlubmVkIGltYWdlDQogICAgICAgIGZvciBpIGluIHJhbmdlKHNlbGYuYmlucyk6DQogICAgICAgICAgICAjIENyZWF0ZSBhIGJpbmFyeSBtYXAgZm9yIHRoaXMgYmluIHZhbHVlDQogICAgICAgICAgICBiaW5fbWFwID0gKGJpbm5lZF9pbWFnZSA9PSBpKS5hc3R5cGUoZmxvYXQpDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgQ291bnQgb2NjdXJyZW5jZXMgb2YgdGhpcyB2YWx1ZSBpbiBlYWNoIG5laWdoYm9yaG9vZA0KICAgICAgICAgICAgY291bnRfbWFwID0gbmRpbWFnZS5jb252b2x2ZShiaW5fbWFwLCBmb290cHJpbnQsIG1vZGU9J2NvbnN0YW50JywgY3ZhbD0wLjApDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgQ2FsY3VsYXRlIHByb2JhYmlsaXR5IChhdm9pZCBkaXZpc2lvbiBieSB6ZXJvKQ0KICAgICAgICAgICAgdG90YWxfdm94ZWxzID0ga2VybmVsX3NpemUqKjMgICMgVG90YWwgdm94ZWxzIGluIHRoZSBuZWlnaGJvcmhvb2QNCiAgICAgICAgICAgIHByb2JfbWFwID0gY291bnRfbWFwIC8gdG90YWxfdm94ZWxzDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgVXBkYXRlIGVudHJvcHkgbWFwIChoYW5kbGluZyB6ZXJvcyB0byBhdm9pZCBsb2coMCkpDQogICAgICAgICAgICB3aXRoIG5wLmVycnN0YXRlKGRpdmlkZT0naWdub3JlJywgaW52YWxpZD0naWdub3JlJyk6DQogICAgICAgICAgICAgICAgZW50cm9weV91cGRhdGUgPSAtcHJvYl9tYXAgKiBucC5sb2cyKHByb2JfbWFwKQ0KICAgICAgICAgICAgICAgIGVudHJvcHlfdXBkYXRlW35ucC5pc2Zpbml0ZShlbnRyb3B5X3VwZGF0ZSldID0gMA0KICAgICAgICAgICAgICAgIGVudHJvcHlfbWFwICs9IGVudHJvcHlfdXBkYXRlDQogICAgICAgIA0KICAgICAgICBwYmFyLnVwZGF0ZSgxKQ0KICAgICAgICANCiAgICAgICAgIyBFeHRyYWN0IGVudHJvcHkgdmFsdWVzIGZvciBtYXNrIHZveGVscw0KICAgICAgICBtYXNrX2Nvb3JkcyA9IG5wLndoZXJlKG1hc2tfYXJyYXkgPiAwKQ0KICAgICAgICBlbnRyb3B5X3ZhbHVlcyA9IGVudHJvcHlfbWFwW21hc2tfY29vcmRzXQ0KICAgICAgICANCiAgICAgICAgcGJhci51cGRhdGUoMSkNCiAgICAgICAgDQogICAgICAgIHJldHVybiBlbnRyb3B5X3ZhbHVlcw0KICAgICAgICANCiAgICBkZWYgZXh0cmFjdF9mZWF0dXJlcyhzZWxmLCBpbWFnZV9kYXRhOiBVbmlvbltzdHIsIHNpdGsuSW1hZ2VdLA0KICAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tfZGF0YTogVW5pb25bc3RyLCBzaXRrLkltYWdlXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJncykgLT4gcGQuRGF0YUZyYW1lOg0KICAgICAgICAiIiINCiAgICAgICAgRXh0cmFjdCBsb2NhbCBlbnRyb3B5IGZlYXR1cmVzIGZyb20gaW1hZ2Ugd2l0aGluIG1hc2sgcmVnaW9uDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgaW1hZ2VfZGF0YTogUGF0aCB0byBpbWFnZSBmaWxlIG9yIFNpbXBsZUlUSyBpbWFnZSBvYmplY3QNCiAgICAgICAgICAgIG1hc2tfZGF0YTogUGF0aCB0byBtYXNrIGZpbGUgb3IgU2ltcGxlSVRLIG1hc2sgb2JqZWN0DQogICAgICAgICAgICAqKmt3YXJnczogQWRkaXRpb25hbCBwYXJhbWV0ZXJzOg0KICAgICAgICAgICAgICAgIC0ga2VybmVsX3NpemU6IFNpemUgb2YgdGhlIGxvY2FsIG5laWdoYm9yaG9vZCBrZXJuZWwNCiAgICAgICAgICAgICAgICAtIGJpbnM6IE51bWJlciBvZiBiaW5zIGZvciBoaXN0b2dyYW0gY2FsY3VsYXRpb24NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgcGQuRGF0YUZyYW1lOiBEYXRhRnJhbWUgd2l0aCBsb2NhbCBlbnRyb3B5IHZhbHVlcyBmb3IgZWFjaCB2b3hlbCBpbiB0aGUgbWFzaw0KICAgICAgICAiIiINCiAgICAgICAgICAgIA0KICAgICAgICAjIExvYWQgaW1hZ2UNCiAgICAgICAgaWYgaXNpbnN0YW5jZShpbWFnZV9kYXRhLCBzdHIpOg0KICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoaW1hZ2VfZGF0YSk6DQogICAgICAgICAgICAgICAgaW1hZ2UgPSBzaXRrLlJlYWRJbWFnZShpbWFnZV9kYXRhKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICByYWlzZSBGaWxlTm90Rm91bmRFcnJvcihmIkltYWdlIGZpbGUgbm90IGZvdW5kOiB7aW1hZ2VfZGF0YX0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgaW1hZ2UgPSBpbWFnZV9kYXRhDQogICAgICAgICAgICANCiAgICAgICAgIyBMb2FkIG1hc2sNCiAgICAgICAgaWYgaXNpbnN0YW5jZShtYXNrX2RhdGEsIHN0cik6DQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhtYXNrX2RhdGEpOg0KICAgICAgICAgICAgICAgIG1hc2sgPSBzaXRrLlJlYWRJbWFnZShtYXNrX2RhdGEpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHJhaXNlIEZpbGVOb3RGb3VuZEVycm9yKGYiTWFzayBmaWxlIG5vdCBmb3VuZDoge21hc2tfZGF0YX0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbWFzayA9IG1hc2tfZGF0YQ0KICAgICAgICAgICAgDQogICAgICAgICMgQ29udmVydCB0byBudW1weSBhcnJheXMNCiAgICAgICAgaW1hZ2VfYXJyYXkgPSBzaXRrLkdldEFycmF5RnJvbUltYWdlKGltYWdlKQ0KICAgICAgICBtYXNrX2FycmF5ID0gc2l0ay5HZXRBcnJheUZyb21JbWFnZShtYXNrKQ0KICAgICAgICANCiAgICAgICAgIyBDaGVjayBpZiBtYXNrIGhhcyBub24temVybyB2YWx1ZXMNCiAgICAgICAgaWYgbnAuc3VtKG1hc2tfYXJyYXkgPiAwKSA9PSAwOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTWFzayBoYXMgbm8gbm9uLXplcm8gdmFsdWVzLCBjYW5ub3QgZXh0cmFjdCBmZWF0dXJlcyIpDQogICAgICAgIA0KICAgICAgICB0cnk6DQogICAgICAgICAgICAjIENhbGN1bGF0ZSBsb2NhbCBlbnRyb3B5IGZvciBlYWNoIHZveGVsIGluIHRoZSBtYXNrDQogICAgICAgICAgICBlbnRyb3B5X3ZhbHVlcyA9IHNlbGYuX2NhbGN1bGF0ZV9lbnRyb3B5KGltYWdlX2FycmF5LCBtYXNrX2FycmF5KQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIENyZWF0ZSBEYXRhRnJhbWUNCiAgICAgICAgICAgIGZlYXR1cmVfZGYgPSBwZC5EYXRhRnJhbWUoew0KICAgICAgICAgICAgICAgIHNlbGYuZmVhdHVyZV9uYW1lczogZW50cm9weV92YWx1ZXMNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiBmZWF0dXJlX2RmDQogICAgICAgICAgICANCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgbG9nZ2luZy5lcnJvcihmIkZhaWxlZCB0byBleHRyYWN0IGxvY2FsIGVudHJvcHkgZmVhdHVyZXM6IHtzdHIoZSl9IikNCiAgICAgICAgICAgIHJhaXNlDQogICAgDQogICAgZGVmIGdldF9mZWF0dXJlX25hbWVzKHNlbGYpIC0+IExpc3Rbc3RyXToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBmZWF0dXJlIG5hbWVzDQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgTGlzdFtzdHJdOiBMaXN0IG9mIGZlYXR1cmUgbmFtZXMNCiAgICAgICAgIiIiDQogICAgICAgIHJldHVybiBzZWxmLmZlYXR1cmVfbmFtZXMg').decode())
