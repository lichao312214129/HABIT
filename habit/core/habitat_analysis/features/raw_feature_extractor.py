
import base64
exec(base64.b64decode(b'IiIiDQpSYXcgZmVhdHVyZSBleHRyYWN0b3IgdGhhdCBleHRyYWN0cyByYXcgaW1hZ2UgaW50ZW5zaXRpZXMgZnJvbSBST0kNCiIiIg0KDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBwYW5kYXMgYXMgcGQNCmltcG9ydCBTaW1wbGVJVEsgYXMgc2l0aw0KaW1wb3J0IG9zDQpmcm9tIHR5cGluZyBpbXBvcnQgVW5pb24sIExpc3QNCmZyb20gLmJhc2VfZmVhdHVyZV9leHRyYWN0b3IgaW1wb3J0IEJhc2VGZWF0dXJlRXh0cmFjdG9yLCByZWdpc3Rlcl9mZWF0dXJlX2V4dHJhY3RvciwgXA0KICAgIHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yDQoNCg0KQHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yKCdyYXcnKQ0KY2xhc3MgUmF3RmVhdHVyZUV4dHJhY3RvcihCYXNlRmVhdHVyZUV4dHJhY3Rvcik6DQogICAgIiIiDQogICAgU2ltcGxlIGZlYXR1cmUgZXh0cmFjdG9yIHRoYXQgZGlyZWN0bHkgZXh0cmFjdHMgaW1hZ2UgaW50ZW5zaXRpZXMgZnJvbSBST0kNCg0KICAgIFRoaXMgZXh0cmFjdG9yIHdvcmtzIHdpdGg6DQogICAgMS4gSW1hZ2UgcGF0aHMgYW5kIG1hc2sgcGF0aHMNCiAgICAyLiBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0cyBhbmQgbWFzayBvYmplY3RzDQogICAgIiIiDQoNCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpIC0+IE5vbmU6DQogICAgICAgICIiIg0KICAgICAgICBJbml0aWFsaXplIHRoZSByYXcgZmVhdHVyZSBleHRyYWN0b3INCg0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgKiprd2FyZ3M6IFBhcmFtZXRlcnMgdGhhdCB3aWxsIGJlIHBhc3NlZCB0byB0aGUgcGFyZW50IGNsYXNzDQogICAgICAgICIiIg0KICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQ0KDQogICAgZGVmIGV4dHJhY3RfZmVhdHVyZXMoc2VsZiwgaW1hZ2VfZGF0YTogVW5pb25bc3RyLCBzaXRrLkltYWdlXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBtYXNrX2RhdGE6IFVuaW9uW3N0ciwgc2l0ay5JbWFnZV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgKiprd2FyZ3MpIC0+IG5wLm5kYXJyYXk6DQogICAgICAgICIiIg0KICAgICAgICBFeHRyYWN0IHJhdyB2b3hlbCB2YWx1ZXMgZnJvbSBpbWFnZSB3aXRoaW4gbWFzayByZWdpb24NCg0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgaW1hZ2VfZGF0YTogUGF0aCB0byBpbWFnZSBmaWxlIG9yIFNpbXBsZUlUSyBpbWFnZSBvYmplY3QNCiAgICAgICAgICAgIG1hc2tfZGF0YTogUGF0aCB0byBtYXNrIGZpbGUgb3IgU2ltcGxlSVRLIG1hc2sgb2JqZWN0DQoNCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIHBkLkRhdGFGcmFtZTogRXh0cmFjdGVkIHZveGVsIHZhbHVlcw0KICAgICAgICAiIiINCiAgICAgICAgIyDliqDovb3lm77lg48NCiAgICAgICAgaWYgaXNpbnN0YW5jZShpbWFnZV9kYXRhLCBzdHIpOg0KICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoaW1hZ2VfZGF0YSk6DQogICAgICAgICAgICAgICAgaW1hZ2UgPSBzaXRrLlJlYWRJbWFnZShpbWFnZV9kYXRhKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICByYWlzZSBGaWxlTm90Rm91bmRFcnJvcihmIkltYWdlIGZpbGUgbm90IGZvdW5kOiB7aW1hZ2VfZGF0YX0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgaW1hZ2UgPSBpbWFnZV9kYXRhDQoNCiAgICAgICAgIyDliqDovb3mjqnnoIENCiAgICAgICAgaWYgaXNpbnN0YW5jZShtYXNrX2RhdGEsIHN0cik6DQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhtYXNrX2RhdGEpOg0KICAgICAgICAgICAgICAgIG1hc2sgPSBzaXRrLlJlYWRJbWFnZShtYXNrX2RhdGEpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHJhaXNlIEZpbGVOb3RGb3VuZEVycm9yKGYiTWFzayBmaWxlIG5vdCBmb3VuZDoge21hc2tfZGF0YX0iKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbWFzayA9IG1hc2tfZGF0YQ0KDQogICAgICAgICMg6L2s5o2i5Li6bnVtcHnmlbDnu4QNCiAgICAgICAgaW1hZ2VfYXJyYXkgPSBzaXRrLkdldEFycmF5RnJvbUltYWdlKGltYWdlKQ0KICAgICAgICBtYXNrX2FycmF5ID0gc2l0ay5HZXRBcnJheUZyb21JbWFnZShtYXNrKQ0KDQogICAgICAgICMg5o+Q5Y+W5o6p56CB5YaF55qE5YC8DQogICAgICAgIHJvaV9tYXNrID0gbWFza19hcnJheSA+IDANCiAgICAgICAgaWYgbnAuc3VtKHJvaV9tYXNrKSA9PSAwOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTWFzayBoYXMgbm8gbm9uLXplcm8gdmFsdWVzLCBjYW5ub3QgZXh0cmFjdCBmZWF0dXJlcyIpDQoNCiAgICAgICAgIyDmj5Dlj5bmjqnnoIHlhoXnmoTljp/lp4vlgLwNCiAgICAgICAgdm94ZWxfdmFsdWVzID0gaW1hZ2VfYXJyYXlbcm9pX21hc2tdDQoNCiAgICAgICAgIyDlpoLmnpzmmK/ljZXpgJrpgZPlm77lg4/vvIzlsIblhbbovazmjaLkuLoyROaVsOe7hCBbbl92b3hlbHMsIDFdDQogICAgICAgIGlmIGxlbih2b3hlbF92YWx1ZXMuc2hhcGUpID09IDE6DQogICAgICAgICAgICB2b3hlbF92YWx1ZXMgPSB2b3hlbF92YWx1ZXMucmVzaGFwZSgtMSwgMSkNCg0KICAgICAgICAjIHRvIGRmDQogICAgICAgIHZveGVsX3ZhbHVlcyA9IHBkLkRhdGFGcmFtZSh2b3hlbF92YWx1ZXMsIGNvbHVtbnM9W2YncmF3LXtrd2FyZ3NbImltYWdlIl19J10pDQoNCiAgICAgICAgc2VsZi5mZWF0dXJlX25hbWVzID0gW2YncmF3LXtrd2FyZ3NbImltYWdlIl19J10gICMg6K6+572u54m55b6B5ZCN56ew5Li6ICdyYXdfaW50ZW5zaXR5J++8jOihqOekuuaPkOWPlueahOWOn+Wni+W8uuW6puWAvA0KICAgICAgICByZXR1cm4gdm94ZWxfdmFsdWVzDQogICAgDQogICAgZGVmIGdldF9mZWF0dXJlX25hbWVzKHNlbGYpIC0+IExpc3Rbc3RyXToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBmZWF0dXJlIG5hbWVzDQoNCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIExpc3Rbc3RyXTogTGlzdCBvZiBmZWF0dXJlIG5hbWVzDQogICAgICAgICIiIg0KICAgICAgICByZXR1cm4gc2VsZi5mZWF0dXJlX25hbWVz').decode())
