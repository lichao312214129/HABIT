
import base64
exec(base64.b64decode(b'IiIiDQpCYXNlIGNsYXNzIGZvciBmZWF0dXJlIGV4dHJhY3Rpb24NCiIiIg0KDQpmcm9tIGFiYyBpbXBvcnQgQUJDLCBhYnN0cmFjdG1ldGhvZA0KaW1wb3J0IG51bXB5IGFzIG5wDQppbXBvcnQgaW1wb3J0bGliDQppbXBvcnQgaW5zcGVjdA0KaW1wb3J0IG9zDQppbXBvcnQgcGtndXRpbA0KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIExpc3QsIEFueSwgVHlwZSwgT3B0aW9uYWwNCg0KIyBGZWF0dXJlIGV4dHJhY3RvciByZWdpc3RyeQ0KX0ZFQVRVUkVfRVhUUkFDVE9SX1JFR0lTVFJZID0ge30NCg0KZGVmIHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yKG5hbWU6IHN0cik6DQogICAgIiIiDQogICAgRGVjb3JhdG9yIGZvciByZWdpc3RlcmluZyBmZWF0dXJlIGV4dHJhY3RvciBjbGFzc2VzDQogICAgDQogICAgQXJnczoNCiAgICAgICAgbmFtZSAoc3RyKTogTmFtZSBvZiB0aGUgZmVhdHVyZSBleHRyYWN0b3INCiAgICANCiAgICBSZXR1cm5zOg0KICAgICAgICBjYWxsYWJsZTogRGVjb3JhdG9yIGZ1bmN0aW9uDQogICAgIiIiDQogICAgZGVmIGRlY29yYXRvcihjbHMpOg0KICAgICAgICBfRkVBVFVSRV9FWFRSQUNUT1JfUkVHSVNUUllbbmFtZS5sb3dlcigpXSA9IGNscw0KICAgICAgICByZXR1cm4gY2xzDQogICAgcmV0dXJuIGRlY29yYXRvcg0KDQpkZWYgZ2V0X2ZlYXR1cmVfZXh0cmFjdG9yKG5hbWU6IHN0ciwgKiprd2FyZ3MpIC0+ICdCYXNlRmVhdHVyZUV4dHJhY3Rvcic6DQogICAgIiIiDQogICAgR2V0IGZlYXR1cmUgZXh0cmFjdG9yIGNsYXNzIGJ5IG5hbWUNCiAgICANCiAgICBBcmdzOg0KICAgICAgICBuYW1lIChzdHIpOiBOYW1lIG9mIHRoZSBmZWF0dXJlIGV4dHJhY3Rvcg0KICAgICAgICAqKmt3YXJnczogUGFyYW1ldGVycyB0byBwYXNzIHRvIHRoZSBmZWF0dXJlIGV4dHJhY3RvciBjb25zdHJ1Y3Rvcg0KICAgIA0KICAgIFJldHVybnM6DQogICAgICAgIEJhc2VGZWF0dXJlRXh0cmFjdG9yOiBGZWF0dXJlIGV4dHJhY3RvciBpbnN0YW5jZQ0KICAgIA0KICAgIFJhaXNlczoNCiAgICAgICAgVmFsdWVFcnJvcjogSWYgdGhlIGZlYXR1cmUgZXh0cmFjdG9yIGlzIG5vdCBmb3VuZA0KICAgICIiIg0KICAgICMgTGF6eSBkaXNjb3Zlcnkgb2YgZmVhdHVyZSBleHRyYWN0b3JzIHRvIGF2b2lkIGNpcmN1bGFyIGltcG9ydHMNCiAgICBpZiBub3QgX0ZFQVRVUkVfRVhUUkFDVE9SX1JFR0lTVFJZOg0KICAgICAgICBkaXNjb3Zlcl9mZWF0dXJlX2V4dHJhY3RvcnMoKQ0KICAgICAgICANCiAgICAjIEZpcnN0IHRyeSB0byBmaW5kIHJlZ2lzdGVyZWQgZmVhdHVyZSBleHRyYWN0b3JzDQogICAgaWYgbmFtZS5sb3dlcigpIGluIF9GRUFUVVJFX0VYVFJBQ1RPUl9SRUdJU1RSWToNCiAgICAgICAgcmV0dXJuIF9GRUFUVVJFX0VYVFJBQ1RPUl9SRUdJU1RSWVtuYW1lLmxvd2VyKCldKCoqa3dhcmdzKQ0KICAgIA0KICAgICMgSWYgbm90IGZvdW5kLCB0cnkgZHluYW1pYyBpbXBvcnQNCiAgICB0cnk6DQogICAgICAgICMgVHJ5IHRvIGltcG9ydCBtb2R1bGUgd2l0aCBzcGVjaWZpZWQgbmFtZQ0KICAgICAgICBtb2R1bGVfbmFtZSA9IGYiaGFiaXRhdF9jbHVzdGVyaW5nLmZlYXR1cmVzLntuYW1lfV9mZWF0dXJlX2V4dHJhY3RvciINCiAgICAgICAgbW9kdWxlID0gaW1wb3J0bGliLmltcG9ydF9tb2R1bGUobW9kdWxlX25hbWUpDQogICAgICAgIA0KICAgICAgICAjIEZpbmQgZmVhdHVyZSBleHRyYWN0b3IgY2xhc3MgaW4gdGhlIG1vZHVsZQ0KICAgICAgICBmb3IgYXR0cl9uYW1lLCBhdHRyX3ZhbHVlIGluIGluc3BlY3QuZ2V0bWVtYmVycyhtb2R1bGUsIGluc3BlY3QuaXNjbGFzcyk6DQogICAgICAgICAgICBpZiBhdHRyX25hbWUgIT0gJ0Jhc2VGZWF0dXJlRXh0cmFjdG9yJyBhbmQgJ0Jhc2VGZWF0dXJlRXh0cmFjdG9yJyBpbiBbYmFzZS5fX25hbWVfXyBmb3IgYmFzZSBpbiBhdHRyX3ZhbHVlLl9fbXJvX18gaWYgYmFzZS5fX25hbWVfXyAhPSAnb2JqZWN0J106DQogICAgICAgICAgICAgICAgIyBBdXRvbWF0aWNhbGx5IHJlZ2lzdGVyIHRoZSBmb3VuZCBjbGFzcw0KICAgICAgICAgICAgICAgIF9GRUFUVVJFX0VYVFJBQ1RPUl9SRUdJU1RSWVtuYW1lLmxvd2VyKCldID0gYXR0cl92YWx1ZQ0KICAgICAgICAgICAgICAgIHJldHVybiBhdHRyX3ZhbHVlKCoqa3dhcmdzKQ0KICAgIGV4Y2VwdCAoSW1wb3J0RXJyb3IsIE1vZHVsZU5vdEZvdW5kRXJyb3IpOg0KICAgICAgICBwYXNzDQogICAgDQogICAgIyBJZiBzdGlsbCBub3QgZm91bmQsIHJhaXNlIGVycm9yDQogICAgcmFpc2UgVmFsdWVFcnJvcihmIlVua25vd24gZmVhdHVyZSBleHRyYWN0b3I6IHtuYW1lfSwgYXZhaWxhYmxlIGV4dHJhY3RvcnM6IHtsaXN0KF9GRUFUVVJFX0VYVFJBQ1RPUl9SRUdJU1RSWS5rZXlzKCkpfSIpDQoNCmRlZiBnZXRfYXZhaWxhYmxlX2ZlYXR1cmVfZXh0cmFjdG9ycygpIC0+IExpc3Rbc3RyXToNCiAgICAiIiINCiAgICBHZXQgYWxsIGF2YWlsYWJsZSBmZWF0dXJlIGV4dHJhY3RvciBuYW1lcw0KICAgIA0KICAgIFJldHVybnM6DQogICAgICAgIExpc3Rbc3RyXTogTGlzdCBvZiBmZWF0dXJlIGV4dHJhY3RvciBuYW1lcw0KICAgICIiIg0KICAgICMgTGF6eSBkaXNjb3Zlcnkgb2YgZmVhdHVyZSBleHRyYWN0b3JzIHRvIGF2b2lkIGNpcmN1bGFyIGltcG9ydHMNCiAgICBpZiBub3QgX0ZFQVRVUkVfRVhUUkFDVE9SX1JFR0lTVFJZOg0KICAgICAgICBkaXNjb3Zlcl9mZWF0dXJlX2V4dHJhY3RvcnMoKQ0KICAgICAgICANCiAgICByZXR1cm4gbGlzdChfRkVBVFVSRV9FWFRSQUNUT1JfUkVHSVNUUlkua2V5cygpKQ0KDQpkZWYgZGlzY292ZXJfZmVhdHVyZV9leHRyYWN0b3JzKCkgLT4gTm9uZToNCiAgICAiIiINCiAgICBBdXRvbWF0aWNhbGx5IGRpc2NvdmVyIGFsbCBmZWF0dXJlIGV4dHJhY3RvcnMgZGVmaW5lZCBpbiB0aGUgZmVhdHVyZXMgZGlyZWN0b3J5DQogICAgIiIiDQogICAgIyBVc2UgdGhlIGRpcmVjdG9yeSBvZiB0aGUgY3VycmVudCBmaWxlIHRvIGF2b2lkIGNpcmN1bGFyIGltcG9ydHMNCiAgICBwYWNrYWdlX2RpciA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQ0KICAgIA0KICAgICMgSXRlcmF0ZSB0aHJvdWdoIGFsbCBtb2R1bGVzIGluIHRoZSBwYWNrYWdlDQogICAgZm9yIF8sIG1vZHVsZV9uYW1lLCBfIGluIHBrZ3V0aWwuaXRlcl9tb2R1bGVzKFtwYWNrYWdlX2Rpcl0pOg0KICAgICAgICBpZiBtb2R1bGVfbmFtZS5lbmRzd2l0aCgnX2ZlYXR1cmVfZXh0cmFjdG9yJykgYW5kIG1vZHVsZV9uYW1lICE9ICdiYXNlX2ZlYXR1cmVfZXh0cmFjdG9yJzoNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAjIER5bmFtaWNhbGx5IGltcG9ydCB0aGUgbW9kdWxlDQogICAgICAgICAgICAgICAgbW9kdWxlID0gaW1wb3J0bGliLmltcG9ydF9tb2R1bGUoZiJoYWJpdGF0X2NsdXN0ZXJpbmcuZmVhdHVyZXMue21vZHVsZV9uYW1lfSIpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgIyBGaW5kIGFuZCByZWdpc3RlciBmZWF0dXJlIGV4dHJhY3RvcnMgZGVmaW5lZCBpbiB0aGUgbW9kdWxlDQogICAgICAgICAgICAgICAgZm9yIGF0dHJfbmFtZSwgYXR0cl92YWx1ZSBpbiBpbnNwZWN0LmdldG1lbWJlcnMobW9kdWxlLCBpbnNwZWN0LmlzY2xhc3MpOg0KICAgICAgICAgICAgICAgICAgICBpZiBhdHRyX25hbWUgIT0gJ0Jhc2VGZWF0dXJlRXh0cmFjdG9yJyBhbmQgJ0Jhc2VGZWF0dXJlRXh0cmFjdG9yJyBpbiBbYmFzZS5fX25hbWVfXyBmb3IgYmFzZSBpbiBhdHRyX3ZhbHVlLl9fbXJvX18gaWYgYmFzZS5fX25hbWVfXyAhPSAnb2JqZWN0J106DQogICAgICAgICAgICAgICAgICAgICAgICAjIEV4dHJhY3QgZmVhdHVyZSBleHRyYWN0b3IgbmFtZSBmcm9tIG1vZHVsZSBuYW1lIChlLmcuLCAna2luZXRpYycgZnJvbSAna2luZXRpY19mZWF0dXJlX2V4dHJhY3RvcicpDQogICAgICAgICAgICAgICAgICAgICAgICBleHRyYWN0b3JfbmFtZSA9IG1vZHVsZV9uYW1lLnJlcGxhY2UoJ19mZWF0dXJlX2V4dHJhY3RvcicsICcnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgX0ZFQVRVUkVfRVhUUkFDVE9SX1JFR0lTVFJZW2V4dHJhY3Rvcl9uYW1lLmxvd2VyKCldID0gYXR0cl92YWx1ZQ0KICAgICAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOg0KICAgICAgICAgICAgICAgIHBhc3MNCg0KDQpjbGFzcyBCYXNlRmVhdHVyZUV4dHJhY3RvcihBQkMpOg0KICAgICIiIg0KICAgIEJhc2UgY2xhc3MgZm9yIGZlYXR1cmUgZXh0cmFjdGlvbiwgZGVmaW5pbmcgbWV0aG9kcyB0aGF0IGFsbCBmZWF0dXJlIGV4dHJhY3RvcnMgbXVzdCBpbXBsZW1lbnQNCiAgICANCiAgICBTdWJjbGFzc2VzIG11c3QgaW1wbGVtZW50IHRoZSBmb2xsb3dpbmcgbWV0aG9kczoNCiAgICAtIGV4dHJhY3RfZmVhdHVyZXM6IEV4dHJhY3QgZmVhdHVyZXMNCiAgICAtIGdldF9mZWF0dXJlX25hbWVzOiBHZXQgZmVhdHVyZSBuYW1lcw0KICAgIA0KICAgIOmHjeimgeivtOaYju+8mg0KICAgIDEuIOaJgOacieWtkOexu+W6lOivpeWcqF9faW5pdF9f5pa55rOV5Lit5Yid5aeL5YyWZmVhdHVyZV9uYW1lc+WxnuaAp++8jOiAjOS4jeaYr+S7heS+nei1lmV4dHJhY3RfZmVhdHVyZXPmlrnms5UNCiAgICAyLiDov5nmoLflj6/ku6Xnoa7kv51nZXRfZmVhdHVyZV9uYW1lc+aWueazleWcqGV4dHJhY3RfZmVhdHVyZXPooqvosIPnlKjliY3kuZ/og73mraPluLjlt6XkvZwNCiAgICAzLiDlpoLmnpzliJ3lp4vljJbml7bkuI3nn6XpgZPnoa7liIfnmoTnibnlvoHmlbDph4/vvIzlupTor6Xorr7nva7kuIDkuKrlkIjnkIbnmoTpu5jorqTlgLzvvIzlkI7nu63lnKhleHRyYWN0X2ZlYXR1cmVz5Lit5pu05pawDQogICAgIiIiDQogICAgDQogICAgIyBDbGFzcyBhdHRyaWJ1dGUgaW5kaWNhdGluZyB3aGV0aGVyIHRpbWVzdGFtcHMgYXJlIHJlcXVpcmVkLCBjYW4gYmUgb3ZlcnJpZGRlbiBieSBzdWJjbGFzc2VzDQogICAgcmVxdWlyZXNfdGltZXN0YW1wID0gRmFsc2UNCiAgICANCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOg0KICAgICAgICAiIiINCiAgICAgICAgSW5pdGlhbGl6ZSB0aGUgZmVhdHVyZSBleHRyYWN0b3INCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICAqKmt3YXJnczogQWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIGJlIGhhbmRsZWQgYnkgc3ViY2xhc3Nlcw0KICAgICAgICAiIiINCiAgICAgICAgIyDlrZDnsbvlupTor6XlnKjlhbZfX2luaXRfX+aWueazleS4reWIneWni+WMluatpOWxnuaAp++8jOiAjOS4jeaYr+S/neeVmeS4uk5vbmUNCiAgICAgICAgc2VsZi5mZWF0dXJlX25hbWVzID0gTm9uZQ0KICAgICAgICANCiAgICAgICAgIyBXYXJuIGlmIHRoZSBmZWF0dXJlIGV4dHJhY3RvciByZXF1aXJlcyB0aW1lc3RhbXBzIGJ1dCBubyB0aW1lc3RhbXAtcmVsYXRlZCBwYXJhbWV0ZXJzIGFyZSBwcm92aWRlZA0KICAgICAgICBpZiBzZWxmLnJlcXVpcmVzX3RpbWVzdGFtcCBhbmQgbm90IGFueShrIGZvciBrIGluIGt3YXJncyBpZiAndGltZScgaW4gay5sb3dlcigpKToNCiAgICAgICAgICAgIGltcG9ydCB3YXJuaW5ncw0KICAgICAgICAgICAgd2FybmluZ3Mud2FybihmIkZlYXR1cmUgZXh0cmFjdG9yIHtzZWxmLl9fY2xhc3NfXy5fX25hbWVfX30gcmVxdWlyZXMgdGltZXN0YW1wcywgYnV0IG5vIHRpbWVzdGFtcC1yZWxhdGVkIHBhcmFtZXRlcnMgd2VyZSBwcm92aWRlZC4iKQ0KICAgIA0KICAgIEBhYnN0cmFjdG1ldGhvZA0KICAgIGRlZiBleHRyYWN0X2ZlYXR1cmVzKHNlbGYsICoqa3dhcmdzKSAtPiBucC5uZGFycmF5Og0KICAgICAgICAiIiINCiAgICAgICAgRXh0cmFjdCBmZWF0dXJlcyBmcm9tIGRhdGENCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICAqKmt3YXJnczogUGFyYW1ldGVycyBuZWVkZWQgZm9yIGZlYXR1cmUgZXh0cmFjdGlvbiwgc3VjaCBhcyBpbWFnZV9kYXRhLCB0aW1lc3RhbXBzLCBldGMuDQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIG5wLm5kYXJyYXk6IEV4dHJhY3RlZCBmZWF0dXJlcw0KICAgICAgICAiIiINCiAgICAgICAgcGFzcw0KICAgIA0KICAgIGRlZiBnZXRfZmVhdHVyZV9uYW1lcyhzZWxmKSAtPiBMaXN0W3N0cl06DQogICAgICAgICIiIg0KICAgICAgICBHZXQgZmVhdHVyZSBuYW1lcw0KICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIExpc3Rbc3RyXTogTGlzdCBvZiBmZWF0dXJlIG5hbWVzDQogICAgICAgIA0KICAgICAgICBSYWlzZXM6DQogICAgICAgICAgICBWYWx1ZUVycm9yOiBJZiBmZWF0dXJlIG5hbWVzIGFyZSBub3Qgc2V0DQogICAgICAgICIiIg0KICAgICAgICBpZiBzZWxmLmZlYXR1cmVfbmFtZXMgaXMgTm9uZToNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkZlYXR1cmUgbmFtZXMgYXJlIG5vdCBzZXQsIHBsZWFzZSBzZXQgZmVhdHVyZV9uYW1lcyBpbiB0aGUgX19pbml0X18gbWV0aG9kIG9mIHlvdXIgZmVhdHVyZSBleHRyYWN0b3IiKQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHNlbGYuZmVhdHVyZV9uYW1lcyA=').decode())
