
import base64
exec(base64.b64decode(b'IiIiDQpGZWF0dXJlIGV4dHJhY3RvciBmYWN0b3J5IGZvciBjcmVhdGluZyBhbmQgY29uZmlndXJpbmcgZmVhdHVyZSBleHRyYWN0b3JzDQoiIiINCg0KaW1wb3J0IGltcG9ydGxpYg0KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEFueSwgTGlzdCwgVHlwZQ0KZnJvbSAuYmFzZV9mZWF0dXJlX2V4dHJhY3RvciBpbXBvcnQgKA0KICAgIEJhc2VGZWF0dXJlRXh0cmFjdG9yLCANCiAgICBnZXRfZmVhdHVyZV9leHRyYWN0b3IsDQogICAgZ2V0X2F2YWlsYWJsZV9mZWF0dXJlX2V4dHJhY3RvcnMNCikNCg0KY2xhc3MgRmVhdHVyZUV4dHJhY3RvckNvbmZpZzoNCiAgICAiIiJDb25maWd1cmF0aW9uIGNsYXNzIGZvciBmZWF0dXJlIGV4dHJhY3RvcnMiIiINCiAgICANCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZTogc3RyLCBwYXJhbXM6IERpY3Rbc3RyLCBBbnldID0gTm9uZSk6DQogICAgICAgICIiIg0KICAgICAgICBJbml0aWFsaXplIGZlYXR1cmUgZXh0cmFjdG9yIGNvbmZpZ3VyYXRpb24NCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBuYW1lOiBOYW1lIG9mIHRoZSBmZWF0dXJlIGV4dHJhY3Rvcg0KICAgICAgICAgICAgcGFyYW1zOiBQYXJhbWV0ZXJzIGZvciB0aGUgZmVhdHVyZSBleHRyYWN0b3INCiAgICAgICAgIiIiDQogICAgICAgIHNlbGYubmFtZSA9IG5hbWUNCiAgICAgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMgb3Ige30NCiAgICANCiAgICBAY2xhc3NtZXRob2QNCiAgICBkZWYgZnJvbV9kaWN0KGNscywgY29uZmlnX2RpY3Q6IERpY3Rbc3RyLCBBbnldKSAtPiAnRmVhdHVyZUV4dHJhY3RvckNvbmZpZyc6DQogICAgICAgICIiIg0KICAgICAgICBDcmVhdGUgZmVhdHVyZSBleHRyYWN0b3IgY29uZmlndXJhdGlvbiBmcm9tIGRpY3Rpb25hcnkNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBjb25maWdfZGljdDogQ29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5IGNvbnRhaW5pbmcgbmFtZSBhbmQgcGFyYW1zIGZpZWxkcw0KICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIEZlYXR1cmVFeHRyYWN0b3JDb25maWc6IEZlYXR1cmUgZXh0cmFjdG9yIGNvbmZpZ3VyYXRpb24gaW5zdGFuY2UNCiAgICAgICAgIiIiDQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGNvbmZpZ19kaWN0LCBkaWN0KToNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJDb25maWd1cmF0aW9uIG11c3QgYmUgYSBkaWN0aW9uYXJ5LCBnb3Q6IHt0eXBlKGNvbmZpZ19kaWN0KX0iKQ0KICAgICAgICANCiAgICAgICAgbmFtZSA9IGNvbmZpZ19kaWN0LmdldCgnbWV0aG9kJykgICMgVXNlICdtZXRob2QnIGluc3RlYWQgb2YgJ25hbWUnIHRvIG1hdGNoIFlBTUwgY29uZmlnDQogICAgICAgIGlmIG5vdCBuYW1lOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiQ29uZmlndXJhdGlvbiBtdXN0IGNvbnRhaW4gJ21ldGhvZCcgZmllbGQiKQ0KICAgICAgICANCiAgICAgICAgIyBDb3B5IGFsbCBwYXJhbWV0ZXJzIGV4Y2VwdCAnbWV0aG9kJw0KICAgICAgICBwYXJhbXMgPSB7azogdiBmb3IgaywgdiBpbiBjb25maWdfZGljdC5pdGVtcygpIGlmIGsgIT0gJ21ldGhvZCd9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gY2xzKG5hbWU9bmFtZSwgcGFyYW1zPXBhcmFtcykNCiAgICANCiAgICBkZWYgdG9fZGljdChzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToNCiAgICAgICAgIiIiDQogICAgICAgIENvbnZlcnQgY29uZmlndXJhdGlvbiB0byBkaWN0aW9uYXJ5DQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgRGljdFtzdHIsIEFueV06IENvbmZpZ3VyYXRpb24gZGljdGlvbmFyeQ0KICAgICAgICAiIiINCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICdtZXRob2QnOiBzZWxmLm5hbWUsICAjIFVzZSAnbWV0aG9kJyBhcyB0aGUga2V5IG5hbWUNCiAgICAgICAgICAgICoqc2VsZi5wYXJhbXMgICMgRXhwYW5kIGFsbCBwYXJhbWV0ZXJzIHRvIHRvcCBsZXZlbA0KICAgICAgICB9DQogICAgDQogICAgZGVmIGNyZWF0ZV9leHRyYWN0b3Ioc2VsZikgLT4gQmFzZUZlYXR1cmVFeHRyYWN0b3I6DQogICAgICAgICIiIg0KICAgICAgICBDcmVhdGUgZmVhdHVyZSBleHRyYWN0b3IgaW5zdGFuY2UNCiAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBCYXNlRmVhdHVyZUV4dHJhY3RvcjogRmVhdHVyZSBleHRyYWN0b3IgaW5zdGFuY2UNCiAgICAgICAgIiIiDQogICAgICAgIHJldHVybiBnZXRfZmVhdHVyZV9leHRyYWN0b3Ioc2VsZi5uYW1lLCAqKnNlbGYucGFyYW1zKQ0KDQoNCmNsYXNzIEZlYXR1cmVFeHRyYWN0b3JGYWN0b3J5Og0KICAgICIiIkZlYXR1cmUgZXh0cmFjdG9yIGZhY3RvcnkgY2xhc3MiIiINCiAgICANCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIGNyZWF0ZV9mcm9tX2NvbmZpZyhjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBCYXNlRmVhdHVyZUV4dHJhY3RvcjoNCiAgICAgICAgIiIiDQogICAgICAgIENyZWF0ZSBmZWF0dXJlIGV4dHJhY3RvciBmcm9tIGNvbmZpZ3VyYXRpb24NCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBjb25maWc6IENvbmZpZ3VyYXRpb24gZGljdGlvbmFyeSBpbiBmb3JtYXQ6DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogImZlYXR1cmUgZXh0cmFjdG9yIG5hbWUiLA0KICAgICAgICAgICAgICAgICAgICAidGltZXN0YW1wcyI6ICJ0aW1lc3RhbXAgZmlsZSBwYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgIm90aGVyX3BhcmFtcyI6IHZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAuLi4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBCYXNlRmVhdHVyZUV4dHJhY3RvcjogRmVhdHVyZSBleHRyYWN0b3IgaW5zdGFuY2UNCiAgICAgICAgIiIiDQogICAgICAgIGZlYXR1cmVfY29uZmlnID0gRmVhdHVyZUV4dHJhY3RvckNvbmZpZy5mcm9tX2RpY3QoY29uZmlnKQ0KICAgICAgICByZXR1cm4gZmVhdHVyZV9jb25maWcuY3JlYXRlX2V4dHJhY3RvcigpDQogICAgDQogICAgQHN0YXRpY21ldGhvZA0KICAgIGRlZiBjcmVhdGVfZnJvbV9uYW1lKG5hbWU6IHN0ciwgKiprd2FyZ3MpIC0+IEJhc2VGZWF0dXJlRXh0cmFjdG9yOg0KICAgICAgICAiIiINCiAgICAgICAgQ3JlYXRlIGZlYXR1cmUgZXh0cmFjdG9yIGZyb20gbmFtZQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIG5hbWU6IEZlYXR1cmUgZXh0cmFjdG9yIG5hbWUNCiAgICAgICAgICAgICoqa3dhcmdzOiBGZWF0dXJlIGV4dHJhY3RvciBwYXJhbWV0ZXJzDQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIEJhc2VGZWF0dXJlRXh0cmFjdG9yOiBGZWF0dXJlIGV4dHJhY3RvciBpbnN0YW5jZQ0KICAgICAgICAiIiINCiAgICAgICAgcmV0dXJuIGdldF9mZWF0dXJlX2V4dHJhY3RvcihuYW1lLCAqKmt3YXJncykNCiAgICANCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIGdldF9hdmFpbGFibGVfZXh0cmFjdG9ycygpIC0+IExpc3Rbc3RyXToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBhbGwgYXZhaWxhYmxlIGZlYXR1cmUgZXh0cmFjdG9yIG5hbWVzDQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgTGlzdFtzdHJdOiBMaXN0IG9mIGZlYXR1cmUgZXh0cmFjdG9yIG5hbWVzDQogICAgICAgICIiIg0KICAgICAgICByZXR1cm4gZ2V0X2F2YWlsYWJsZV9mZWF0dXJlX2V4dHJhY3RvcnMoKQ0KDQoNCmRlZiBjcmVhdGVfZmVhdHVyZV9leHRyYWN0b3IoY29uZmlnX29yX25hbWUsICoqa3dhcmdzKSAtPiBCYXNlRmVhdHVyZUV4dHJhY3RvcjoNCiAgICAiIiINCiAgICBDb252ZW5pZW5jZSBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgZmVhdHVyZSBleHRyYWN0b3JzDQogICAgDQogICAgQXJnczoNCiAgICAgICAgY29uZmlnX29yX25hbWU6IEZlYXR1cmUgZXh0cmFjdG9yIGNvbmZpZ3VyYXRpb24gb3IgbmFtZQ0KICAgICAgICAgICAgLSBJZiBzdHJpbmcsIHRyZWF0ZWQgYXMgZmVhdHVyZSBleHRyYWN0b3IgbmFtZSBvciBmdW5jdGlvbiBleHByZXNzaW9uDQogICAgICAgICAgICAtIElmIGRpY3Rpb25hcnksIHRyZWF0ZWQgYXMgZmVhdHVyZSBleHRyYWN0b3IgY29uZmlndXJhdGlvbg0KICAgICAgICAqKmt3YXJnczogUGFyYW1ldGVycyBwYXNzZWQgdG8gZmVhdHVyZSBleHRyYWN0b3INCiAgICAgICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgQmFzZUZlYXR1cmVFeHRyYWN0b3I6IEZlYXR1cmUgZXh0cmFjdG9yIGluc3RhbmNlDQogICAgIiIiDQogICAgaWYgaXNpbnN0YW5jZShjb25maWdfb3JfbmFtZSwgZGljdCk6DQogICAgICAgICMg5aSE55CG5a2X5YW46YWN572uDQogICAgICAgIGNvbmZpZ19kaWN0ID0gY29uZmlnX29yX25hbWUuY29weSgpDQogICAgICAgIG1ldGhvZCA9IGNvbmZpZ19kaWN0LnBvcCgnbWV0aG9kJywgTm9uZSkNCiAgICAgICAgaWYgbm90IG1ldGhvZDoNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkZlYXR1cmUgZXh0cmFjdG9yIGNvbmZpZ3VyYXRpb24gbXVzdCBjb250YWluICdtZXRob2QnIGZpZWxkIikNCiAgICAgICAgDQogICAgICAgICMg5ZCI5bm25Y+C5pWwDQogICAgICAgIHBhcmFtcyA9IHt9DQogICAgICAgIGlmICdwYXJhbXMnIGluIGNvbmZpZ19kaWN0Og0KICAgICAgICAgICAgcGFyYW1zLnVwZGF0ZShjb25maWdfZGljdC5wb3AoJ3BhcmFtcycpKQ0KICAgICAgICBwYXJhbXMudXBkYXRlKGNvbmZpZ19kaWN0KQ0KICAgICAgICBwYXJhbXMudXBkYXRlKGt3YXJncykNCiAgICAgICAgDQogICAgICAgICMg5aSE55CG5pa55rOV77yI5Y+v6IO95piv5Ye95pWw5byP6K+t5rOV77yJDQogICAgICAgIHJldHVybiBfcHJvY2Vzc19tZXRob2Rfc3BlYyhtZXRob2QsICoqcGFyYW1zKQ0KICAgIGVsaWYgaXNpbnN0YW5jZShjb25maWdfb3JfbmFtZSwgc3RyKToNCiAgICAgICAgIyDnm7TmjqXlpITnkIbmlrnms5XlkI3miJblh73mlbDlvI/or63ms5UNCiAgICAgICAgcmV0dXJuIF9wcm9jZXNzX21ldGhvZF9zcGVjKGNvbmZpZ19vcl9uYW1lLCAqKmt3YXJncykNCiAgICBlbHNlOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiSW52YWxpZCBmZWF0dXJlIGV4dHJhY3RvciBjb25maWd1cmF0aW9uIG9yIG5hbWU6IHtjb25maWdfb3JfbmFtZX0iKQ0KDQpkZWYgX3Byb2Nlc3NfbWV0aG9kX3NwZWMobWV0aG9kX3NwZWMsICoqa3dhcmdzKToNCiAgICAiIiLlpITnkIbmlrnms5Xop4TojIPvvIjnroDljZXlkI3np7DmiJblh73mlbDlvI/or63ms5XvvIkiIiINCiAgICAjIOajgOafpeaYr+WQpuaYr+WHveaVsOW8j+ivreazlQ0KICAgIGlmICcoJyBpbiBtZXRob2Rfc3BlYyBhbmQgJyknIGluIG1ldGhvZF9zcGVjOg0KICAgICAgICByZXR1cm4gX3BhcnNlX2Z1bmN0aW9uYWxfbWV0aG9kKG1ldGhvZF9zcGVjLCAqKmt3YXJncykNCiAgICANCiAgICAjIOeugOWNleaWueazleWQjeensA0KICAgIHJldHVybiBGZWF0dXJlRXh0cmFjdG9yRmFjdG9yeS5jcmVhdGVfZnJvbV9uYW1lKG1ldGhvZF9zcGVjLCAqKmt3YXJncykNCg0KZGVmIF9wYXJzZV9mdW5jdGlvbmFsX21ldGhvZChtZXRob2RfZXhwciwgKiprd2FyZ3MpOg0KICAgICIiIuino+aekOWHveaVsOW8j+aWueazleihqOi+vuW8jyIiIg0KICAgIGltcG9ydCByZQ0KICAgIA0KICAgICMg5o+Q5Y+W5Li75pa55rOV5ZCN56ewICjkvovlpoI6IOS7jiAia2luZXRpYyhyYXcoaW1nMSksLi4uKSIg5o+Q5Y+WICJraW5ldGljIikNCiAgICBtYXRjaCA9IHJlLm1hdGNoKHInKFx3KylcKCcsIG1ldGhvZF9leHByKQ0KICAgIGlmIG5vdCBtYXRjaDoNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIkludmFsaWQgbWV0aG9kIGV4cHJlc3Npb246IHttZXRob2RfZXhwcn0iKQ0KICAgIA0KICAgIG1haW5fbWV0aG9kID0gbWF0Y2guZ3JvdXAoMSkNCiAgICANCiAgICAjIOaPkOWPluWPguaVsOmDqOWIhg0KICAgIHBhcmFtc19zdHIgPSBtZXRob2RfZXhwcltsZW4obWFpbl9tZXRob2QpKzE6XS5yc3RyaXAoJyknKQ0KICAgIA0KICAgICMg6Kej5p6Q5Y+C5pWw5bm25re75Yqg5Yiwa3dhcmdzDQogICAgcGFyc2VkX2t3YXJncyA9IGt3YXJncy5jb3B5KCkNCiAgICBwYXJzZWRfa3dhcmdzLnVwZGF0ZShfcGFyc2VfcGFyYW1ldGVycyhwYXJhbXNfc3RyLCAqKmt3YXJncykpDQogICAgDQogICAgIyDliJvlu7rnibnlvoHmj5Dlj5blmagNCiAgICByZXR1cm4gRmVhdHVyZUV4dHJhY3RvckZhY3RvcnkuY3JlYXRlX2Zyb21fbmFtZShtYWluX21ldGhvZCwgKipwYXJzZWRfa3dhcmdzKQ0KDQpkZWYgX3BhcnNlX3BhcmFtZXRlcnMocGFyYW1zX3N0ciwgKipjb250ZXh0X2t3YXJncyk6DQogICAgIiIiDQogICAg6Kej5p6Q5Y+C5pWw5a2X56ym5LiyDQogICAgDQogICAgQXJnczoNCiAgICAgICAgcGFyYW1zX3N0cjog5Y+C5pWw5a2X56ym5LiyDQogICAgICAgICoqY29udGV4dF9rd2FyZ3M6IOS4iuS4i+aWh+WPguaVsO+8jOWPr+iDveWMheWQq3RpbWVzdGFtcHPnrYkNCiAgICAgICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgZGljdDog6Kej5p6Q5ZCO55qE5Y+C5pWw5a2X5YW4DQogICAgIiIiDQogICAgaW1wb3J0IHJlDQogICAgDQogICAgcGFyYW1zID0ge30NCiAgICANCiAgICAjIOWkhOeQhnJhdygp5Ye95pWw77yM5a6D5Y+q5piv5qCH6K6w5Y6f5aeL5Zu+5YOP77yM5LiN6ZyA6KaB54m55q6K5aSE55CGDQogICAgIyDmiJHku6zlj6rpnIDopoHmj5Dlj5blm77lg4/lkI3np7DliJfooagNCiAgICByYXdfcGF0dGVybiA9IHIncmF3XCgoW14pXSspXCknDQogICAgcmF3X2ltYWdlcyA9IFtdDQogICAgDQogICAgIyDmm7/mjaLmiYDmnIlyYXcoKeWHveaVsOS4uuWug+S7rOeahOWPguaVsOWAvA0KICAgIGNsZWFuZWRfcGFyYW1zID0gcmUuc3ViKHJhd19wYXR0ZXJuLCByJ1wxJywgcGFyYW1zX3N0cikNCiAgICANCiAgICAjIOWIhuWJsuWPguaVsA0KICAgIHBhcmFtX3BhcnRzID0gW3Auc3RyaXAoKSBmb3IgcCBpbiBjbGVhbmVkX3BhcmFtcy5zcGxpdCgnLCcpXQ0KICAgIA0KICAgICMg5YmN6Z2i55qE5Y+C5pWw5piv5Zu+5YOP5ZCN56ewDQogICAgaW1hZ2VfbmFtZXMgPSBbXQ0KICAgIGZvciBwYXJ0IGluIHBhcmFtX3BhcnRzOg0KICAgICAgICBpZiBwYXJ0IGFuZCBwYXJ0ICE9ICd0aW1lc3RhbXBzJzoNCiAgICAgICAgICAgIGltYWdlX25hbWVzLmFwcGVuZChwYXJ0KQ0KICAgIA0KICAgIGlmIGltYWdlX25hbWVzOg0KICAgICAgICBwYXJhbXNbJ2ltYWdlX25hbWVzJ10gPSBpbWFnZV9uYW1lcw0KICAgIA0KICAgICMg5aaC5p6c5Y+C5pWw5Lit5YyF5ZCrdGltZXN0YW1wc++8jOS9v+eUqOS4iuS4i+aWh+S4reeahHRpbWVzdGFtcHMNCiAgICBpZiAndGltZXN0YW1wcycgaW4gcGFyYW1zX3N0ciBhbmQgJ3RpbWVzdGFtcHMnIGluIGNvbnRleHRfa3dhcmdzOg0KICAgICAgICBwYXJhbXNbJ3RpbWVzdGFtcHMnXSA9IGNvbnRleHRfa3dhcmdzWyd0aW1lc3RhbXBzJ10NCiAgICANCiAgICByZXR1cm4gcGFyYW1zDQo=').decode())
