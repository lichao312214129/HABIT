
import base64
exec(base64.b64decode(b'IiIiDQpNdWx0aS1pbWFnZSBmZWF0dXJlIGV4dHJhY3RvciB0aGF0IGNvbmNhdGVuYXRlcyBmZWF0dXJlcyBmcm9tIG11bHRpcGxlIGltYWdlcw0KIiIiDQoNCmltcG9ydCBudW1weSBhcyBucA0KaW1wb3J0IHBhbmRhcyBhcyBwZA0KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIExpc3QsIE9wdGlvbmFsLCBVbmlvbiwgQW55DQoNCmZyb20gLmJhc2VfZmVhdHVyZV9leHRyYWN0b3IgaW1wb3J0IEJhc2VGZWF0dXJlRXh0cmFjdG9yLCByZWdpc3Rlcl9mZWF0dXJlX2V4dHJhY3Rvcg0KDQoNCkByZWdpc3Rlcl9mZWF0dXJlX2V4dHJhY3RvcignY29uY2F0JykNCmNsYXNzIENvbmNhdEltYWdlRmVhdHVyZUV4dHJhY3RvcihCYXNlRmVhdHVyZUV4dHJhY3Rvcik6DQogICAgIiIiDQogICAgRmVhdHVyZSBleHRyYWN0b3IgdGhhdCBjb25jYXRlbmF0ZXMgZmVhdHVyZXMgZnJvbSBtdWx0aXBsZSBpbWFnZXMNCiAgICANCiAgICBUaGlzIGV4dHJhY3RvciB3b3JrcyB3aXRoIG11bHRpcGxlIGltYWdlcyBhcyBpbnB1dCBhbmQgY29uY2F0ZW5hdGVzIHRoZWlyIGZlYXR1cmVzDQogICAgaG9yaXpvbnRhbGx5IHRvIGNyZWF0ZSBhIGNvbWJpbmVkIGZlYXR1cmUgbWF0cml4Lg0KICAgICIiIg0KDQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZlYXR1cmVfZXh0cmFjdG9yX25hbWU6IHN0ciA9ICdyYXcnLCAqKmt3YXJncykgLT4gTm9uZToNCiAgICAgICAgIiIiDQogICAgICAgIEluaXRpYWxpemUgdGhlIG11bHRpLWltYWdlIGZlYXR1cmUgZXh0cmFjdG9yDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgZmVhdHVyZV9leHRyYWN0b3JfbmFtZSAoc3RyKTogTmFtZSBvZiBmZWF0dXJlIGV4dHJhY3RvciB0byB1c2UgZm9yIGVhY2ggaW1hZ2UNCiAgICAgICAgICAgICoqa3dhcmdzOiBQYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIHBhcmVudCBjbGFzcw0KICAgICAgICAiIiINCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykNCiAgICAgICAgc2VsZi5mZWF0dXJlX2V4dHJhY3Rvcl9uYW1lID0gZmVhdHVyZV9leHRyYWN0b3JfbmFtZQ0KICAgICAgICBzZWxmLmZlYXR1cmVfbmFtZXMgPSBbXQ0KDQogICAgZGVmIGV4dHJhY3RfZmVhdHVyZXMoc2VsZiwgaW1hZ2VfZGF0YTogTGlzdFtVbmlvbltucC5uZGFycmF5LCBwZC5EYXRhRnJhbWVdXSwgKiprd2FyZ3MpIC0+IHBkLkRhdGFGcmFtZToNCiAgICAgICAgIiIiDQogICAgICAgIEV4dHJhY3QgZmVhdHVyZXMgZnJvbSBtdWx0aXBsZSBpbWFnZXMgYW5kIGNvbmNhdGVuYXRlIHRoZW0NCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBpbWFnZV9kYXRhOiBMaXN0IG9mIGltYWdlIGRhdGEsIGVhY2ggZWxlbWVudCBjYW4gYmUgYSBudW1weSBhcnJheSBbbl92b3hlbHMsIG5fZmVhdHVyZXNdIA0KICAgICAgICAgICAgICAgICAgICAgICBvciBwYW5kYXMgRGF0YUZyYW1lDQogICAgICAgICAgICAqKmt3YXJnczogQWRkaXRpb25hbCBwYXJhbWV0ZXJzIGZvciBmZWF0dXJlIGV4dHJhY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgcGQuRGF0YUZyYW1lOiBDb25jYXRlbmF0ZWQgZmVhdHVyZXMgZnJvbSBhbGwgaW1hZ2VzDQogICAgICAgICIiIg0KICAgICAgICBpZiBub3QgaW1hZ2VfZGF0YToNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkF0IGxlYXN0IG9uZSBpbWFnZSBpcyByZXF1aXJlZCIpDQogICAgICAgICAgICANCiAgICAgICAgIyBDb252ZXJ0IGltYWdlX2RhdGEgbGlzdCB0byBEYXRhRnJhbWUNCiAgICAgICAgaW1hZ2VfZGYgPSBwZC5EYXRhRnJhbWUoKQ0KICAgICAgICBmb3IgaSwgdmFsdWVzIGluIGVudW1lcmF0ZShpbWFnZV9kYXRhKToNCiAgICAgICAgICAgICMgR2VuZXJhdGUgYSBrZXkgZm9yIG5hbWluZyBmZWF0dXJlcw0KICAgICAgICAgICAga2V5ID0gZiJpbWd7aSsxfSINCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBJZiB2YWx1ZXMgaXMgYWxyZWFkeSBhIERhdGFGcmFtZSwgdXNlIGl0cyBjb2x1bW4gbmFtZXMNCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWVzLCBwZC5EYXRhRnJhbWUpOg0KICAgICAgICAgICAgICAgICMgQWRkIHByZWZpeCB0byBjb2x1bW4gbmFtZXMgdG8gaWRlbnRpZnkgdGhlIGltYWdlIHNvdXJjZQ0KICAgICAgICAgICAgICAgICMgcmVuYW1lZF9jb2xzID0ge2NvbDogZiJ7a2V5fV97Y29sfSIgZm9yIGNvbCBpbiB2YWx1ZXMuY29sdW1uc30NCiAgICAgICAgICAgICAgICAjIHZhbHVlcyA9IHZhbHVlcy5yZW5hbWUoY29sdW1ucz1yZW5hbWVkX2NvbHMpDQogICAgICAgICAgICAgICAgaW1hZ2VfZGYgPSBwZC5jb25jYXQoW2ltYWdlX2RmLCB2YWx1ZXNdLCBheGlzPTEpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICMgSWYgdmFsdWVzIGlzIGEgbnVtcHkgYXJyYXksIGNvbnZlcnQgdG8gRGF0YUZyYW1lIHdpdGggcHJlZml4ZWQgY29sdW1uIG5hbWUNCiAgICAgICAgICAgICAgICBpZiBsZW4odmFsdWVzLnNoYXBlKSA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAjIEZvciAxRCBhcnJheXMsIGNyZWF0ZSBhIHNpbmdsZSBjb2x1bW4NCiAgICAgICAgICAgICAgICAgICAgY29sX25hbWUgPSBmImZlYXR1cmVfe2tleX0iDQogICAgICAgICAgICAgICAgICAgIGRmID0gcGQuRGF0YUZyYW1lKHZhbHVlcywgY29sdW1ucz1bY29sX25hbWVdKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICMgRm9yIDJEIGFycmF5cywgY3JlYXRlIG11bHRpcGxlIGNvbHVtbnMgd2l0aCBwcmVmaXhlZCBuYW1lcw0KICAgICAgICAgICAgICAgICAgICBuX2NvbHMgPSB2YWx1ZXMuc2hhcGVbMV0NCiAgICAgICAgICAgICAgICAgICAgY29sX25hbWVzID0gW2YiZmVhdHVyZXtqKzF9X3trZXl9IiBmb3IgaiBpbiByYW5nZShuX2NvbHMpXQ0KICAgICAgICAgICAgICAgICAgICBkZiA9IHBkLkRhdGFGcmFtZSh2YWx1ZXMsIGNvbHVtbnM9Y29sX25hbWVzKQ0KICAgICAgICAgICAgICAgIGltYWdlX2RmID0gcGQuY29uY2F0KFtpbWFnZV9kZiwgZGZdLCBheGlzPTEpDQogICAgICAgIA0KICAgICAgICAjIENoZWNrIGlmIGFsbCBpbWFnZXMgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2Ygdm94ZWxzDQogICAgICAgIGlmIGltYWdlX2RmLmVtcHR5Og0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTm8gdmFsaWQgZGF0YSBmb3VuZCBpbiBpbnB1dCBsaXN0IikNCiAgICAgICAgICAgIA0KICAgICAgICAjIFVwZGF0ZSBmZWF0dXJlIG5hbWVzDQogICAgICAgIHNlbGYuZmVhdHVyZV9uYW1lcyA9IGxpc3QoaW1hZ2VfZGYuY29sdW1ucykNCiAgICAgICAgDQogICAgICAgIHJldHVybiBpbWFnZV9kZg0KICAgIA0KICAgIGRlZiBnZXRfZmVhdHVyZV9uYW1lcyhzZWxmKSAtPiBMaXN0W3N0cl06DQogICAgICAgICIiIg0KICAgICAgICBHZXQgZmVhdHVyZSBuYW1lcw0KICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIExpc3Rbc3RyXTogTGlzdCBvZiBmZWF0dXJlIG5hbWVzDQogICAgICAgICIiIg0KICAgICAgICByZXR1cm4gc2VsZi5mZWF0dXJlX25hbWVzIA==').decode())
