
import base64
exec(base64.b64decode(b'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoiIiINCkhhYml0YXQgUmFkaW9taWNzIEZlYXR1cmVzIEV4dHJhY3Rpb24NClRoaXMgbW9kdWxlIHByb3ZpZGVzIGZ1bmN0aW9uYWxpdHkgZm9yIGV4dHJhY3RpbmcgaGFiaXRhdC1zcGVjaWZpYyByYWRpb21pY3MgZmVhdHVyZXM6DQoxLiBSYWRpb21pYyBmZWF0dXJlcyBvZiByYXcgaW1hZ2VzIHdpdGhpbiBkaWZmZXJlbnQgaGFiaXRhdHMNCjIuIFJhZGlvbWljIGZlYXR1cmVzIG9mIGhhYml0YXRzIHdpdGhpbiB0aGUgZW50aXJlIFJPSQ0KIiIiDQoNCmltcG9ydCBsb2dnaW5nDQppbXBvcnQgU2ltcGxlSVRLIGFzIHNpdGsNCmltcG9ydCBudW1weSBhcyBucA0KZnJvbSByYWRpb21pY3MgaW1wb3J0IGZlYXR1cmVleHRyYWN0b3INCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBPcHRpb25hbA0KDQpjbGFzcyBIYWJpdGF0UmFkaW9taWNzRXh0cmFjdG9yOg0KICAgICIiIkV4dHJhY3RvciBjbGFzcyBmb3IgaGFiaXRhdCByYWRpb21pY3MgZmVhdHVyZXMiIiINCiAgICANCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIGV4dHJhY3RfcmFkaW9taWNzX2ZlYXR1cmVzX2Zvcl93aG9sZV9oYWJpdGF0KGhhYml0YXRfaW1nLCBwYXJhbXNfZmlsZSk6DQogICAgICAgICIiIg0KICAgICAgICBFeHRyYWN0IHJhZGlvbWljcyBmZWF0dXJlcyBmcm9tIHRoZSB3aG9sZSBoYWJpdGF0IG1hcCB3aXRoaW4gdGhlIFJPSQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGhhYml0YXRfaW1nOiBTaW1wbGVJVEsgaW1hZ2Ugb3IgcGF0aCB0byBoYWJpdGF0IG1hcCBmaWxlDQogICAgICAgICAgICBwYXJhbXNfZmlsZTogUGFyYW1ldGVyIGZpbGUgZm9yIFB5UmFkaW9taWNzIGZlYXR1cmUgZXh0cmFjdGlvbg0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBEaWN0OiBEaWN0aW9uYXJ5IGNvbnRhaW5pbmcgZXh0cmFjdGVkIHJhZGlvbWljcyBmZWF0dXJlcw0KICAgICAgICAiIiINCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZXh0cmFjdG9yID0gZmVhdHVyZWV4dHJhY3Rvci5SYWRpb21pY3NGZWF0dXJlRXh0cmFjdG9yKHBhcmFtc19maWxlKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGhhYml0YXRfaW1nLCBzdHIpOg0KICAgICAgICAgICAgICAgIGhhYml0YXRfaW1nID0gc2l0ay5SZWFkSW1hZ2UoaGFiaXRhdF9pbWcpDQogICAgICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKGhhYml0YXRfaW1nLCBzaXRrLkltYWdlKToNCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJoYWJpdGF0X2ltZyBtdXN0IGJlIGEgU2ltcGxlSVRLIGltYWdlIG9yIGEgZmlsZSBwYXRoLiIpDQoNCiAgICAgICAgICAgIGxhYmVsX2ZpbHRlciA9IHNpdGsuTGFiZWxTdGF0aXN0aWNzSW1hZ2VGaWx0ZXIoKQ0KICAgICAgICAgICAgbGFiZWxfZmlsdGVyLkV4ZWN1dGUoaGFiaXRhdF9pbWcsIGhhYml0YXRfaW1nKQ0KICAgICAgICAgICAgbGFiZWxzID0gbGFiZWxfZmlsdGVyLkdldExhYmVscygpDQogICAgICAgICAgICBsYWJlbHMgPSBbaW50KGxhYmVsKSBmb3IgbGFiZWwgaW4gbGFiZWxzIGlmIGxhYmVsICE9IDBdDQoNCiAgICAgICAgICAgICMgTWFrZSBhIGJpbmFyeSBpbWFnZQ0KICAgICAgICAgICAgaGFiaXRhdF9pbWdfYmluYXJ5ID0gc2l0ay5CaW5hcnlUaHJlc2hvbGQoDQogICAgICAgICAgICAgICAgaGFiaXRhdF9pbWcsIA0KICAgICAgICAgICAgICAgIGxvd2VyVGhyZXNob2xkPTEsIA0KICAgICAgICAgICAgICAgIHVwcGVyVGhyZXNob2xkPW5wLm1heChsYWJlbHMpLmFzdHlwZShucC5kb3VibGUpLCANCiAgICAgICAgICAgICAgICBpbnNpZGVWYWx1ZT0xLCANCiAgICAgICAgICAgICAgICBvdXRzaWRlVmFsdWU9MA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICByZXR1cm4gZXh0cmFjdG9yLmV4ZWN1dGUoDQogICAgICAgICAgICAgICAgaW1hZ2VGaWxlcGF0aD1oYWJpdGF0X2ltZywNCiAgICAgICAgICAgICAgICBtYXNrRmlsZXBhdGg9aGFiaXRhdF9pbWdfYmluYXJ5LCANCiAgICAgICAgICAgICAgICBsYWJlbD0xDQogICAgICAgICAgICApDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJFcnJvciBleHRyYWN0aW5nIHJhZGlvbWljcyBmZWF0dXJlcyBmcm9tIHdob2xlIGhhYml0YXQ6IHtzdHIoZSl9IikNCiAgICAgICAgICAgIHJldHVybiB7ImVycm9yIjogZiJGZWF0dXJlIGV4dHJhY3Rpb24gZXJyb3I6IHtzdHIoZSl9In0NCiAgICANCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIGV4dHJhY3RfcmFkaW9taWNzX2ZlYXR1cmVzX2Zyb21fZWFjaF9oYWJpdGF0KGhhYml0YXRfcGF0aCwgaW1hZ2VfcGF0aCwgc3ViamVjdF9pZCwgcGFyYW1zX2ZpbGUpOg0KICAgICAgICAiIiINCiAgICAgICAgRXh0cmFjdCByYWRpb21pY3MgZmVhdHVyZXMgZnJvbSBvcmlnaW5hbCBpbWFnZXMgd2l0aGluIGVhY2ggaGFiaXRhdA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGhhYml0YXRfcGF0aDogUGF0aCB0byBoYWJpdGF0IG1hcCBmaWxlDQogICAgICAgICAgICBpbWFnZV9wYXRoOiBQYXRoIHRvIG9yaWdpbmFsIGltYWdlIGZpbGUNCiAgICAgICAgICAgIHN1YmplY3RfaWQ6IFN1YmplY3QgaWRlbnRpZmllcg0KICAgICAgICAgICAgcGFyYW1zX2ZpbGU6IFBhcmFtZXRlciBmaWxlIGZvciBQeVJhZGlvbWljcyBmZWF0dXJlIGV4dHJhY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgRGljdDogRGljdGlvbmFyeSBjb250YWluaW5nIGV4dHJhY3RlZCByYWRpb21pY3MgZmVhdHVyZXMgZm9yIGVhY2ggaGFiaXRhdA0KICAgICAgICAiIiINCiAgICAgICAgZXh0cmFjdG9yID0gZmVhdHVyZWV4dHJhY3Rvci5SYWRpb21pY3NGZWF0dXJlRXh0cmFjdG9yKHBhcmFtc19maWxlKQ0KICAgICAgICANCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgaGFiaXRhdF9pbWcgPSBzaXRrLlJlYWRJbWFnZShoYWJpdGF0X3BhdGgpDQogICAgICAgICAgICByYXdfaW1nID0gc2l0ay5SZWFkSW1hZ2UoaW1hZ2VfcGF0aCkNCg0KICAgICAgICAgICAgIyBDaGVjayBhbmQgYWRqdXN0IGltYWdlIG1ldGFkYXRhIGZvciBjb25zaXN0ZW5jeQ0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXREaXJlY3Rpb24oKSAhPSBoYWJpdGF0X2ltZy5HZXREaXJlY3Rpb24oKToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oZiJSYXcgYW5kIG1hc2sgZGlyZWN0aW9uIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXREaXJlY3Rpb24ocmF3X2ltZy5HZXREaXJlY3Rpb24oKSkNCg0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXRPcmlnaW4oKSAhPSBoYWJpdGF0X2ltZy5HZXRPcmlnaW4oKToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oZiJSYXcgYW5kIG1hc2sgb3JpZ2luIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXRPcmlnaW4ocmF3X2ltZy5HZXRPcmlnaW4oKSkNCg0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXRTcGFjaW5nKCkgIT0gaGFiaXRhdF9pbWcuR2V0U3BhY2luZygpOg0KICAgICAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmIlJhdyBhbmQgbWFzayBzcGFjaW5nIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXRTcGFjaW5nKHJhd19pbWcuR2V0U3BhY2luZygpKQ0KDQogICAgICAgICAgICBsYWJlbCA9IHNpdGsuTGFiZWxTdGF0aXN0aWNzSW1hZ2VGaWx0ZXIoKQ0KICAgICAgICAgICAgbGFiZWwuRXhlY3V0ZShoYWJpdGF0X2ltZywgaGFiaXRhdF9pbWcpDQogICAgICAgICAgICBsYWJlbHMgPSBsYWJlbC5HZXRMYWJlbHMoKQ0KICAgICAgICAgICAgbGFiZWxzID0gW2ludChsYWJlbCkgZm9yIGxhYmVsIGluIGxhYmVscyBpZiBsYWJlbCAhPSAwXQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiRXJyb3IgcHJlcGFyaW5nIGhhYml0YXQgaW1hZ2UgZGF0YToge3N0cihlKX0iKQ0KICAgICAgICAgICAgcmV0dXJuIHt9DQoNCiAgICAgICAgZmVhdHVyZV92ZWN0b3IgPSB7fQ0KICAgICAgICBmb3IgbGFiZWwgaW4gbGFiZWxzOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGZlYXR1cmVfdmVjdG9yW2xhYmVsXSA9IGV4dHJhY3Rvci5leGVjdXRlKA0KICAgICAgICAgICAgICAgICAgICBpbWFnZUZpbGVwYXRoPXJhd19pbWcsIA0KICAgICAgICAgICAgICAgICAgICBtYXNrRmlsZXBhdGg9aGFiaXRhdF9pbWcsIA0KICAgICAgICAgICAgICAgICAgICBsYWJlbD1sYWJlbA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiRXJyb3IgZXh0cmFjdGluZyByYWRpb21pY3MgZmVhdHVyZXMgZm9yIGhhYml0YXQge2xhYmVsfToge3N0cihlKX0iKQ0KICAgICAgICAgICAgICAgIGZlYXR1cmVfdmVjdG9yW2xhYmVsXSA9IHt9DQogICAgICAgICAgICAgICANCiAgICAgICAgcmV0dXJuIGZlYXR1cmVfdmVjdG9yDQogICAgDQogICAgQHN0YXRpY21ldGhvZA0KICAgIGRlZiBleHRyYWN0X3RyYW5kaXRpb25hbF9yYWRpb21pY3MoaW1hZ2VfcGF0aCwgaGFiaXRhdF9wYXRoLCBzdWJqZWN0X2lkLCBwYXJhbXNfZmlsZSk6DQogICAgICAgICIiIg0KICAgICAgICBFeHRyYWN0IHRyYWRpdGlvbmFsIHJhZGlvbWljcyBmZWF0dXJlcyBmcm9tIG9yaWdpbmFsIGltYWdlcw0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGltYWdlX3BhdGg6IFBhdGggdG8gb3JpZ2luYWwgaW1hZ2UgZmlsZQ0KICAgICAgICAgICAgaGFiaXRhdF9wYXRoOiBQYXRoIHRvIGhhYml0YXQgbWFwIGZpbGUNCiAgICAgICAgICAgIHN1YmplY3RfaWQ6IFN1YmplY3QgaWRlbnRpZmllcg0KICAgICAgICAgICAgcGFyYW1zX2ZpbGU6IFBhcmFtZXRlciBmaWxlIGZvciBQeVJhZGlvbWljcyBmZWF0dXJlIGV4dHJhY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgRGljdDogRGljdGlvbmFyeSBjb250YWluaW5nIGV4dHJhY3RlZCB0cmFkaXRpb25hbCByYWRpb21pY3MgZmVhdHVyZXMNCiAgICAgICAgIiIiDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGV4dHJhY3RvciA9IGZlYXR1cmVleHRyYWN0b3IuUmFkaW9taWNzRmVhdHVyZUV4dHJhY3RvcihwYXJhbXNfZmlsZSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaGFiaXRhdF9pbWcgPSBzaXRrLlJlYWRJbWFnZShoYWJpdGF0X3BhdGgpDQogICAgICAgICAgICByYXdfaW1nID0gc2l0ay5SZWFkSW1hZ2UoaW1hZ2VfcGF0aCkNCg0KICAgICAgICAgICAgIyBDaGVjayBhbmQgYWRqdXN0IGltYWdlIG1ldGFkYXRhIGZvciBjb25zaXN0ZW5jeQ0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXREaXJlY3Rpb24oKSAhPSBoYWJpdGF0X2ltZy5HZXREaXJlY3Rpb24oKToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oZiJSYXcgYW5kIG1hc2sgZGlyZWN0aW9uIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXREaXJlY3Rpb24ocmF3X2ltZy5HZXREaXJlY3Rpb24oKSkNCg0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXRPcmlnaW4oKSAhPSBoYWJpdGF0X2ltZy5HZXRPcmlnaW4oKToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oZiJSYXcgYW5kIG1hc2sgb3JpZ2luIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXRPcmlnaW4ocmF3X2ltZy5HZXRPcmlnaW4oKSkNCg0KICAgICAgICAgICAgaWYgcmF3X2ltZy5HZXRTcGFjaW5nKCkgIT0gaGFiaXRhdF9pbWcuR2V0U3BhY2luZygpOg0KICAgICAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmIlJhdyBhbmQgbWFzayBzcGFjaW5nIGlzIGRpZmZlcmVudDoge3N1YmplY3RfaWR9IikNCiAgICAgICAgICAgICAgICBoYWJpdGF0X2ltZy5TZXRTcGFjaW5nKHJhd19pbWcuR2V0U3BhY2luZygpKQ0KDQogICAgICAgICAgICBsYWJlbF9maWx0ZXIgPSBzaXRrLkxhYmVsU3RhdGlzdGljc0ltYWdlRmlsdGVyKCkNCiAgICAgICAgICAgIGxhYmVsX2ZpbHRlci5FeGVjdXRlKGhhYml0YXRfaW1nLCBoYWJpdGF0X2ltZykNCiAgICAgICAgICAgIGxhYmVscyA9IGxhYmVsX2ZpbHRlci5HZXRMYWJlbHMoKQ0KICAgICAgICAgICAgbGFiZWxzID0gW2ludChsYWJlbCkgZm9yIGxhYmVsIGluIGxhYmVscyBpZiBsYWJlbCAhPSAwXQ0KDQogICAgICAgICAgICBtYXNrID0gc2l0ay5CaW5hcnlUaHJlc2hvbGQoDQogICAgICAgICAgICAgICAgaGFiaXRhdF9pbWcsIA0KICAgICAgICAgICAgICAgIGxvd2VyVGhyZXNob2xkPTEsIA0KICAgICAgICAgICAgICAgIHVwcGVyVGhyZXNob2xkPW5wLm1heChsYWJlbHMpLmFzdHlwZShucC5kb3VibGUpLCANCiAgICAgICAgICAgICAgICBpbnNpZGVWYWx1ZT0xLCANCiAgICAgICAgICAgICAgICBvdXRzaWRlVmFsdWU9MA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICByZXR1cm4gZXh0cmFjdG9yLmV4ZWN1dGUoDQogICAgICAgICAgICAgICAgaW1hZ2VGaWxlcGF0aD1yYXdfaW1nLA0KICAgICAgICAgICAgICAgIG1hc2tGaWxlcGF0aD1tYXNrLCANCiAgICAgICAgICAgICAgICBsYWJlbD0xDQogICAgICAgICAgICApDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJFcnJvciBleHRyYWN0aW5nIHRyYWRpdGlvbmFsIHJhZGlvbWljcyBmZWF0dXJlczoge3N0cihlKX0iKQ0KICAgICAgICAgICAgcmV0dXJuIHsiZXJyb3IiOiBmIkZlYXR1cmUgZXh0cmFjdGlvbiBlcnJvcjoge3N0cihlKX0ifSA=').decode())
