
import base64
exec(base64.b64decode(b'aW1wb3J0IHBhbmRhcyBhcyBwZA0KaW1wb3J0IG9zDQoNCmRlZiBmbGF0dGVuX2RpY3QoZGF0YSk6DQogICAgIiIiDQogICAg5bCG5bWM5aWX5a2X5YW45omB5bmz5YyW5Li65oyH5a6a5qC85byP55qE5a2X5YW444CCDQogICAg5L6L5aaC77yaDQogICAg6L6T5YWl77yaezE6IHsnbnVtX3JlZ2lvbnMnOiAyMywgJ3ZvbHVtZV9yYXRpbyc6IDAuNDkyOTc3NTI4MDg5ODg3NjV9LCAzOiB7J251bV9yZWdpb25zJzogNSwgJ3ZvbHVtZV9yYXRpbyc6IDAuNTA3MDIyNDcxOTEwMTEyNH0sICdudW1faGFiaXRhdHMnOiAyfQ0KICAgIOi+k+WHuu+8mnsnbnVtX3JlZ2lvbnNfMSc6IDIzLCAndm9sdW1lX3JhdGlvXzEnOiAwLjQ5Mjk3NzUyODA4OTg4NzY1LCAnbnVtX3JlZ2lvbnNfMyc6IDUsICd2b2x1bWVfcmF0aW9fMyc6IDAuNTA3MDIyNDcxOTEwMTEyNCwgJ251bV9oYWJpdGF0cyc6IDJ9DQogICAgIiIiDQogICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YSwgZGljdCk6DQogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIui+k+WFpeW/hemhu+aYr+S4gOS4quWtl+WFuO+8iGRpY3TvvInjgIIiKQ0KDQogICAgZmxhdF9kaWN0ID0ge30NCiAgICBmb3Iga2V5LCB2YWx1ZSBpbiBkYXRhLml0ZW1zKCk6DQogICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIGRpY3QpOiAgIyDlpoLmnpzlgLzmmK/lrZflhbjvvIzov5vkuIDmraXlsZXlvIANCiAgICAgICAgICAgIGZvciBzdWJfa2V5LCBzdWJfdmFsdWUgaW4gdmFsdWUuaXRlbXMoKToNCiAgICAgICAgICAgICAgICBmbGF0X2RpY3RbZiJ7c3ViX2tleX1fe2tleX0iXSA9IHN1Yl92YWx1ZQ0KICAgICAgICBlbHNlOiAgIyDlpoLmnpzlgLzkuI3mmK/lrZflhbjvvIznm7TmjqXmt7vliqDliLDnu5PmnpzkuK0NCiAgICAgICAgICAgIGZsYXRfZGljdFtrZXldID0gdmFsdWUNCiAgICByZXR1cm4gZmxhdF9kaWN0DQoNCmRlZiBzYXZlX3RvX2V4Y2VsX3NoZWV0KGRmLCBmaWxlX25hbWUsIHNoZWV0X25hbWUpOg0KICAgICIiIg0KICAgIOWwhiBEYXRhRnJhbWUg5YaZ5YWlIEV4Y2VsIOaWh+S7tu+8mg0KICAgIC0g6Iul5paH5Lu25a2Y5Zyo77ya6KaG55uW5oyH5a6aIFNoZWV077yM5L+d55WZ5YW25LuWIFNoZWV0DQogICAgLSDoi6Xmlofku7bkuI3lrZjlnKjvvJrliJvlu7rmlrDmlofku7blubblhpnlhaUgU2hlZXQNCiAgICAiIiINCiAgICB0cnk6DQogICAgICAgICMg5bCd6K+V6L+95Yqg5qih5byP77yI5paH5Lu25bey5a2Y5Zyo77yJDQogICAgICAgIHdpdGggcGQuRXhjZWxXcml0ZXIoZmlsZV9uYW1lLCBlbmdpbmU9J29wZW5weXhsJywgbW9kZT0nYScpIGFzIHdyaXRlcjoNCiAgICAgICAgICAgICMg5qOA5p+l55uu5qCHIFNoZWV0IOaYr+WQpuWtmOWcqA0KICAgICAgICAgICAgaWYgc2hlZXRfbmFtZSBpbiB3cml0ZXIuYm9vay5zaGVldG5hbWVzOg0KICAgICAgICAgICAgICAgICMg5Yig6Zmk5penIFNoZWV0DQogICAgICAgICAgICAgICAgd3JpdGVyLmJvb2sucmVtb3ZlKHdyaXRlci5ib29rW3NoZWV0X25hbWVdKQ0KICAgICAgICAgICAgIyDlhpnlhaXmlrAgU2hlZXQNCiAgICAgICAgICAgIGRmLnRvX2V4Y2VsKHdyaXRlciwgc2hlZXRfbmFtZT1zaGVldF9uYW1lLCBpbmRleD1UcnVlKQ0KICAgICAgICAgICAgcHJpbnQoZiLinIUg5pWw5o2u5bey6KaG55uW5YaZ5YWl5paH5Lu2IHtmaWxlX25hbWV9IOeahCBTaGVldCBbe3NoZWV0X25hbWV9XSIpDQogICAgICAgICAgICANCiAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6DQogICAgICAgICMg5paH5Lu25LiN5a2Y5Zyo77yM5Yib5bu65paw5paH5Lu2DQogICAgICAgIHdpdGggcGQuRXhjZWxXcml0ZXIoZmlsZV9uYW1lLCBlbmdpbmU9J29wZW5weXhsJywgbW9kZT0ndycpIGFzIHdyaXRlcjoNCiAgICAgICAgICAgIGRmLnRvX2V4Y2VsKHdyaXRlciwgc2hlZXRfbmFtZT1zaGVldF9uYW1lLCBpbmRleD1UcnVlKQ0KICAgICAgICAgICAgcHJpbnQoZiLwn4aVIOaWh+S7tiB7ZmlsZV9uYW1lfSDkuI3lrZjlnKjvvIzlt7LliJvlu7rlubblhpnlhaUgU2hlZXQgW3tzaGVldF9uYW1lfV0iKQ0KICAgICAgICAgICAgDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChmIuKdjCDkv53lrZjlpLHotKXvvIzplJnor6/vvJp7c3RyKGUpfSIpDQoNCg0KDQo=').decode())
