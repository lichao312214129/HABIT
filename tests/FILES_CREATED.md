# æµ‹è¯•å¥—ä»¶æ–‡ä»¶æ¸…å•

æœ¬æ–‡æ¡£åˆ—å‡ºæ‰€æœ‰åˆ›å»ºçš„æµ‹è¯•æ–‡ä»¶åŠå…¶ç”¨é€”ã€‚

## åˆ›å»ºæ—¥æœŸ
2025-11-10

## æ–‡ä»¶æ€»æ•°
26ä¸ªæ–‡ä»¶

---

## ğŸ“‹ é…ç½®æ–‡ä»¶ (3ä¸ª)

| æ–‡ä»¶å | ç”¨é€” | è¯´æ˜ |
|--------|------|------|
| `__init__.py` | PythonåŒ…åˆå§‹åŒ– | ä½¿testsæˆä¸ºä¸€ä¸ªPythonåŒ… |
| `conftest.py` | Pytest fixtures | å…±äº«çš„æµ‹è¯•fixtureså’Œé…ç½® |
| `pytest.ini` | Pytesté…ç½® | Pytestè¿è¡Œå‚æ•°å’Œæ ‡è®°å®šä¹‰ |

---

## ğŸ› Debugè„šæœ¬ (9ä¸ª)

è¿™äº›è„šæœ¬æ¨¡æ‹ŸCLIå‘½ä»¤ï¼Œç”¨äºå¿«é€Ÿæµ‹è¯•ç‰¹å®šæ¨¡å—ã€‚

| æ–‡ä»¶å | æµ‹è¯•æ¨¡å— | å‘½ä»¤ | é…ç½®æ–‡ä»¶ |
|--------|---------|------|---------|
| `debug_preprocess.py` | å›¾åƒé¢„å¤„ç† | `habit preprocess` | `config_image_preprocessing.yaml` |
| `debug_habitat.py` | æ –æ¯åœ°åˆ†æ | `habit habitat` | `config_habitat_analysis.yaml` |
| `debug_extract_features.py` | ç‰¹å¾æå– | `habit extract-features` | `config_feature_extraction.yaml` |
| `debug_radiomics.py` | å½±åƒç»„å­¦ | `habit radiomics` | `config_radiomics.yaml` |
| `debug_ml.py` | æœºå™¨å­¦ä¹  | `habit ml` | `config_ml.yaml` |
| `debug_kfold.py` | KæŠ˜äº¤å‰éªŒè¯ | `habit kfold` | `config_kfold.yaml` |
| `debug_icc.py` | ICCåˆ†æ | `habit icc` | `config_icc.yaml` |
| `debug_test_retest.py` | é‡æµ‹ä¿¡åº¦ | `habit test-retest` | `config_test_retest.yaml` |
| `debug_compare.py` | æ¨¡å‹æ¯”è¾ƒ | `habit compare` | `config_compare.yaml` |

### ä½¿ç”¨æ–¹å¼
```bash
# ç›´æ¥è¿è¡Œ
python tests/debug_preprocess.py

# æˆ–ä½¿ç”¨äº¤äº’å¼èœå•
python tests/run_debug_menu.py
```

---

## ğŸ§ª å•å…ƒæµ‹è¯•æ–‡ä»¶ (5ä¸ª)

å®Œæ•´çš„pytestå•å…ƒæµ‹è¯•ï¼ŒåŒ…å«24ä¸ªæµ‹è¯•ç±»ã€‚

### 1. `test_preprocessing.py` (5ä¸ªæµ‹è¯•ç±»)
- `TestN4Correction` - N4åç½®åœºæ ¡æ­£æµ‹è¯•
- `TestResample` - å›¾åƒé‡é‡‡æ ·æµ‹è¯•
- `TestRegistration` - å›¾åƒé…å‡†æµ‹è¯•
- `TestZscoreNormalization` - Z-scoreæ ‡å‡†åŒ–æµ‹è¯•
- `TestHistogramStandardization` - ç›´æ–¹å›¾æ ‡å‡†åŒ–æµ‹è¯•

### 2. `test_habitat_analysis.py` (3ä¸ªæµ‹è¯•ç±»)
- `TestClustering` - èšç±»ç®—æ³•æµ‹è¯•
  - K-means, GMM, å±‚æ¬¡èšç±», DBSCAN, è°±èšç±»
- `TestFeatureExtraction` - ç‰¹å¾æå–æµ‹è¯•
  - åŸºç¡€ç‰¹å¾, å½±åƒç»„å­¦ç‰¹å¾, ITHç‰¹å¾, MSIç‰¹å¾
- `TestClusterValidation` - èšç±»éªŒè¯æµ‹è¯•
  - è½®å»“ç³»æ•°, Davies-Bouldin, Calinski-Harabasz

### 3. `test_machine_learning.py` (7ä¸ªæµ‹è¯•ç±»)
- `TestFeatureSelectors` - ç‰¹å¾é€‰æ‹©å™¨æµ‹è¯•
  - LASSO, mRMR, RFE, å•å˜é‡, ICC, æ–¹å·®, VIF
- `TestModels` - MLæ¨¡å‹æµ‹è¯•
  - é€»è¾‘å›å½’, éšæœºæ£®æ—, SVM, XGBoost, LightGBM
- `TestEvaluation` - æ¨¡å‹è¯„ä¼°æµ‹è¯•
  - AUC, æ··æ·†çŸ©é˜µ, æ ¡å‡†æŒ‡æ ‡
- `TestKFoldCV` - KæŠ˜äº¤å‰éªŒè¯æµ‹è¯•
- `TestStatistics` - ç»Ÿè®¡æ£€éªŒæµ‹è¯•
  - DeLong, Hosmer-Lemeshow

### 4. `test_utils.py` (7ä¸ªæµ‹è¯•ç±»)
- `TestConfigUtils` - é…ç½®å·¥å…·æµ‹è¯•
- `TestFileSystemUtils` - æ–‡ä»¶ç³»ç»Ÿå·¥å…·æµ‹è¯•
- `TestIOUtils` - I/Oå·¥å…·æµ‹è¯•
- `TestProgressUtils` - è¿›åº¦æ¡å·¥å…·æµ‹è¯•
- `TestLogUtils` - æ—¥å¿—å·¥å…·æµ‹è¯•
- `TestVisualizationUtils` - å¯è§†åŒ–å·¥å…·æµ‹è¯•

### 5. `test_cli.py` (2ä¸ªæµ‹è¯•ç±»)
- `TestCLICommands` - CLIå‘½ä»¤æµ‹è¯•
- `TestCLIConfigValidation` - é…ç½®éªŒè¯æµ‹è¯•

### ä½¿ç”¨æ–¹å¼
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/ -v

# è¿è¡Œç‰¹å®šæ–‡ä»¶
pytest tests/test_preprocessing.py -v

# è¿è¡Œç‰¹å®šç±»
pytest tests/test_preprocessing.py::TestN4Correction -v

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_preprocessing.py::TestN4Correction::test_n4_correction_basic -v
```

---

## ğŸš€ æµ‹è¯•è¿è¡Œå™¨ (2ä¸ª)

ä¾¿æ·çš„æµ‹è¯•æ‰§è¡Œå·¥å…·ã€‚

| æ–‡ä»¶å | åŠŸèƒ½ | ä½¿ç”¨æ–¹å¼ |
|--------|------|---------|
| `run_all_tests.py` | è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š | `python tests/run_all_tests.py` |
| `run_debug_menu.py` | äº¤äº’å¼debugè„šæœ¬èœå• | `python tests/run_debug_menu.py` |

### run_all_tests.py åŠŸèƒ½
- è‡ªåŠ¨è¿è¡Œæ‰€æœ‰pytestæµ‹è¯•
- ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šï¼ˆå¦‚æœå®‰è£…äº†pytest-covï¼‰
- æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„debugè„šæœ¬

### run_debug_menu.py åŠŸèƒ½
- äº¤äº’å¼èœå•
- é€‰æ‹©è¦è¿è¡Œçš„debugè„šæœ¬
- ç›´æ¥æ‰§è¡Œé€‰ä¸­çš„è„šæœ¬

---

## ğŸ“š æ–‡æ¡£æ–‡ä»¶ (6ä¸ª)

å®Œæ•´çš„æµ‹è¯•æ–‡æ¡£å’ŒæŒ‡å—ã€‚

| æ–‡ä»¶å | ç”¨é€” | ç›®æ ‡è¯»è€… |
|--------|------|---------|
| `README.md` | æµ‹è¯•æ–‡æ¡£æ€»è§ˆï¼ˆè‹±æ–‡ï¼‰ | æ‰€æœ‰ç”¨æˆ· |
| `TESTING_GUIDE.md` | è¯¦ç»†æµ‹è¯•æŒ‡å—ï¼ˆä¸­æ–‡ï¼‰ | æ·±å…¥ä½¿ç”¨ |
| `QUICKSTART.md` | 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹ | æ–°æ‰‹ â­ |
| `TEST_CHECKLIST.md` | æµ‹è¯•è¦†ç›–æ¸…å• | å¼€å‘è€… |
| `TEST_SUMMARY.md` | æµ‹è¯•å¥—ä»¶æ€»ç»“ | æ‰€æœ‰ç”¨æˆ· |
| `DIRECTORY_TREE.txt` | ç›®å½•ç»“æ„è¯´æ˜ | æ‰€æœ‰ç”¨æˆ· |

### æ–‡æ¡£å†…å®¹æ¦‚è§ˆ

#### README.md
- æµ‹è¯•ç»“æ„è¯´æ˜
- è¿è¡Œæµ‹è¯•çš„åŸºæœ¬æ–¹æ³•
- é…ç½®æ–‡ä»¶å‡†å¤‡
- æ•…éšœæ’æŸ¥

#### TESTING_GUIDE.md (æ¨èè¯¦ç»†é˜…è¯»)
- æµ‹è¯•æ–‡ä»¶ç»“æ„è¯¦è§£
- Debugè„šæœ¬è¯¦ç»†ç”¨æ³•
- å•å…ƒæµ‹è¯•ç¼–å†™æŒ‡å—
- ä½¿ç”¨fixtures
- CI/CDé›†æˆ
- æœ€ä½³å®è·µ
- å®Œæ•´çš„æ•…éšœæ’æŸ¥

#### QUICKSTART.md (æ¨èæ–°æ‰‹é˜…è¯») â­
- 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
- å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥
- ç¬¬ä¸€ä¸ªæµ‹è¯•ç¤ºä¾‹
- ä¸‹ä¸€æ­¥å­¦ä¹ è·¯å¾„

#### TEST_CHECKLIST.md
- æ‰€æœ‰æ¨¡å—çš„æµ‹è¯•æ¸…å•
- æµ‹è¯•çŠ¶æ€è¿½è¸ª
- è¦†ç›–ç‡ç›®æ ‡
- ä¼˜å…ˆçº§åˆ’åˆ†
- æ›´æ–°æ—¥å¿—

#### TEST_SUMMARY.md
- æµ‹è¯•æ–‡ä»¶æ€»è§ˆ
- å¿«é€Ÿä½¿ç”¨åœºæ™¯
- é¡¹ç›®ç»“æ„
- æµ‹è¯•ç»Ÿè®¡
- å­¦ä¹ è·¯å¾„

#### DIRECTORY_TREE.txt
- å¯è§†åŒ–ç›®å½•æ ‘
- æ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯
- å¿«é€Ÿå‘½ä»¤å‚è€ƒ

---

## ğŸ› ï¸ é…ç½®æ¨¡æ¿ (1ä¸ª)

| æ–‡ä»¶å | ç”¨é€” |
|--------|------|
| `config_template.yaml` | é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼Œå±•ç¤ºæ‰€æœ‰å¯ç”¨é…ç½®é€‰é¡¹ |

### åŒ…å«çš„é…ç½®ç±»å‹
- åŸºç¡€é…ç½®ï¼ˆæ‰€æœ‰æ¨¡å—é€šç”¨ï¼‰
- é¢„å¤„ç†é…ç½®ï¼ˆN4æ ¡æ­£ã€é‡é‡‡æ ·ã€é…å‡†ã€æ ‡å‡†åŒ–ï¼‰
- æ –æ¯åœ°åˆ†æé…ç½®ï¼ˆèšç±»ã€ç‰¹å¾æå–ï¼‰
- å½±åƒç»„å­¦é…ç½®ï¼ˆPyRadiomicså‚æ•°ï¼‰
- ç‰¹å¾é€‰æ‹©é…ç½®ï¼ˆå¤šç§é€‰æ‹©å™¨ï¼‰
- æœºå™¨å­¦ä¹ é…ç½®ï¼ˆæ¨¡å‹ã€å‚æ•°ï¼‰
- KæŠ˜äº¤å‰éªŒè¯é…ç½®
- ICCåˆ†æé…ç½®
- æ¨¡å‹æ¯”è¾ƒé…ç½®
- å¯è§†åŒ–é…ç½®

---

## ğŸ“Š æ–‡ä»¶ç»Ÿè®¡

```
æ€»è®¡: 26ä¸ªæ–‡ä»¶

æŒ‰ç±»å‹åˆ†ç±»:
â”œâ”€â”€ é…ç½®æ–‡ä»¶: 3ä¸ª
â”œâ”€â”€ Debugè„šæœ¬: 9ä¸ª
â”œâ”€â”€ å•å…ƒæµ‹è¯•: 5ä¸ª
â”œâ”€â”€ æµ‹è¯•è¿è¡Œå™¨: 2ä¸ª
â”œâ”€â”€ æ–‡æ¡£: 6ä¸ª
â””â”€â”€ é…ç½®æ¨¡æ¿: 1ä¸ª

æŒ‰åŠŸèƒ½åˆ†ç±»:
â”œâ”€â”€ æµ‹è¯•ä»£ç : 14ä¸ª (Debug + Unit Tests)
â”œâ”€â”€ æµ‹è¯•å·¥å…·: 2ä¸ª (Runners)
â”œâ”€â”€ æµ‹è¯•é…ç½®: 4ä¸ª (Config + Template)
â””â”€â”€ æµ‹è¯•æ–‡æ¡£: 6ä¸ª (Docs)

ä»£ç è¡Œæ•°ä¼°è®¡:
â”œâ”€â”€ Debugè„šæœ¬: ~100è¡Œ
â”œâ”€â”€ å•å…ƒæµ‹è¯•: ~500è¡Œ
â”œâ”€â”€ æµ‹è¯•è¿è¡Œå™¨: ~150è¡Œ
â”œâ”€â”€ é…ç½®æ–‡ä»¶: ~100è¡Œ
â””â”€â”€ æ–‡æ¡£: ~3000è¡Œ
æ€»è®¡: ~3850è¡Œ
```

---

## ğŸ¯ ä½¿ç”¨æµç¨‹å›¾

```
æ–°ç”¨æˆ·å…¥é—¨æµç¨‹:
1. é˜…è¯» QUICKSTART.md (5åˆ†é’Ÿ)
2. è¿è¡Œ python tests/run_debug_menu.py (ä½“éªŒ)
3. è¿è¡Œ pytest tests/test_cli.py -v (æŸ¥çœ‹å•å…ƒæµ‹è¯•)
4. é˜…è¯» TESTING_GUIDE.md (æ·±å…¥å­¦ä¹ )

æ—¥å¸¸ä½¿ç”¨æµç¨‹:
1. ä¿®æ”¹ä»£ç 
2. è¿è¡Œç›¸å…³æµ‹è¯•: pytest tests/test_<module>.py -v
3. æ£€æŸ¥è¦†ç›–ç‡: pytest tests/ --cov=habit
4. æäº¤å‰è¿è¡Œ: python tests/run_all_tests.py

è°ƒè¯•ç‰¹å®šæ¨¡å—:
1. å‡†å¤‡é…ç½®æ–‡ä»¶
2. ä¿®æ”¹debugè„šæœ¬ä¸­çš„è·¯å¾„
3. è¿è¡Œ: python tests/debug_<module>.py
æˆ–ä½¿ç”¨: python tests/run_debug_menu.py

å¼€å‘æ–°åŠŸèƒ½:
1. æŸ¥çœ‹ TEST_CHECKLIST.md ç¡®å®šæµ‹è¯•èŒƒå›´
2. ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆTDDæ–¹å¼ï¼‰
3. å®ç°åŠŸèƒ½
4. è¿è¡Œæµ‹è¯•éªŒè¯
5. æ›´æ–°æµ‹è¯•æ¸…å•
```

---

## ğŸ”— æ–‡ä»¶ä¾èµ–å…³ç³»

```
tests/
â”‚
â”œâ”€â”€ æ ¸å¿ƒä¾èµ–
â”‚   â”œâ”€â”€ conftest.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â””â”€â”€ pytest.ini â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ æ‰€æœ‰å•å…ƒæµ‹è¯•æ–‡ä»¶
â”‚                           â”‚
â”œâ”€â”€ Debugè„šæœ¬                â”‚
â”‚   â”œâ”€â”€ debug_*.py â”€â”€â”€â”€â”€â†’ habit.cli
â”‚   â””â”€â”€ config_template.yaml
â”‚                           â”‚
â”œâ”€â”€ å•å…ƒæµ‹è¯• â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   â””â”€â”€ test_*.py â”€â”€â”€â”€â”€â†’ habit.* (å„æ¨¡å—)
â”‚
â”œâ”€â”€ è¿è¡Œå™¨
â”‚   â”œâ”€â”€ run_all_tests.py â”€â”€â”€â†’ pytest, test_*.py
â”‚   â””â”€â”€ run_debug_menu.py â”€â”€â†’ debug_*.py
â”‚
â””â”€â”€ æ–‡æ¡£ (ç‹¬ç«‹)
    â””â”€â”€ *.md
```

---

## âœ… éªŒè¯æ¸…å•

åˆ›å»ºå®Œæˆåï¼Œè¯·éªŒè¯ï¼š

- [x] æ‰€æœ‰26ä¸ªæ–‡ä»¶å·²åˆ›å»º
- [x] Debugè„šæœ¬æ ¼å¼ä¸€è‡´
- [x] å•å…ƒæµ‹è¯•æ–‡ä»¶ç»“æ„å®Œæ•´
- [x] æµ‹è¯•è¿è¡Œå™¨å¯æ‰§è¡Œ
- [x] æ–‡æ¡£å†…å®¹è¯¦å°½
- [x] é…ç½®æ¨¡æ¿å®Œæ•´

---

## ğŸ“ åç»­å·¥ä½œ

1. **å®ç°å•å…ƒæµ‹è¯•**
   - å½“å‰å•å…ƒæµ‹è¯•åªæ˜¯æ¡†æ¶ï¼Œéœ€è¦å®ç°å…·ä½“æµ‹è¯•é€»è¾‘
   - å‚è€ƒ TEST_CHECKLIST.md ä¸­çš„æ¸…å•

2. **å‡†å¤‡é…ç½®æ–‡ä»¶**
   - åœ¨ demo_image_data/ ç›®å½•åˆ›å»ºå®é™…é…ç½®æ–‡ä»¶
   - å‚è€ƒ config_template.yaml

3. **è¿è¡Œæµ‹è¯•**
   - é€ä¸ªè¿è¡Œdebugè„šæœ¬éªŒè¯åŠŸèƒ½
   - è¿è¡Œå•å…ƒæµ‹è¯•ç¡®ä¿æ¡†æ¶æ­£ç¡®

4. **æŒç»­æ”¹è¿›**
   - æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µæ›´æ–°æ–‡æ¡£
   - æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹
   - æé«˜æµ‹è¯•è¦†ç›–ç‡

---

## ğŸ‰ å®Œæˆï¼

æµ‹è¯•å¥—ä»¶å·²ç»å®Œå…¨åˆ›å»ºï¼ŒåŒ…æ‹¬ï¼š
- âœ… 9ä¸ªDebugè„šæœ¬
- âœ… 5ä¸ªå•å…ƒæµ‹è¯•æ–‡ä»¶ï¼ˆ24ä¸ªæµ‹è¯•ç±»ï¼‰
- âœ… 2ä¸ªæµ‹è¯•è¿è¡Œå™¨
- âœ… 6ä¸ªè¯¦ç»†æ–‡æ¡£
- âœ… 1ä¸ªé…ç½®æ¨¡æ¿

**ä¸‹ä¸€æ­¥**: é˜…è¯» `QUICKSTART.md` å¼€å§‹ä½¿ç”¨æµ‹è¯•å¥—ä»¶ï¼

