# HABIT Configuration Template
# 这是一个配置文件模板，展示了各种可用的配置选项

# ============================================================================
# 基础配置 (所有模块都需要)
# ============================================================================

# 数据目录路径
data_dir: /path/to/your/data

# 输出目录路径
out_dir: /path/to/your/output

# 并行进程数
processes: 4

# 随机种子（用于可重复性）
random_state: 42

# 是否自动选择目录中的第一个文件
# true: 自动读取目录中的第一个文件 (适用于已转换的nii文件等场景)
# false: 保持目录路径不变 (适用于dcm2nii等需要整个文件夹的任务)
auto_select_first_file: true

# ============================================================================
# 预处理配置 (Preprocessing)
# ============================================================================

Preprocessing:
  
  # --------------------------------------------------------------------------
  # N4 偏置场校正
  # --------------------------------------------------------------------------
  # n4_correction:
  #   images: [T1, T2, T2_FLAIR]          # 要处理的图像序列
  #   num_fitting_levels: 4                # 拟合层级数 (默认: 4)
  #   num_iterations: [50, 50, 50, 50]     # 每层的迭代次数
  
  # --------------------------------------------------------------------------
  # 图像重采样
  # --------------------------------------------------------------------------
  # resample:
  #   images: [T1, T2, T2_FLAIR]          # 要重采样的图像
  #   target_spacing: [1.0, 1.0, 1.0]     # 目标体素间距 [x, y, z] (mm)
  
  # --------------------------------------------------------------------------
  # 图像配准
  # --------------------------------------------------------------------------
  # registration:
  #   images: [T1, T2, T2_FLAIR, mask]    # 所有需要配准的图像
  #   fixed_image: T1                      # 固定图像（参考图像）
  #   moving_images: [T2, T2_FLAIR]       # 移动图像（需要配准到固定图像）
  #   type_of_transform: SyNRA             # 配准类型: Rigid, Affine, SyN, SyNRA等
  #   use_mask: false                      # 是否使用掩码
  
  # --------------------------------------------------------------------------
  # Z-Score 标准化
  # --------------------------------------------------------------------------
  # zscore_normalization:
  #   images: [T1, T2, T2_FLAIR]          # 要标准化的图像
  #   only_inmask: false                   # 是否仅在掩码内计算统计量
  #   # mask_key: mask                     # 掩码名称（当only_inmask=true时）
  
  # --------------------------------------------------------------------------
  # 直方图标准化
  # --------------------------------------------------------------------------
  # histogram_standardization:
  #   images: [T1, T2, T2_FLAIR]          # 要标准化的图像
  #   reference_key: T1                    # 参考图像的键名

# ============================================================================
# 栖息地分析配置 (Habitat Analysis)
# ============================================================================

HabitatAnalysis:
  
  # 聚类配置
  Clustering:
    method: kmeans                         # 聚类方法: kmeans, gmm, hierarchical等
    n_clusters: 3                          # 聚类数量
    
    # 不同聚类方法的特定参数
    # kmeans_params:
    #   n_init: 10
    #   max_iter: 300
    
    # gmm_params:
    #   covariance_type: full              # full, tied, diag, spherical
    
    # hierarchical_params:
    #   linkage: ward                      # ward, complete, average, single
  
  # 特征提取配置
  FeatureExtraction:
    # 要提取的特征类型
    feature_types:
      - basic                              # 基础特征（体积、均值等）
      - radiomics                          # 影像组学特征
      # - ith                              # 瘤内异质性特征
      # - msi                              # MSI特征

# ============================================================================
# 影像组学配置 (Radiomics)
# ============================================================================

Radiomics:
  # PyRadiomics 参数
  binWidth: 25                             # 灰度离散化宽度
  normalize: true                          # 是否标准化
  
  # 要提取的特征类别
  features:
    - firstorder                           # 一阶统计特征
    - shape                                # 形状特征
    - glcm                                 # 灰度共生矩阵
    - glrlm                                # 灰度游程长度矩阵
    - glszm                                # 灰度大小区域矩阵
    - gldm                                 # 灰度依赖矩阵

# ============================================================================
# 特征选择配置 (Feature Selection)
# ============================================================================

FeatureSelection:
  
  # 方差阈值选择
  - method: variance
    threshold: 0.01                        # 方差阈值
  
  # LASSO选择
  # - method: lasso
  #   alpha: 0.01                          # 正则化参数
  #   cv: 5                                # 交叉验证折数
  
  # mRMR选择
  # - method: mrmr
  #   n_features: 10                       # 选择的特征数量
  
  # RFECV选择
  # - method: rfecv
  #   estimator: logistic_regression       # 基础估计器
  #   step: 1                              # 每次移除的特征数
  #   cv: 5                                # 交叉验证折数
  
  # ICC选择
  # - method: icc
  #   threshold: 0.75                      # ICC阈值

# ============================================================================
# 机器学习配置 (Machine Learning)
# ============================================================================

MachineLearning:
  
  # 数据配置
  data_file: /path/to/features.csv         # 特征文件
  label_col: target                        # 标签列名
  
  # 数据划分
  test_size: 0.2                           # 测试集比例
  
  # 模型配置
  Model:
    name: logistic_regression              # 模型名称
    # 可选: random_forest, svm, xgboost, lightgbm等
    
    # 模型参数
    params:
      max_iter: 1000                       # 最大迭代次数
      # C: 1.0                             # 正则化参数
      # class_weight: balanced             # 类别权重

# ============================================================================
# K-Fold 交叉验证配置 (K-Fold Cross Validation)
# ============================================================================

KFoldCV:
  n_splits: 5                              # K值
  stratified: true                         # 是否分层
  shuffle: true                            # 是否打乱

# ============================================================================
# ICC 分析配置 (ICC Analysis)
# ============================================================================

ICC:
  # 测试-重测数据路径
  test_file: /path/to/test.csv
  retest_file: /path/to/retest.csv
  
  # ICC 类型
  icc_type: ICC(2,1)                       # ICC类型
  
  # 阈值
  threshold: 0.75                          # ICC阈值

# ============================================================================
# 模型比较配置 (Model Comparison)
# ============================================================================

ModelComparison:
  # 要比较的模型列表
  models:
    - model1: /path/to/model1_results.csv
    - model2: /path/to/model2_results.csv
  
  # 比较方法
  comparison_method: delong                # delong, bootstrap等

# ============================================================================
# 可视化配置 (Visualization)
# ============================================================================

Visualization:
  dpi: 300                                 # 图像分辨率
  figure_size: [8, 6]                      # 图像大小 [width, height]
  font_size: 12                            # 字体大小
  
  # 要生成的图表
  plots:
    - roc_curve                            # ROC曲线
    - confusion_matrix                     # 混淆矩阵
    - calibration_curve                    # 校准曲线
    - feature_importance                   # 特征重要性
    # - decision_curve                     # 决策曲线

