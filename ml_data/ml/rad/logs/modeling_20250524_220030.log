2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:65 - Initializing modeling with config: {'input': [{'path': './ml_data/breast_cancer_dataset.csv', 'name': None, 'subject_id_col': 'subjID', 'label_col': 'label', 'features': None}], 'output': './ml_data/ml/rad', 'split_method': 'custom', 'test_size': 0.3, 'random_state': 42, 'train_ids_file': './ml_data/train_ids.txt', 'test_ids_file': './ml_data/test_ids.txt', 'normalization': {'method': 'z_score'}, 'feature_selection_methods': [{'method': 'icc', 'params': {'icc_results': '../demo_data/results/icc_results.json', 'keys': ['breast_cancer_dataset_v2_vs_breast_cancer_dataset'], 'threshold': 0.8, 'before_z_score': False}}, {'method': 'variance', 'params': {'before_z_score': True, 'threshold': 0.2}}, {'method': 'correlation', 'params': {'threshold': 0.75, 'method': 'spearman', 'visualize': False, 'before_z_score': False}}], 'models': {'LogisticRegression': {'params': {'random_state': 42, 'max_iter': 1000, 'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}}, 'SVM': {'params': {'random_state': 42}}, 'XGBoost': {'params': {'random_state': 42, 'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'objective': 'binary:logistic', 'eval_metric': 'logloss'}}}, 'is_visualize': True, 'is_save_model': True}
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:80 - Available feature selectors: ['correlation', 'icc', 'lasso', 'mrmr', 'stepwise', 'rfecv', 'anova', 'chi2', 'variance', 'statistical_test', 'stepwise_r', 'univariate_logistic', 'vif']
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:88 - Modeling initialization completed
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:101 - Reading data from multiple files: 1 files
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:132 - Reading file: ./ml_data/breast_cancer_dataset.csv, Dataset name: None
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:133 - Subject ID column: subjID, Label column: label
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:138 - File loaded with shape: (569, 14)
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:158 - Using label column: label
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:164 - Using subject ID column: subjID
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:210 - Created initial merged dataframe with shape: (569, 12)
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:226 - Adding unified label column: label
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:231 - Final merged dataframe shape: (569, 13) with 12 features
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:249 - Converting data to numeric types
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:251 - Data converted to numeric types
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:255 - Missing values: label                      0
compactness error          0
concavity error            0
concave points error       0
symmetry error             0
fractal dimension error    0
worst radius               0
worst texture              0
worst perimeter            0
worst area                 0
worst smoothness           0
worst compactness          0
worst fractal dimension    0
dtype: int64
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:258 - Starting data preprocessing
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:259 - Sample size before removing missing values: 569
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:261 - Sample size after removing missing values: 569
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:264 - Data preprocessing completed
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:274 - Splitting data using method: custom
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:312 - Reading custom train IDs from ./ml_data/train_ids.txt
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:389 - Reading subject IDs from file: ./ml_data/train_ids.txt
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:418 - Parsed 300 subject IDs from line-by-line format
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:314 - Read 300 train subject IDs
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:316 - Reading custom test IDs from ./ml_data/test_ids.txt
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:389 - Reading subject IDs from file: ./ml_data/test_ids.txt
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:418 - Parsed 269 subject IDs from line-by-line format
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:318 - Read 269 test subject IDs
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:354 - Custom split completed: train=300, test=269
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:371 - Extracted features and labels: 12 features
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:429 - Saving train/test split information
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:443 - Split information saved to: ./ml_data/ml/rad\split_info.json
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:375 - Split information saved
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:464 - Checking for feature selection methods to run before normalization
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:489 - Running 1 feature selection methods before normalization
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:493 - Starting with 12 features
2025-05-24 22:00:30 - modeling - INFO - machine_learning.py:501 - Executing variance feature selection before normalization with params: {'before_z_score': True, 'threshold': 0.2}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:522 - variance selected 4 features, removed 8 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:540 - Pre-normalization feature selection completed. Selected 4 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:562 - Starting data normalization using method: z_score
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:570 - Using StandardScaler (Z-score normalization)
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:611 - Fitting scaler on training data with shape: (300, 4)
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:613 - Transforming test data with shape: (269, 4)
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:622 - Data normalization completed using z_score method
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:641 - Starting feature selection
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:653 - Starting with 4 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:662 - Executing icc feature selection with params: {'icc_results': '../demo_data/results/icc_results.json', 'keys': ['breast_cancer_dataset_v2_vs_breast_cancer_dataset'], 'threshold': 0.8, 'before_z_score': False}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:691 - icc selected 4 features, removed 0 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:662 - Executing correlation feature selection with params: {'threshold': 0.75, 'method': 'spearman', 'visualize': False, 'before_z_score': False}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:691 - correlation selected 2 features, removed 2 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:710 - Feature selection completed. Final number of selected features: 2
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:724 - Feature selection results saved to: ./ml_data/ml/rad\feature_selection_results.json
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:735 - Starting model training
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:746 - Training 3 models: ['LogisticRegression', 'SVM', 'XGBoost']
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:750 - Training model: LogisticRegression with config: {'params': {'random_state': 42, 'max_iter': 1000, 'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:764 - Training model with 2 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:769 - Model LogisticRegression trained successfully
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:750 - Training model: SVM with config: {'params': {'random_state': 42}}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:764 - Training model with 2 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:769 - Model SVM trained successfully
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:750 - Training model: XGBoost with config: {'params': {'random_state': 42, 'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'objective': 'binary:logistic', 'eval_metric': 'logloss'}}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:764 - Training model with 2 features
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:769 - Model XGBoost trained successfully
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:782 - Model training completed. Trained 3 models successfully
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:793 - Starting model evaluation
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:805 - Evaluating model: LogisticRegression
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:809 - Evaluating LogisticRegression on training set
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:812 - Training set metrics: {'accuracy': 0.9433333333333334, 'sensitivity': 0.9675324675324676, 'specificity': 0.9178082191780822, 'ppv': 0.9254658385093167, 'npv': 0.9640287769784173, 'auc': 0.985144991994307, 'hosmer_lemeshow_chi2': 4.424148426130804, 'hosmer_lemeshow_p_value': 0.8169729803905217, 'spiegelhalter_z_statistic': 2.671710174541019e-06, 'spiegelhalter_z_p_value': 0.9999978682837007}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:815 - Evaluating LogisticRegression on test set
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:818 - Test set metrics: {'accuracy': 0.9405204460966543, 'sensitivity': 0.9261083743842364, 'specificity': 0.9848484848484849, 'ppv': 0.9947089947089947, 'npv': 0.8125, 'auc': 0.9946260635915809, 'hosmer_lemeshow_chi2': 40.40359243877473, 'hosmer_lemeshow_p_value': 2.694122894997264e-06, 'spiegelhalter_z_statistic': 6.138787992407882, 'spiegelhalter_z_p_value': 8.315346189391448e-10}
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:824 - Feature importance calculated for LogisticRegression
2025-05-24 22:00:31 - modeling - INFO - machine_learning.py:829 - Plotting SHAP values for LogisticRegression
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:831 - SHAP plot saved for LogisticRegression
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:805 - Evaluating model: SVM
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:809 - Evaluating SVM on training set
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:812 - Training set metrics: {'accuracy': 0.94, 'sensitivity': 0.961038961038961, 'specificity': 0.9178082191780822, 'ppv': 0.925, 'npv': 0.9571428571428572, 'auc': 0.9855008005692936, 'hosmer_lemeshow_chi2': 41.9046777192022, 'hosmer_lemeshow_p_value': 1.4111812984829442e-06, 'spiegelhalter_z_statistic': 1.0622514576451263, 'spiegelhalter_z_p_value': 0.2881215449748491}
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:815 - Evaluating SVM on test set
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:818 - Test set metrics: {'accuracy': 0.9368029739776952, 'sensitivity': 0.9211822660098522, 'specificity': 0.9848484848484849, 'ppv': 0.9946808510638298, 'npv': 0.8024691358024691, 'auc': 0.9943275115688909, 'hosmer_lemeshow_chi2': 73.21874156907622, 'hosmer_lemeshow_p_value': 1.1205480987541705e-12, 'spiegelhalter_z_statistic': 7.17744939629773, 'spiegelhalter_z_p_value': 7.103206911551752e-13}
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:824 - Feature importance calculated for SVM
2025-05-24 22:00:32 - modeling - INFO - machine_learning.py:829 - Plotting SHAP values for SVM
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:831 - SHAP plot saved for SVM
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:805 - Evaluating model: XGBoost
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:809 - Evaluating XGBoost on training set
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:812 - Training set metrics: {'accuracy': 0.97, 'sensitivity': 0.9805194805194806, 'specificity': 0.958904109589041, 'ppv': 0.9617834394904459, 'npv': 0.9790209790209791, 'auc': 0.9960861056751468, 'hosmer_lemeshow_chi2': 11.101267528636168, 'hosmer_lemeshow_p_value': 0.19602700523399008, 'spiegelhalter_z_statistic': 0.07745379631092825, 'spiegelhalter_z_p_value': 0.9382625460063911}
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:815 - Evaluating XGBoost on test set
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:818 - Test set metrics: {'accuracy': 0.9330855018587361, 'sensitivity': 0.9211822660098522, 'specificity': 0.9696969696969697, 'ppv': 0.9894179894179894, 'npv': 0.8, 'auc': 0.990670249290939, 'hosmer_lemeshow_chi2': 40.932302406372365, 'hosmer_lemeshow_p_value': 2.1462499787405775e-06, 'spiegelhalter_z_statistic': 6.018171887204659, 'spiegelhalter_z_p_value': 1.7639782967648898e-09}
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:824 - Feature importance calculated for XGBoost
2025-05-24 22:00:33 - modeling - INFO - machine_learning.py:829 - Plotting SHAP values for XGBoost
2025-05-24 22:00:34 - modeling - INFO - machine_learning.py:831 - SHAP plot saved for XGBoost
2025-05-24 22:00:34 - modeling - INFO - machine_learning.py:843 - Performance table generated
2025-05-24 22:00:34 - modeling - INFO - machine_learning.py:851 - Performance table saved
2025-05-24 22:00:34 - modeling - INFO - machine_learning.py:859 - Generating visualization plots
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:861 - Visualization plots saved
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:868 - Saving detailed prediction results
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:892 - Saving detailed prediction results
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:920 - Saved complete prediction results to: ./ml_data/ml/rad\all_prediction_results.csv
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:870 - Prediction results saved
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:878 - Saving trained models and preprocessing information
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:926 - Saving trained models and preprocessing information
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:951 - Saved complete model package to: ./ml_data/ml/rad\model_package.pkl
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:1048 - Saved model usage instructions to: ./ml_data/ml/rad\model_usage_instructions.txt
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:880 - Models and preprocessing information saved
2025-05-24 22:00:37 - modeling - INFO - machine_learning.py:885 - Model evaluation completed
