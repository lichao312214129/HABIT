
import base64
exec(base64.b64decode(b'IiIiDQpJQ0MgY29uZmlndXJhdGlvbiB1dGlsaXRpZXMgZm9yIGxvYWRpbmcgYW5kIHZhbGlkYXRpbmcgSUNDIGFuYWx5c2lzIGNvbmZpZw0KIiIiDQoNCmltcG9ydCBvcw0KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEFueSwgTGlzdCwgVW5pb24sIE9wdGlvbmFsDQppbXBvcnQgeWFtbA0KZnJvbSBoYWJpdC51dGlscy5jb25maWdfdXRpbHMgaW1wb3J0IGxvYWRfY29uZmlnLCB2YWxpZGF0ZV9jb25maWcNCg0KZGVmIGxvYWRfaWNjX2NvbmZpZyhjb25maWdfcGF0aDogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToNCiAgICAiIiINCiAgICBMb2FkIElDQyBhbmFseXNpcyBjb25maWd1cmF0aW9uIGZyb20gWUFNTCBmaWxlDQogICAgDQogICAgQXJnczoNCiAgICAgICAgY29uZmlnX3BhdGggKHN0cik6IFBhdGggdG8gSUNDIGNvbmZpZ3VyYXRpb24gZmlsZSAoWUFNTCkNCiAgICANCiAgICBSZXR1cm5zOg0KICAgICAgICBEaWN0W3N0ciwgQW55XTogQ29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5DQogICAgIiIiDQogICAgY29uZmlnID0gbG9hZF9jb25maWcoY29uZmlnX3BhdGgpDQogICAgdmFsaWRhdGVfaWNjX2NvbmZpZyhjb25maWcpDQogICAgcmV0dXJuIGNvbmZpZw0KDQpkZWYgdmFsaWRhdGVfaWNjX2NvbmZpZyhjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBib29sOg0KICAgICIiIg0KICAgIFZhbGlkYXRlIElDQyBjb25maWd1cmF0aW9uIHN0cnVjdHVyZSBhbmQgcmVxdWlyZWQgcGFyYW1ldGVycw0KICAgIA0KICAgIEFyZ3M6DQogICAgICAgIGNvbmZpZyAoRGljdFtzdHIsIEFueV0pOiBJQ0MgY29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5DQogICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgYm9vbDogV2hldGhlciBjb25maWd1cmF0aW9uIGlzIHZhbGlkDQogICAgICAgIA0KICAgIFJhaXNlczoNCiAgICAgICAgVmFsdWVFcnJvcjogSWYgY29uZmlndXJhdGlvbiBpcyBpbnZhbGlkDQogICAgIiIiDQogICAgIyBEZWZpbmUgcmVxdWlyZWQgdG9wLWxldmVsIGtleXMNCiAgICByZXF1aXJlZF9rZXlzID0gWyJpbnB1dCIsICJvdXRwdXQiXQ0KICAgIHZhbGlkYXRlX2NvbmZpZyhjb25maWcsIHJlcXVpcmVkX2tleXMpDQogICAgDQogICAgIyBWYWxpZGF0ZSBpbnB1dCBjb25maWd1cmF0aW9uDQogICAgaWYgInR5cGUiIG5vdCBpbiBjb25maWdbImlucHV0Il06DQogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIklucHV0IGNvbmZpZ3VyYXRpb24gbXVzdCBjb250YWluICd0eXBlJyBmaWVsZCAoJ2ZpbGVzJyBvciAnZGlyZWN0b3JpZXMnKSIpDQogICAgDQogICAgaWYgY29uZmlnWyJpbnB1dCJdWyJ0eXBlIl0gbm90IGluIFsiZmlsZXMiLCAiZGlyZWN0b3JpZXMiXToNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiSW5wdXQgdHlwZSBtdXN0IGJlIGVpdGhlciAnZmlsZXMnIG9yICdkaXJlY3RvcmllcyciKQ0KICAgIA0KICAgIGlmIGNvbmZpZ1siaW5wdXQiXVsidHlwZSJdID09ICJmaWxlcyIgYW5kICJmaWxlX2dyb3VwcyIgbm90IGluIGNvbmZpZ1siaW5wdXQiXToNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiSW5wdXQgY29uZmlndXJhdGlvbiB3aXRoIHR5cGUgJ2ZpbGVzJyBtdXN0IGNvbnRhaW4gJ2ZpbGVfZ3JvdXBzJyBmaWVsZCIpDQogICAgDQogICAgaWYgY29uZmlnWyJpbnB1dCJdWyJ0eXBlIl0gPT0gImRpcmVjdG9yaWVzIiBhbmQgImRpcl9saXN0IiBub3QgaW4gY29uZmlnWyJpbnB1dCJdOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJJbnB1dCBjb25maWd1cmF0aW9uIHdpdGggdHlwZSAnZGlyZWN0b3JpZXMnIG11c3QgY29udGFpbiAnZGlyX2xpc3QnIGZpZWxkIikNCiAgICANCiAgICAjIFZhbGlkYXRlIG91dHB1dCBjb25maWd1cmF0aW9uDQogICAgaWYgInBhdGgiIG5vdCBpbiBjb25maWdbIm91dHB1dCJdOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJPdXRwdXQgY29uZmlndXJhdGlvbiBtdXN0IGNvbnRhaW4gJ3BhdGgnIGZpZWxkIikNCiAgICANCiAgICByZXR1cm4gVHJ1ZQ0KDQpkZWYgcGFyc2VfaWNjX2NvbmZpZ19maWxlcyhjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBMaXN0W0xpc3Rbc3RyXV06DQogICAgIiIiDQogICAgUGFyc2UgZmlsZSBncm91cHMgZnJvbSBJQ0MgY29uZmlndXJhdGlvbg0KICAgIA0KICAgIEFyZ3M6DQogICAgICAgIGNvbmZpZyAoRGljdFtzdHIsIEFueV0pOiBJQ0MgY29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5DQogICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgTGlzdFtMaXN0W3N0cl1dOiBMaXN0IG9mIGZpbGUgZ3JvdXBzDQogICAgIiIiDQogICAgaWYgY29uZmlnWyJpbnB1dCJdWyJ0eXBlIl0gIT0gImZpbGVzIjoNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiQ2Fubm90IHBhcnNlIGZpbGUgZ3JvdXBzIGZyb20gbm9uLWZpbGUgaW5wdXQgdHlwZSIpDQogICAgDQogICAgZmlsZV9ncm91cHMgPSBbXQ0KICAgIGZvciBncm91cCBpbiBjb25maWdbImlucHV0Il1bImZpbGVfZ3JvdXBzIl06DQogICAgICAgIGlmIGlzaW5zdGFuY2UoZ3JvdXAsIGxpc3QpOg0KICAgICAgICAgICAgZmlsZV9ncm91cHMuYXBwZW5kKGdyb3VwKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgIyBJZiBhIHNpbmdsZSBzdHJpbmcgaXMgcHJvdmlkZWQsIHRyZWF0IGl0IGFzIGEgb25lLWVsZW1lbnQgZ3JvdXANCiAgICAgICAgICAgIGZpbGVfZ3JvdXBzLmFwcGVuZChbZ3JvdXBdKQ0KICAgIA0KICAgIHJldHVybiBmaWxlX2dyb3Vwcw0KDQpkZWYgcGFyc2VfaWNjX2NvbmZpZ19kaXJlY3Rvcmllcyhjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBMaXN0W3N0cl06DQogICAgIiIiDQogICAgUGFyc2UgZGlyZWN0b3J5IGxpc3QgZnJvbSBJQ0MgY29uZmlndXJhdGlvbg0KICAgIA0KICAgIEFyZ3M6DQogICAgICAgIGNvbmZpZyAoRGljdFtzdHIsIEFueV0pOiBJQ0MgY29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5DQogICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgTGlzdFtzdHJdOiBMaXN0IG9mIGRpcmVjdG9yaWVzDQogICAgIiIiDQogICAgaWYgY29uZmlnWyJpbnB1dCJdWyJ0eXBlIl0gIT0gImRpcmVjdG9yaWVzIjoNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiQ2Fubm90IHBhcnNlIGRpcmVjdG9yeSBsaXN0IGZyb20gbm9uLWRpcmVjdG9yeSBpbnB1dCB0eXBlIikNCiAgICANCiAgICByZXR1cm4gY29uZmlnWyJpbnB1dCJdWyJkaXJfbGlzdCJdDQoNCmRlZiBnZXRfaWNjX2NvbmZpZ19vdXRwdXRfcGF0aChjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBzdHI6DQogICAgIiIiDQogICAgR2V0IG91dHB1dCBwYXRoIGZyb20gSUNDIGNvbmZpZ3VyYXRpb24NCiAgICANCiAgICBBcmdzOg0KICAgICAgICBjb25maWcgKERpY3Rbc3RyLCBBbnldKTogSUNDIGNvbmZpZ3VyYXRpb24gZGljdGlvbmFyeQ0KICAgIA0KICAgIFJldHVybnM6DQogICAgICAgIHN0cjogT3V0cHV0IGZpbGUgcGF0aA0KICAgICIiIg0KICAgIHJldHVybiBjb25maWdbIm91dHB1dCJdWyJwYXRoIl0NCg0KZGVmIGdldF9pY2NfY29uZmlnX3Byb2Nlc3Nlcyhjb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBPcHRpb25hbFtpbnRdOg0KICAgICIiIg0KICAgIEdldCBudW1iZXIgb2YgcHJvY2Vzc2VzIGZyb20gSUNDIGNvbmZpZ3VyYXRpb24NCiAgICANCiAgICBBcmdzOg0KICAgICAgICBjb25maWcgKERpY3Rbc3RyLCBBbnldKTogSUNDIGNvbmZpZ3VyYXRpb24gZGljdGlvbmFyeQ0KICAgIA0KICAgIFJldHVybnM6DQogICAgICAgIE9wdGlvbmFsW2ludF06IE51bWJlciBvZiBwcm9jZXNzZXMgb3IgTm9uZSBmb3IgZGVmYXVsdA0KICAgICIiIg0KICAgIHJldHVybiBjb25maWcuZ2V0KCJwcm9jZXNzZXMiLCBOb25lKQ0KDQpkZWYgY3JlYXRlX2RlZmF1bHRfaWNjX2NvbmZpZygpIC0+IERpY3Rbc3RyLCBBbnldOg0KICAgICIiIg0KICAgIENyZWF0ZSBkZWZhdWx0IElDQyBjb25maWd1cmF0aW9uDQogICAgDQogICAgUmV0dXJuczoNCiAgICAgICAgRGljdFtzdHIsIEFueV06IERlZmF1bHQgY29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5DQogICAgIiIiDQogICAgcmV0dXJuIHsNCiAgICAgICAgImlucHV0Ijogew0KICAgICAgICAgICAgInR5cGUiOiAiZmlsZXMiLA0KICAgICAgICAgICAgImZpbGVfZ3JvdXBzIjogWw0KICAgICAgICAgICAgICAgIFsicGF0aC90by9maWxlMS5jc3YiLCAicGF0aC90by9maWxlMi5jc3YiLCAicGF0aC90by9maWxlMy5jc3YiXSwNCiAgICAgICAgICAgICAgICBbInBhdGgvdG8vZmlsZTQuY3N2IiwgInBhdGgvdG8vZmlsZTUuY3N2IiwgInBhdGgvdG8vZmlsZTYuY3N2Il0NCiAgICAgICAgICAgIF0NCiAgICAgICAgfSwNCiAgICAgICAgIm91dHB1dCI6IHsNCiAgICAgICAgICAgICJwYXRoIjogImljY19yZXN1bHRzLmpzb24iDQogICAgICAgIH0sDQogICAgICAgICJwcm9jZXNzZXMiOiBOb25lLA0KICAgICAgICAiZGVidWciOiBGYWxzZQ0KICAgIH0NCg0KZGVmIHNhdmVfZGVmYXVsdF9pY2NfY29uZmlnKG91dHB1dF9wYXRoOiBzdHIpIC0+IE5vbmU6DQogICAgIiIiDQogICAgU2F2ZSBkZWZhdWx0IElDQyBjb25maWd1cmF0aW9uIHRvIGZpbGUNCiAgICANCiAgICBBcmdzOg0KICAgICAgICBvdXRwdXRfcGF0aCAoc3RyKTogT3V0cHV0IGZpbGUgcGF0aA0KICAgICIiIg0KICAgIGRlZmF1bHRfY29uZmlnID0gY3JlYXRlX2RlZmF1bHRfaWNjX2NvbmZpZygpDQogICAgDQogICAgIyBDcmVhdGUgZGlyZWN0b3J5IGlmIGl0IGRvZXNuJ3QgZXhpc3QNCiAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKG91dHB1dF9wYXRoKSksIGV4aXN0X29rPVRydWUpDQogICAgDQogICAgd2l0aCBvcGVuKG91dHB1dF9wYXRoLCAndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6DQogICAgICAgIHlhbWwuZHVtcChkZWZhdWx0X2NvbmZpZywgZiwgZGVmYXVsdF9mbG93X3N0eWxlPUZhbHNlLCBzb3J0X2tleXM9RmFsc2UpIA==').decode())
