
import base64
exec(base64.b64decode(b'IiIiClZpc3VhbGl6YXRpb24gdXRpbGl0eSBmdW5jdGlvbnMKIiIiCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgbWF0cGxvdGxpYi5weXBsb3QgYXMgcGx0CmltcG9ydCBzZWFib3JuIGFzIHNucwpmcm9tIG1hdHBsb3RsaWIuY29sb3JzIGltcG9ydCBMaXN0ZWRDb2xvcm1hcAoKZGVmIHBsb3RfaGFiaXRhdHMoaGFiaXRhdF9sYWJlbHM6IG5wLm5kYXJyYXksIGZlYXR1cmVfZGF0YTogbnAubmRhcnJheSwgY29vcmRzOiBucC5uZGFycmF5ID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgIGZpZ3NpemU6IHR1cGxlID0gKDEwLCAxMCksIGNtYXA6IHN0ciA9ICd2aXJpZGlzJywgdGl0bGU6IHN0ciA9ICdIYWJpdGF0IERpc3RyaWJ1dGlvbicsIAogICAgICAgICAgICAgICAgICBhbHBoYTogZmxvYXQgPSAwLjgsIHM6IGludCA9IDUwLCBsZWdlbmQ6IGJvb2wgPSBUcnVlLCAqKmt3YXJncykgLT4gdHVwbGU6CiAgICAiIiIKICAgIFBsb3QgaGFiaXRhdCBkaXN0cmlidXRpb24KICAgIAogICAgQXJnczoKICAgICAgICBoYWJpdGF0X2xhYmVsczogSGFiaXRhdCBsYWJlbHMsIHNoYXBlIChuX3NhbXBsZXMsKQogICAgICAgIGZlYXR1cmVfZGF0YTogRmVhdHVyZSBkYXRhLCBzaGFwZSAobl9zYW1wbGVzLCBuX2ZlYXR1cmVzKQogICAgICAgIGNvb3JkczogQ29vcmRpbmF0ZSBpbmZvcm1hdGlvbiwgc2hhcGUgKG5fc2FtcGxlcywgMiksIGlmIE5vbmUsIFBDQSBkaW1lbnNpb25hbGl0eSByZWR1Y3Rpb24gaXMgdXNlZAogICAgICAgIGZpZ3NpemU6IEZpZ3VyZSBzaXplCiAgICAgICAgY21hcDogQ29sb3IgbWFwCiAgICAgICAgdGl0bGU6IEZpZ3VyZSB0aXRsZQogICAgICAgIGFscGhhOiBQb2ludCB0cmFuc3BhcmVuY3kKICAgICAgICBzOiBQb2ludCBzaXplCiAgICAgICAgbGVnZW5kOiBXaGV0aGVyIHRvIGRpc3BsYXkgbGVnZW5kCiAgICAgICAgKiprd2FyZ3M6IE90aGVyIHBhcmFtZXRlcnMgcGFzc2VkIHRvIHBsdC5zY2F0dGVyCiAgICAKICAgIFJldHVybnM6CiAgICAgICAgdHVwbGU6IChmaWcsIGF4KSBGaWd1cmUgYW5kIGF4aXMgb2JqZWN0cwogICAgIiIiCiAgICBpZiBjb29yZHMgaXMgTm9uZToKICAgICAgICAjIFVzZSBQQ0EgZGltZW5zaW9uYWxpdHkgcmVkdWN0aW9uIHRvIDJEIGZvciB2aXN1YWxpemF0aW9uCiAgICAgICAgZnJvbSBza2xlYXJuLmRlY29tcG9zaXRpb24gaW1wb3J0IFBDQQogICAgICAgIHBjYSA9IFBDQShuX2NvbXBvbmVudHM9MikKICAgICAgICBjb29yZHMgPSBwY2EuZml0X3RyYW5zZm9ybShmZWF0dXJlX2RhdGEpCiAgICAKICAgICMgQ3JlYXRlIGZpZ3VyZQogICAgZmlnLCBheCA9IHBsdC5zdWJwbG90cyhmaWdzaXplPWZpZ3NpemUpCiAgICAKICAgICMgR2V0IHVuaXF1ZSBsYWJlbHMKICAgIHVuaXF1ZV9sYWJlbHMgPSBucC51bmlxdWUoaGFiaXRhdF9sYWJlbHMpCiAgICAKICAgICMgSWYgY21hcCBpcyBhIHN0cmluZyB0eXBlLCBjb252ZXJ0IHRvIExpc3RlZENvbG9ybWFwCiAgICBpZiBpc2luc3RhbmNlKGNtYXAsIHN0cik6CiAgICAgICAgIyBVc2UgYnVpbHQtaW4gY29sb3IgbWFwCiAgICAgICAgY21hcCA9IHBsdC5nZXRfY21hcChjbWFwLCBsZW4odW5pcXVlX2xhYmVscykpCiAgICBlbGlmIGlzaW5zdGFuY2UoY21hcCwgbGlzdCk6CiAgICAgICAgIyBVc2UgY3VzdG9tIGNvbG9yIGxpc3QKICAgICAgICBjbWFwID0gTGlzdGVkQ29sb3JtYXAoY21hcCkKICAgIAogICAgIyBQbG90IHBvaW50cyBmb3IgZWFjaCBoYWJpdGF0CiAgICBmb3IgaSwgbGFiZWwgaW4gZW51bWVyYXRlKHVuaXF1ZV9sYWJlbHMpOgogICAgICAgIG1hc2sgPSBoYWJpdGF0X2xhYmVscyA9PSBsYWJlbAogICAgICAgIGF4LnNjYXR0ZXIoY29vcmRzW21hc2ssIDBdLCBjb29yZHNbbWFzaywgMV0sIAogICAgICAgICAgICAgICAgICBjb2xvcj1jbWFwKGkpIGlmIGhhc2F0dHIoY21hcCwgJ19fY2FsbF9fJykgZWxzZSBjbWFwLCAKICAgICAgICAgICAgICAgICAgbGFiZWw9ZidIYWJpdGF0IHtsYWJlbH0nLAogICAgICAgICAgICAgICAgICBhbHBoYT1hbHBoYSwgcz1zLCAqKmt3YXJncykKICAgIAogICAgaWYgbGVnZW5kOgogICAgICAgIGF4LmxlZ2VuZChsb2M9J2Jlc3QnKQogICAgCiAgICBheC5zZXRfdGl0bGUodGl0bGUpCiAgICBheC5ncmlkKFRydWUsIGxpbmVzdHlsZT0nLS0nLCBhbHBoYT0wLjcpCiAgICAKICAgIHJldHVybiBmaWcsIGF4CgpkZWYgcGxvdF9mZWF0dXJlX3Njb3JlcyhmZWF0dXJlX25hbWVzOiBsaXN0LCBmZWF0dXJlX3Njb3JlczogbGlzdCwgZmlnc2l6ZTogdHVwbGUgPSAoMTIsIDgpLCB0b3BfbjogaW50ID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzdHIgPSAnRmVhdHVyZSBJbXBvcnRhbmNlIFNjb3JlcycsIGNvbG9yOiBzdHIgPSAnc2t5Ymx1ZScsIAogICAgICAgICAgICAgICAgICAgICAgICBzb3J0OiBib29sID0gVHJ1ZSwgKiprd2FyZ3MpIC0+IHR1cGxlOgogICAgIiIiCiAgICBQbG90IGZlYXR1cmUgaW1wb3J0YW5jZSBzY29yZXMKICAgIAogICAgQXJnczoKICAgICAgICBmZWF0dXJlX25hbWVzOiBMaXN0IG9mIGZlYXR1cmUgbmFtZXMKICAgICAgICBmZWF0dXJlX3Njb3JlczogTGlzdCBvZiBmZWF0dXJlIHNjb3JlcwogICAgICAgIGZpZ3NpemU6IEZpZ3VyZSBzaXplCiAgICAgICAgdG9wX246IE9ubHkgZGlzcGxheSB0b3AgTiBmZWF0dXJlcwogICAgICAgIHRpdGxlOiBGaWd1cmUgdGl0bGUKICAgICAgICBjb2xvcjogQmFyIGNoYXJ0IGNvbG9yCiAgICAgICAgc29ydDogV2hldGhlciB0byBzb3J0IGJ5IHNjb3JlCiAgICAgICAgKiprd2FyZ3M6IE90aGVyIHBhcmFtZXRlcnMgcGFzc2VkIHRvIHBsdC5iYXIKICAgIAogICAgUmV0dXJuczoKICAgICAgICB0dXBsZTogKGZpZywgYXgpIEZpZ3VyZSBhbmQgYXhpcyBvYmplY3RzCiAgICAiIiIKICAgICMgQ3JlYXRlIGRhdGFmcmFtZQogICAgaW1wb3J0IHBhbmRhcyBhcyBwZAogICAgZGYgPSBwZC5EYXRhRnJhbWUoeydmZWF0dXJlJzogZmVhdHVyZV9uYW1lcywgJ3Njb3JlJzogZmVhdHVyZV9zY29yZXN9KQogICAgCiAgICAjIFNvcnQKICAgIGlmIHNvcnQ6CiAgICAgICAgZGYgPSBkZi5zb3J0X3ZhbHVlcygnc2NvcmUnLCBhc2NlbmRpbmc9RmFsc2UpCiAgICAKICAgICMgR2V0IHRvcF9uIGZlYXR1cmVzCiAgICBpZiB0b3BfbiBpcyBub3QgTm9uZToKICAgICAgICBkZiA9IGRmLmhlYWQodG9wX24pCiAgICAKICAgICMgQ3JlYXRlIGZpZ3VyZQogICAgZmlnLCBheCA9IHBsdC5zdWJwbG90cyhmaWdzaXplPWZpZ3NpemUpCiAgICAKICAgICMgRHJhdyBiYXIgY2hhcnQKICAgIGF4LmJhcihkZlsnZmVhdHVyZSddLCBkZlsnc2NvcmUnXSwgY29sb3I9Y29sb3IsICoqa3dhcmdzKQogICAgCiAgICAjIFNldCB0aXRsZSBhbmQgbGFiZWxzCiAgICBheC5zZXRfdGl0bGUodGl0bGUpCiAgICBheC5zZXRfeGxhYmVsKCdGZWF0dXJlIE5hbWUnKQogICAgYXguc2V0X3lsYWJlbCgnSW1wb3J0YW5jZSBTY29yZScpCiAgICAKICAgICMgUm90YXRlIHgtYXhpcyBsYWJlbHMgdG8gcHJldmVudCBvdmVybGFwCiAgICBwbHQueHRpY2tzKHJvdGF0aW9uPTQ1LCBoYT0ncmlnaHQnKQogICAgCiAgICAjIEFkZCBncmlkCiAgICBheC5ncmlkKFRydWUsIGxpbmVzdHlsZT0nLS0nLCBhbHBoYT0wLjcsIGF4aXM9J3knKQogICAgCiAgICAjIEFkanVzdCBsYXlvdXQKICAgIHBsdC50aWdodF9sYXlvdXQoKQogICAgCiAgICByZXR1cm4gZmlnLCBheCAKCmRlZiBmb3JtYXRfc2hhcF9kYXRhKFg6IG5wLm5kYXJyYXksIGRlY2ltYWxfcGxhY2VzOiBpbnQgPSAyKSAtPiBucC5uZGFycmF5OgogICAgIiIiCiAgICBGb3JtYXQgU0hBUCBmZWF0dXJlIGRhdGEgdG8gcmVkdWNlIGRlY2ltYWwgcGxhY2VzCiAgICAKICAgIEFyZ3M6CiAgICAgICAgWCAobnAubmRhcnJheSk6IEZlYXR1cmUgZGF0YSwgZWl0aGVyIGEgc2luZ2xlIGluc3RhbmNlIG9yIG11bHRpcGxlIGluc3RhbmNlcwogICAgICAgIGRlY2ltYWxfcGxhY2VzIChpbnQpOiBOdW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMgdG8gcm91bmQgdG8KICAgIAogICAgUmV0dXJuczoKICAgICAgICBucC5uZGFycmF5OiBGb3JtYXR0ZWQgZGF0YSB3aXRoIHJlZHVjZWQgZGVjaW1hbCBwbGFjZXMKICAgICIiIgogICAgIyBIYW5kbGUgZGlmZmVyZW50IGlucHV0IHR5cGVzCiAgICBpZiBpc2luc3RhbmNlKFgsIG5wLm5kYXJyYXkpOgogICAgICAgICMgUm91bmQgbnVtcHkgYXJyYXkKICAgICAgICByZXR1cm4gbnAucm91bmQoWCwgZGVjaW1hbF9wbGFjZXMpCiAgICBlbGlmIGhhc2F0dHIoWCwgJ3ZhbHVlcycpIGFuZCBpc2luc3RhbmNlKFgudmFsdWVzLCBucC5uZGFycmF5KToKICAgICAgICAjIEhhbmRsZSBwYW5kYXMgRGF0YUZyYW1lCiAgICAgICAgWC52YWx1ZXMgPSBucC5yb3VuZChYLnZhbHVlcywgZGVjaW1hbF9wbGFjZXMpCiAgICAgICAgcmV0dXJuIFgKICAgIGVsaWYgaXNpbnN0YW5jZShYLCBsaXN0KToKICAgICAgICAjIEhhbmRsZSBsaXN0IG9mIGFycmF5cwogICAgICAgIHJldHVybiBbbnAucm91bmQoYXJyLCBkZWNpbWFsX3BsYWNlcykgaWYgaXNpbnN0YW5jZShhcnIsIG5wLm5kYXJyYXkpIGVsc2UgYXJyIGZvciBhcnIgaW4gWF0KICAgIAogICAgIyBSZXR1cm4gb3JpZ2luYWwgZGF0YSBpZiB3ZSBkb24ndCBrbm93IGhvdyB0byBwcm9jZXNzIGl0CiAgICByZXR1cm4gWAoKZGVmIHByb2Nlc3Nfc2hhcF9leHBsYW5hdGlvbihzaGFwX3ZhbHVlcywgZGVjaW1hbF9wbGFjZXM6IGludCA9IDIpOgogICAgIiIiCiAgICBQcm9jZXNzIFNIQVAgRXhwbGFuYXRpb24gb2JqZWN0IHRvIHJlZHVjZSBkZWNpbWFsIHBsYWNlcyBpbiB0aGUgZGlzcGxheQogICAgCiAgICBBcmdzOgogICAgICAgIHNoYXBfdmFsdWVzOiBTSEFQIHZhbHVlcyBvYmplY3QsIGVpdGhlciBmcm9tIG9sZCBvciBuZXcgQVBJCiAgICAgICAgZGVjaW1hbF9wbGFjZXMgKGludCk6IE51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyB0byByb3VuZCB0bwogICAgCiAgICBSZXR1cm5zOgogICAgICAgIFByb2Nlc3NlZCBTSEFQIHZhbHVlcyB3aXRoIHJlZHVjZWQgZGVjaW1hbCBwbGFjZXMKICAgICIiIgogICAgIyBIYW5kbGUgZGlmZmVyZW50IFNIQVAgb2JqZWN0IHR5cGVzCiAgICB0cnk6CiAgICAgICAgIyBDaGVjayBpZiBpdCdzIGEgbmV3ZXIgRXhwbGFuYXRpb24gb2JqZWN0CiAgICAgICAgaWYgaGFzYXR0cihzaGFwX3ZhbHVlcywgJ2RhdGEnKSBhbmQgaXNpbnN0YW5jZShzaGFwX3ZhbHVlcy5kYXRhLCBucC5uZGFycmF5KToKICAgICAgICAgICAgIyBVc2UgYSBtYW51YWwgZGVlcCBjb3B5IGFwcHJvYWNoIGluc3RlYWQgb2YgY29weSBtZXRob2QKICAgICAgICAgICAgIyBTaW5jZSBFeHBsYW5hdGlvbiBvYmplY3QgaW4gbmV3ZXIgdmVyc2lvbnMgbWlnaHQgbm90IGhhdmUgY29weSBtZXRob2QKICAgICAgICAgICAgaW1wb3J0IGNvcHkKICAgICAgICAgICAgcHJvY2Vzc2VkX3ZhbHVlcyA9IGNvcHkuZGVlcGNvcHkoc2hhcF92YWx1ZXMpCiAgICAgICAgICAgIHByb2Nlc3NlZF92YWx1ZXMuZGF0YSA9IG5wLnJvdW5kKHByb2Nlc3NlZF92YWx1ZXMuZGF0YSwgZGVjaW1hbF9wbGFjZXMpCiAgICAgICAgICAgIGlmIGhhc2F0dHIocHJvY2Vzc2VkX3ZhbHVlcywgJ3ZhbHVlcycpIGFuZCBpc2luc3RhbmNlKHByb2Nlc3NlZF92YWx1ZXMudmFsdWVzLCBucC5uZGFycmF5KToKICAgICAgICAgICAgICAgIHByb2Nlc3NlZF92YWx1ZXMudmFsdWVzID0gbnAucm91bmQocHJvY2Vzc2VkX3ZhbHVlcy52YWx1ZXMsIGRlY2ltYWxfcGxhY2VzKQogICAgICAgICAgICByZXR1cm4gcHJvY2Vzc2VkX3ZhbHVlcwogICAgICAgIGVsaWYgaXNpbnN0YW5jZShzaGFwX3ZhbHVlcywgbGlzdCk6CiAgICAgICAgICAgICMgSGFuZGxlIGxpc3Qgb2YgYXJyYXlzIChjb21tb24gaW4gb2xkZXIgU0hBUCB2ZXJzaW9ucykKICAgICAgICAgICAgcmV0dXJuIFtucC5yb3VuZChhcnIsIGRlY2ltYWxfcGxhY2VzKSBpZiBpc2luc3RhbmNlKGFyciwgbnAubmRhcnJheSkgZWxzZSBhcnIgCiAgICAgICAgICAgICAgICAgICBmb3IgYXJyIGluIHNoYXBfdmFsdWVzXQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShzaGFwX3ZhbHVlcywgbnAubmRhcnJheSk6CiAgICAgICAgICAgICMgSGFuZGxlIG51bXB5IGFycmF5IGRpcmVjdGx5CiAgICAgICAgICAgIHJldHVybiBucC5yb3VuZChzaGFwX3ZhbHVlcywgZGVjaW1hbF9wbGFjZXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBJZiB3ZSBjYW4ndCBwcm9jZXNzIGl0LCByZXR1cm4gdGhlIG9yaWdpbmFsCiAgICAgICAgICAgIHJldHVybiBzaGFwX3ZhbHVlcwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiV2FybmluZzogRmFpbGVkIHRvIHByb2Nlc3MgU0hBUCB2YWx1ZXM6IHtzdHIoZSl9IikKICAgICAgICByZXR1cm4gc2hhcF92YWx1ZXMg').decode())
