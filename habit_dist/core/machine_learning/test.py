
import base64
exec(base64.b64decode(b'ZnJvbSBhdXRvZ2x1b24udGFidWxhciBpbXBvcnQgVGFidWxhclByZWRpY3Rvcg0KaW1wb3J0IHBhbmRhcyBhcyBwZA0KaW1wb3J0IHNrbGVhcm4NCmltcG9ydCBzaGFwDQojIG1ha2UgZGF0YQ0KZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBtYWtlX2NsYXNzaWZpY2F0aW9uDQojIOWvvOWFpXNrbGVhcm7nmoTpgLvovpHlm57lvZLmqKHlnosNCmZyb20gc2tsZWFybi5saW5lYXJfbW9kZWwgaW1wb3J0IExvZ2lzdGljUmVncmVzc2lvbg0KIyDlr7zlhaXkuqTlj4npqozor4Hor4TliIYNCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IGNyb3NzX3ZhbF9zY29yZQ0KIyDlr7zlhaVza2xlYXJu55qE6K+E5LywDQpmcm9tIHNrbGVhcm4ubWV0cmljcyBpbXBvcnQgYWNjdXJhY3lfc2NvcmUsIHByZWNpc2lvbl9zY29yZSwgcmVjYWxsX3Njb3JlLCBmMV9zY29yZQ0KIyBwaXAgaW5zdGFsbCBzaGFwDQpmcm9tIElQeXRob24uZGlzcGxheSBpbXBvcnQgZGlzcGxheQ0KaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdA0KaW1wb3J0IG1hdHBsb3RsaWINCiMgbWF0cGxvdGxpYi51c2UoJ0FnZycpICAjIOazqOmHiuaOiemdnuS6pOS6kuW8j+iuvue9ru+8jOWFgeiuuOWbvuW9ouaYvuekug0KDQppbXBvcnQgd2FybmluZ3MNCndhcm5pbmdzLmZpbHRlcndhcm5pbmdzKCdpZ25vcmUnKQ0KDQoNClgseSA9IG1ha2VfY2xhc3NpZmljYXRpb24obl9zYW1wbGVzPTEwMDAsIG5fZmVhdHVyZXM9MjAwLCBuX2NsYXNzZXM9Miwgbl9pbmZvcm1hdGl2ZT0yMCwgbl9yZWR1bmRhbnQ9MTAwLCByYW5kb21fc3RhdGU9MSkNClhfdHJhaW4sIFhfdmFsaWQsIHlfdHJhaW4sIHlfdmFsaWQgPSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbi50cmFpbl90ZXN0X3NwbGl0KFgsIHksIHRlc3Rfc2l6ZT0wLjIsIHJhbmRvbV9zdGF0ZT03KQ0KDQojIHRvIGRhdGFmcmFtZQ0KWF90cmFpbiA9IHBkLkRhdGFGcmFtZShYX3RyYWluLCBjb2x1bW5zPVsnZmVhdHVyZScrc3RyKGkpIGZvciBpIGluIHJhbmdlKFhfdHJhaW4uc2hhcGVbMV0pXSkNClhfdmFsaWQgPSBwZC5EYXRhRnJhbWUoWF92YWxpZCwgY29sdW1ucz1bJ2ZlYXR1cmUnK3N0cihpKSBmb3IgaSBpbiByYW5nZShYX3ZhbGlkLnNoYXBlWzFdKV0pDQoNCg0KaW1wb3J0IHdhcm5pbmdzDQp3YXJuaW5ncy5maWx0ZXJ3YXJuaW5ncygnaWdub3JlJykNCg0KDQpsYWJlbCA9ICdsYWJlbCcNCmZlYXR1cmVfbmFtZXMgPSBYX3RyYWluLmNvbHVtbnMNCnRyYWluX2RhdGEgPSBYX3RyYWluLmNvcHkoKQ0KdHJhaW5fZGF0YVtsYWJlbF0gPSB5X3RyYWluDQp2YWxfZGF0YSA9IFhfdmFsaWQuY29weSgpDQoNCg0KcHJlZGljdG9yID0gVGFidWxhclByZWRpY3RvcihsYWJlbD1sYWJlbCwgcHJvYmxlbV90eXBlPSdiaW5hcnknKVwNCiAgICAuZml0KHRyYWluX2RhdGEsIHRpbWVfbGltaXQ9NSkNCg0KcHJpbnQoInBvc2l0aXZlIGNsYXNzOiIsIHByZWRpY3Rvci5wb3NpdGl2ZV9jbGFzcykNCg0KIyDlnKh2YWzkuK3nmoTpooTmtYsNCnlfcHJlZCA9IHByZWRpY3Rvci5wcmVkaWN0KHZhbF9kYXRhKQ0KDQojIOivhOS8sA0KdmFsX2RhdGFbbGFiZWxdID0geV92YWxpZA0KcHJlZGljdG9yLmV2YWx1YXRlKHZhbF9kYXRhKQ0KDQojIOaehOW7umxy5qih5Z6LDQpsciA9IExvZ2lzdGljUmVncmVzc2lvbigpDQpsci5maXQoWF90cmFpbiwgeV90cmFpbikNCg0KIyDor4TkvLANCnlfcHJlZCA9IGxyLnByZWRpY3QoWF92YWxpZCkNCg0KIyDorqHnrpflh4bnoa7njocNCmFjY3VyYWN5ID0gYWNjdXJhY3lfc2NvcmUoeV92YWxpZCwgeV9wcmVkKQ0KDQojIOiuoeeul+eyvuehrueOhw0KcHJlY2lzaW9uID0gcHJlY2lzaW9uX3Njb3JlKHlfdmFsaWQsIHlfcHJlZCkNCg0KIyDorqHnrpflj6zlm57njocNCnJlY2FsbCA9IHJlY2FsbF9zY29yZSh5X3ZhbGlkLCB5X3ByZWQpDQoNCiMg6K6h566XRjHliIbmlbANCmYxID0gZjFfc2NvcmUoeV92YWxpZCwgeV9wcmVkKQ0KDQojIGF1Yw0KZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IHJvY19hdWNfc2NvcmUNCmF1YyA9IHJvY19hdWNfc2NvcmUoeV92YWxpZCwgeV9wcmVkKQ0KDQoNCg0KDQoNCmNsYXNzIEF1dG9nbHVvbldyYXBwZXI6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByZWRpY3RvciwgZmVhdHVyZV9uYW1lcyk6DQogICAgICAgIHNlbGYuYWdfbW9kZWwgPSBwcmVkaWN0b3INCiAgICAgICAgc2VsZi5mZWF0dXJlX25hbWVzID0gZmVhdHVyZV9uYW1lcw0KICAgIA0KICAgIGRlZiBwcmVkaWN0X2JpbmFyeV9wcm9iKHNlbGYsIFgpOg0KICAgICAgICBpZiBpc2luc3RhbmNlKFgsIHBkLlNlcmllcyk6DQogICAgICAgICAgICBYID0gWC52YWx1ZXMucmVzaGFwZSgxLC0xKQ0KICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShYLCBwZC5EYXRhRnJhbWUpOg0KICAgICAgICAgICAgWCA9IHBkLkRhdGFGcmFtZShYLCBjb2x1bW5zPXNlbGYuZmVhdHVyZV9uYW1lcykNCiAgICAgICAgcmV0dXJuIHNlbGYuYWdfbW9kZWwucHJlZGljdF9wcm9iYShYLCBhc19tdWx0aWNsYXNzPUZhbHNlKQ0KDQoNCg0KbWVkID0gWF90cmFpbi5tZWRpYW4oKSAgIyBYX3RyYWluLm1vZGUoKSB3b3VsZCBiZSBhIG1vcmUgYXBwcm9wcmlhdGUgYmFzZWxpbmUgZm9yIG9yZGluYWxseS1lbmNvZGVkIGNhdGVnb3JpY2FsIGZlYXR1cmVzDQpwcmludCgiQmFzZWxpbmUgZmVhdHVyZS12YWx1ZXM6IFxuIiwgbWVkKQ0KDQoNCg0KYWdfd3JhcHBlciA9IEF1dG9nbHVvbldyYXBwZXIocHJlZGljdG9yLCBmZWF0dXJlX25hbWVzKQ0KZXhwbGFpbmVyID0gc2hhcC5LZXJuZWxFeHBsYWluZXIoYWdfd3JhcHBlci5wcmVkaWN0X2JpbmFyeV9wcm9iLCBtZWQpDQoNCk5TSEFQX1NBTVBMRVMgPSAxMDAgICMgaG93IG1hbnkgc2FtcGxlcyB0byB1c2UgdG8gYXBwcm94aW1hdGUgZWFjaCBTaGFwZWx5IHZhbHVlLCBsYXJnZXIgdmFsdWVzIHdpbGwgYmUgc2xvd2VyDQpOX1ZBTCA9IDMwICAjIGhvdyBtYW55IGRhdGFwb2ludHMgZnJvbSB2YWxpZGF0aW9uIGRhdGEgc2hvdWxkIHdlIGludGVycHJldCBwcmVkaWN0aW9ucyBmb3IsIGxhcmdlciB2YWx1ZXMgd2lsbCBiZSBzbG93ZXINCg0KUk9XX0lOREVYID0gMCAgIyBpbmRleCBvZiBhbiBleGFtcGxlIGRhdGFwb2ludA0Kc2luZ2xlX2RhdGFwb2ludCA9IFhfdHJhaW4uaWxvY1tbUk9XX0lOREVYXV0NCnNpbmdsZV9wcmVkaWN0aW9uID0gYWdfd3JhcHBlci5wcmVkaWN0X2JpbmFyeV9wcm9iKHNpbmdsZV9kYXRhcG9pbnQpDQoNCnNoYXBfdmFsdWVzX3NpbmdsZSA9IGV4cGxhaW5lci5zaGFwX3ZhbHVlcyhzaW5nbGVfZGF0YXBvaW50LCBuc2FtcGxlcz1OU0hBUF9TQU1QTEVTKQ0Kc2hhcC5mb3JjZV9wbG90KGV4cGxhaW5lci5leHBlY3RlZF92YWx1ZSwgc2hhcF92YWx1ZXNfc2luZ2xlLCBYX3RyYWluLmlsb2NbUk9XX0lOREVYLDpdKQ0KDQpzaGFwX3ZhbHVlcyA9IGV4cGxhaW5lci5zaGFwX3ZhbHVlcyhYX3ZhbGlkLmlsb2NbMDpOX1ZBTCw6XSwgbnNhbXBsZXM9TlNIQVBfU0FNUExFUykNCnNoYXAuZm9yY2VfcGxvdChleHBsYWluZXIuZXhwZWN0ZWRfdmFsdWUsIHNoYXBfdmFsdWVzLCBYX3ZhbGlkLmlsb2NbMDpOX1ZBTCw6XSkNCg0KIyDnu5jliLZTSEFQ5rGH5oC75Zu+DQpwbHQuZmlndXJlKGZpZ3NpemU9KDEwLCA4KSkgICMg6K6+572u5Zu+5b2i5aSn5bCPDQpzaGFwLnN1bW1hcnlfcGxvdChzaGFwX3ZhbHVlcywgWF92YWxpZC5pbG9jWzA6Tl9WQUwsOl0pDQpwbHQudGlnaHRfbGF5b3V0KCkgICMg6LCD5pW05biD5bGADQpwbHQuc2F2ZWZpZygic2hhcF9zdW1tYXJ5X3Bsb3QucG5nIikgICMg5L+d5a2Y5Zu+5b2i5Yiw5paH5Lu2DQpwbHQuc2hvdygpICAjIOaYvuekuuWbvuW9og0KcGx0LmNsb3NlKCkgICMg5YWz6Zet5Zu+5b2iDQoNCiMg5L+u5aSNZGVwZW5kZW5jZV9wbG9055qE54m55b6B5ZCN56ewDQpwbHQuZmlndXJlKGZpZ3NpemU9KDEwLCA2KSkgICMg6K6+572u5Zu+5b2i5aSn5bCPDQpmaXJzdF9mZWF0dXJlID0gWF92YWxpZC5jb2x1bW5zWzBdICANCnNoYXAuZGVwZW5kZW5jZV9wbG90KGZpcnN0X2ZlYXR1cmUsIHNoYXBfdmFsdWVzLCBYX3ZhbGlkLmlsb2NbMDpOX1ZBTCw6XSkNCnBsdC50aWdodF9sYXlvdXQoKQ0KcGx0LnNhdmVmaWcoInNoYXBfZGVwZW5kZW5jZV9wbG90LnBuZyIpICAjIOS/neWtmOWbvuW9ouWIsOaWh+S7tg0KcGx0LnNob3coKSAgIyDmmL7npLrlm77lvaINCnBsdC5jbG9zZSgpICAjIOWFs+mXreWbvuW9og0KDQoNCnZhbF9kYXRhW2xhYmVsXSA9IHlfdmFsaWQgICMgYWRkIGxhYmVscyB0byB2YWxpZGF0aW9uIERhdGFGcmFtZQ0KcHJlZGljdG9yLmZlYXR1cmVfaW1wb3J0YW5jZSh2YWxfZGF0YSkNCg0K').decode())
