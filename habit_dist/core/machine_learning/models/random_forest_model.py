
import base64
exec(base64.b64decode(b'IiIiDQpSYW5kb20gRm9yZXN0IE1vZGVsDQoNCkltcGxlbWVudGF0aW9uIG9mIFJhbmRvbSBGb3Jlc3QgY2xhc3NpZmllcg0KIiIiDQpmcm9tIHNrbGVhcm4uZW5zZW1ibGUgaW1wb3J0IFJhbmRvbUZvcmVzdENsYXNzaWZpZXINCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBVbmlvbiwgTGlzdA0KaW1wb3J0IG51bXB5IGFzIG5wDQppbXBvcnQgcGFuZGFzIGFzIHBkDQpmcm9tIC5iYXNlIGltcG9ydCBCYXNlTW9kZWwNCmZyb20gLmZhY3RvcnkgaW1wb3J0IE1vZGVsRmFjdG9yeQ0KDQpATW9kZWxGYWN0b3J5LnJlZ2lzdGVyKCdSYW5kb21Gb3Jlc3QnKQ0KY2xhc3MgUmFuZG9tRm9yZXN0TW9kZWwoQmFzZU1vZGVsKToNCiAgICAiIiINCiAgICBSYW5kb20gRm9yZXN0IE1vZGVsIGltcGxlbWVudGF0aW9uDQogICAgDQogICAgVGhpcyBjbGFzcyBpbXBsZW1lbnRzIGEgUmFuZG9tIEZvcmVzdCBjbGFzc2lmaWVyIHdpdGggY29uZmlndXJhYmxlIHBhcmFtZXRlcnMNCiAgICAiIiINCiAgICANCiAgICBAcHJvcGVydHkNCiAgICBkZWYgbW9kZWxfdHlwZShzZWxmKSAtPiBzdHI6DQogICAgICAgICIiIg0KICAgICAgICBHZXQgdGhlIHR5cGUgb2YgdGhlIG1vZGVsDQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgc3RyOiBNb2RlbCB0eXBlICgndHJlZScgZm9yIFJhbmRvbSBGb3Jlc3QpDQogICAgICAgICIiIg0KICAgICAgICByZXR1cm4gJ3RyZWUnDQogICAgDQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmZpZzogRGljdFtzdHIsIEFueV0gPSBOb25lKToNCiAgICAgICAgIiIiDQogICAgICAgIEluaXRpYWxpemUgUmFuZG9tIEZvcmVzdCBtb2RlbA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGNvbmZpZzogQ29uZmlndXJhdGlvbiBkaWN0aW9uYXJ5IGNvbnRhaW5pbmcgbW9kZWwgcGFyYW1ldGVycw0KICAgICAgICAiIiINCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhjb25maWcpDQogICAgICAgIHNlbGYubW9kZWwgPSBzZWxmLl9jcmVhdGVfbW9kZWwoKQ0KICAgIA0KICAgIGRlZiBfY3JlYXRlX21vZGVsKHNlbGYpIC0+IFJhbmRvbUZvcmVzdENsYXNzaWZpZXI6DQogICAgICAgICIiIg0KICAgICAgICBDcmVhdGUgYW5kIGNvbmZpZ3VyZSB0aGUgUmFuZG9tIEZvcmVzdCBtb2RlbA0KICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIFJhbmRvbUZvcmVzdENsYXNzaWZpZXI6IENvbmZpZ3VyZWQgbW9kZWwgaW5zdGFuY2UNCiAgICAgICAgIiIiDQogICAgICAgICMgR2V0IHBhcmFtZXRlcnMgZnJvbSBjb25maWcgb3IgdXNlIGRlZmF1bHRzDQogICAgICAgIHBhcmFtcyA9IHsNCiAgICAgICAgICAgICduX2VzdGltYXRvcnMnOiBzZWxmLmNvbmZpZy5nZXQoJ25fZXN0aW1hdG9ycycsIDEwMCksDQogICAgICAgICAgICAnbWF4X2RlcHRoJzogc2VsZi5jb25maWcuZ2V0KCdtYXhfZGVwdGgnLCBOb25lKSwNCiAgICAgICAgICAgICdtaW5fc2FtcGxlc19zcGxpdCc6IHNlbGYuY29uZmlnLmdldCgnbWluX3NhbXBsZXNfc3BsaXQnLCAyKSwNCiAgICAgICAgICAgICdtaW5fc2FtcGxlc19sZWFmJzogc2VsZi5jb25maWcuZ2V0KCdtaW5fc2FtcGxlc19sZWFmJywgMSksDQogICAgICAgICAgICAnbWF4X2ZlYXR1cmVzJzogc2VsZi5jb25maWcuZ2V0KCdtYXhfZmVhdHVyZXMnLCAnc3FydCcpLA0KICAgICAgICAgICAgJ2Jvb3RzdHJhcCc6IHNlbGYuY29uZmlnLmdldCgnYm9vdHN0cmFwJywgVHJ1ZSksDQogICAgICAgICAgICAnY2xhc3Nfd2VpZ2h0Jzogc2VsZi5jb25maWcuZ2V0KCdjbGFzc193ZWlnaHQnLCBOb25lKSwNCiAgICAgICAgICAgICdyYW5kb21fc3RhdGUnOiBzZWxmLmNvbmZpZy5nZXQoJ3JhbmRvbV9zdGF0ZScsIDQyKQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAjIEFkZCBhbnkgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIGZyb20gY29uZmlnDQogICAgICAgIHBhcmFtcy51cGRhdGUoe2s6IHYgZm9yIGssIHYgaW4gc2VsZi5jb25maWcuaXRlbXMoKSANCiAgICAgICAgICAgICAgICAgICAgICBpZiBrIG5vdCBpbiBwYXJhbXMgYW5kIG5vdCBrLnN0YXJ0c3dpdGgoJ18nKX0pDQogICAgICAgIA0KICAgICAgICByZXR1cm4gUmFuZG9tRm9yZXN0Q2xhc3NpZmllcigqKnBhcmFtcykNCiAgICANCiAgICBkZWYgZml0KHNlbGYsIFg6IFVuaW9uW3BkLkRhdGFGcmFtZSwgbnAubmRhcnJheV0sIA0KICAgICAgICAgICAgeTogVW5pb25bcGQuU2VyaWVzLCBucC5uZGFycmF5XSkgLT4gTm9uZToNCiAgICAgICAgIiIiDQogICAgICAgIFRyYWluIHRoZSBtb2RlbA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIFg6IFRyYWluaW5nIGZlYXR1cmVzDQogICAgICAgICAgICB5OiBUcmFpbmluZyBsYWJlbHMNCiAgICAgICAgIiIiDQogICAgICAgIGlmIGlzaW5zdGFuY2UoWCwgcGQuRGF0YUZyYW1lKToNCiAgICAgICAgICAgIHNlbGYuZmVhdHVyZV9uYW1lcyA9IFguY29sdW1ucy50b2xpc3QoKQ0KICAgICAgICAgICAgWCA9IFgudmFsdWVzDQogICAgICAgIHNlbGYubW9kZWwuZml0KFgsIHkpDQogICAgDQogICAgZGVmIHByZWRpY3Qoc2VsZiwgWDogVW5pb25bcGQuRGF0YUZyYW1lLCBucC5uZGFycmF5XSkgLT4gbnAubmRhcnJheToNCiAgICAgICAgIiIiDQogICAgICAgIE1ha2UgcHJlZGljdGlvbnMNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBGZWF0dXJlcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBucC5uZGFycmF5OiBQcmVkaWN0ZWQgY2xhc3MgbGFiZWxzDQogICAgICAgICIiIg0KICAgICAgICBpZiBpc2luc3RhbmNlKFgsIHBkLkRhdGFGcmFtZSk6DQogICAgICAgICAgICBYID0gWC52YWx1ZXMNCiAgICAgICAgcmV0dXJuIHNlbGYubW9kZWwucHJlZGljdChYKQ0KICAgIA0KICAgIGRlZiBwcmVkaWN0X3Byb2JhKHNlbGYsIFg6IFVuaW9uW3BkLkRhdGFGcmFtZSwgbnAubmRhcnJheV0pIC0+IG5wLm5kYXJyYXk6DQogICAgICAgICIiIg0KICAgICAgICBHZXQgcHJlZGljdGlvbiBwcm9iYWJpbGl0aWVzDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgWDogRmVhdHVyZXMNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgbnAubmRhcnJheTogUHJlZGljdGVkIHByb2JhYmlsaXRpZXMgZm9yIHBvc2l0aXZlIGNsYXNzDQogICAgICAgICIiIg0KICAgICAgICBpZiBpc2luc3RhbmNlKFgsIHBkLkRhdGFGcmFtZSk6DQogICAgICAgICAgICBYID0gWC52YWx1ZXMNCiAgICAgICAgcmV0dXJuIHNlbGYubW9kZWwucHJlZGljdF9wcm9iYShYKVs6LCAxXQ0KICAgIA0KICAgIGRlZiBnZXRfZmVhdHVyZV9pbXBvcnRhbmNlKHNlbGYpIC0+IERpY3Rbc3RyLCBmbG9hdF06DQogICAgICAgICIiIg0KICAgICAgICBHZXQgZmVhdHVyZSBpbXBvcnRhbmNlIHNjb3Jlcw0KICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIERpY3Rbc3RyLCBmbG9hdF06IEZlYXR1cmUgaW1wb3J0YW5jZSBzY29yZXMNCiAgICAgICAgIiIiDQogICAgICAgIGlmIHNlbGYuZmVhdHVyZV9uYW1lcyBpcyBOb25lOg0KICAgICAgICAgICAgcmV0dXJuIHt9DQogICAgICAgIHJldHVybiBkaWN0KHppcChzZWxmLmZlYXR1cmVfbmFtZXMsIHNlbGYubW9kZWwuZmVhdHVyZV9pbXBvcnRhbmNlc18pKSA=').decode())
