
import base64
exec(base64.b64decode(b'IiIiDQpMb2dpc3RpYyBSZWdyZXNzaW9uIE1vZGVsDQoNCldyYXBwZXIgZm9yIHNrbGVhcm4ncyBMb2dpc3RpY1JlZ3Jlc3Npb24gbW9kZWwNCiIiIg0KZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTG9naXN0aWNSZWdyZXNzaW9uDQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgQW55LCBPcHRpb25hbCwgVW5pb24NCmltcG9ydCBudW1weSBhcyBucA0KaW1wb3J0IHBhbmRhcyBhcyBwZA0KZnJvbSAuYmFzZSBpbXBvcnQgQmFzZU1vZGVsDQpmcm9tIC5mYWN0b3J5IGltcG9ydCBNb2RlbEZhY3RvcnkNCg0KQE1vZGVsRmFjdG9yeS5yZWdpc3RlcignTG9naXN0aWNSZWdyZXNzaW9uJykNCmNsYXNzIExvZ2lzdGljUmVncmVzc2lvbk1vZGVsKEJhc2VNb2RlbCk6DQogICAgIiIiV3JhcHBlciBmb3Igc2tsZWFybidzIExvZ2lzdGljUmVncmVzc2lvbiBtb2RlbCIiIg0KICAgIA0KICAgIEBwcm9wZXJ0eQ0KICAgIGRlZiBtb2RlbF90eXBlKHNlbGYpIC0+IHN0cjoNCiAgICAgICAgIiIiDQogICAgICAgIEdldCB0aGUgdHlwZSBvZiB0aGUgbW9kZWwNCiAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBzdHI6IE1vZGVsIHR5cGUgKCdsaW5lYXInIGZvciBMb2dpc3RpYyBSZWdyZXNzaW9uKQ0KICAgICAgICAiIiINCiAgICAgICAgcmV0dXJuICdsaW5lYXInDQogICAgDQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmZpZzogRGljdFtzdHIsIEFueV0pOg0KICAgICAgICAiIiINCiAgICAgICAgSW5pdGlhbGl6ZSB0aGUgbW9kZWwNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBjb25maWc6IENvbmZpZ3VyYXRpb24gZGljdGlvbmFyeSB3aXRoIG1vZGVsIHBhcmFtZXRlcnMNCiAgICAgICAgIiIiDQogICAgICAgIHN1cGVyKCkuX19pbml0X18oY29uZmlnKQ0KICAgICAgICANCiAgICAgICAgIyBFeHRyYWN0IHBhcmFtZXRlcnMgZnJvbSBjb25maWcNCiAgICAgICAgcGFyYW1zID0gY29uZmlnLmdldCgncGFyYW1zJywge30pDQogICAgICAgIA0KICAgICAgICAjIENyZWF0ZSBtb2RlbCB3aXRoIHBhcmFtZXRlcnMNCiAgICAgICAgc2VsZi5tb2RlbCA9IExvZ2lzdGljUmVncmVzc2lvbigNCiAgICAgICAgICAgIEM9cGFyYW1zLmdldCgnQycsIDEuMCksDQogICAgICAgICAgICBwZW5hbHR5PXBhcmFtcy5nZXQoJ3BlbmFsdHknLCAnbDInKSwNCiAgICAgICAgICAgIHNvbHZlcj1wYXJhbXMuZ2V0KCdzb2x2ZXInLCAnbGlibGluZWFyJyksDQogICAgICAgICAgICBtYXhfaXRlcj1wYXJhbXMuZ2V0KCdtYXhfaXRlcicsIDEwMDApLA0KICAgICAgICAgICAgcmFuZG9tX3N0YXRlPXBhcmFtcy5nZXQoJ3JhbmRvbV9zdGF0ZScsIDQyKSwNCiAgICAgICAgICAgIGNsYXNzX3dlaWdodD1wYXJhbXMuZ2V0KCdjbGFzc193ZWlnaHQnLCBOb25lKSwNCiAgICAgICAgICAgICoqe2s6IHYgZm9yIGssIHYgaW4gcGFyYW1zLml0ZW1zKCkgaWYgayBub3QgaW4gWydDJywgJ3BlbmFsdHknLCAnc29sdmVyJywgJ21heF9pdGVyJywgJ3JhbmRvbV9zdGF0ZScsICdjbGFzc193ZWlnaHQnXX0NCiAgICAgICAgKQ0KICAgICAgICANCiAgICBkZWYgZml0KHNlbGYsIFg6IFVuaW9uW3BkLkRhdGFGcmFtZSwgbnAubmRhcnJheV0sIA0KICAgICAgICAgICAgIHk6IFVuaW9uW3BkLlNlcmllcywgbnAubmRhcnJheV0pIC0+IE5vbmU6DQogICAgICAgICIiIg0KICAgICAgICBUcmFpbiB0aGUgbW9kZWwNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBUcmFpbmluZyBmZWF0dXJlcw0KICAgICAgICAgICAgeTogVHJhaW5pbmcgbGFiZWxzDQogICAgICAgICIiIg0KICAgICAgICAjIFNhdmUgZmVhdHVyZSBuYW1lcyBpZiBYIGlzIGEgRGF0YUZyYW1lDQogICAgICAgIGlmIGlzaW5zdGFuY2UoWCwgcGQuRGF0YUZyYW1lKToNCiAgICAgICAgICAgIHNlbGYuZmVhdHVyZV9uYW1lcyA9IGxpc3QoWC5jb2x1bW5zKQ0KICAgICAgICANCiAgICAgICAgIyBUcmFpbiB0aGUgbW9kZWwNCiAgICAgICAgc2VsZi5tb2RlbC5maXQoWCwgeSkNCiAgICAgICAgDQogICAgZGVmIHByZWRpY3Qoc2VsZiwgWDogVW5pb25bcGQuRGF0YUZyYW1lLCBucC5uZGFycmF5XSkgLT4gbnAubmRhcnJheToNCiAgICAgICAgIiIiDQogICAgICAgIE1ha2UgcHJlZGljdGlvbnMNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBGZWF0dXJlcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBucC5uZGFycmF5OiBQcmVkaWN0ZWQgY2xhc3MgbGFiZWxzDQogICAgICAgICIiIg0KICAgICAgICBpZiBzZWxmLm1vZGVsIGlzIE5vbmU6DQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJNb2RlbCBub3QgdHJhaW5lZC4gQ2FsbCB0cmFpbigpIGZpcnN0LiIpDQogICAgICAgIHJldHVybiBzZWxmLm1vZGVsLnByZWRpY3QoWCkNCiAgICAgICAgDQogICAgZGVmIHByZWRpY3RfcHJvYmEoc2VsZiwgWDogVW5pb25bcGQuRGF0YUZyYW1lLCBucC5uZGFycmF5XSkgLT4gbnAubmRhcnJheToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBwcmVkaWN0aW9uIHByb2JhYmlsaXRpZXMNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBGZWF0dXJlcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBucC5uZGFycmF5OiBQcmVkaWN0ZWQgcHJvYmFiaWxpdGllcyBmb3IgcG9zaXRpdmUgY2xhc3MNCiAgICAgICAgIiIiDQogICAgICAgIGlmIHNlbGYubW9kZWwgaXMgTm9uZToNCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIk1vZGVsIG5vdCB0cmFpbmVkLiBDYWxsIHRyYWluKCkgZmlyc3QuIikNCiAgICAgICAgcmV0dXJuIHNlbGYubW9kZWwucHJlZGljdF9wcm9iYShYKQ0KICAgICAgICANCiAgICBkZWYgZ2V0X2ZlYXR1cmVfaW1wb3J0YW5jZShzZWxmKSAtPiBEaWN0W3N0ciwgZmxvYXRdOg0KICAgICAgICAiIiINCiAgICAgICAgR2V0IGZlYXR1cmUgaW1wb3J0YW5jZSBzY29yZXMNCiAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBEaWN0W3N0ciwgZmxvYXRdOiBGZWF0dXJlIGltcG9ydGFuY2Ugc2NvcmVzIChjb2VmZmljaWVudCB2YWx1ZXMpDQogICAgICAgICIiIg0KICAgICAgICBpZiBzZWxmLm1vZGVsIGlzIE5vbmU6DQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJNb2RlbCBub3QgdHJhaW5lZC4gQ2FsbCB0cmFpbigpIGZpcnN0LiIpDQogICAgICAgICAgICANCiAgICAgICAgaWYgbm90IGhhc2F0dHIoc2VsZi5tb2RlbCwgJ2NvZWZfJyk6DQogICAgICAgICAgICByZXR1cm4ge30NCiAgICAgICAgICAgIA0KICAgICAgICAjIEdldCBmZWF0dXJlIG5hbWVzDQogICAgICAgIGZlYXR1cmVfbmFtZXMgPSBzZWxmLmZlYXR1cmVfbmFtZXMgb3IgW2YiZmVhdHVyZV97aX0iIGZvciBpIGluIHJhbmdlKHNlbGYubW9kZWwuY29lZl8uc2hhcGVbMV0pXQ0KICAgICAgICANCiAgICAgICAgIyBHZXQgY29lZmZpY2llbnRzDQogICAgICAgIGNvZWYgPSBzZWxmLm1vZGVsLmNvZWZfWzBdDQogICAgICAgIA0KICAgICAgICAjIFJldHVybiBhcyBkaWN0aW9uYXJ5DQogICAgICAgIHJldHVybiBkaWN0KHppcChmZWF0dXJlX25hbWVzLCBjb2VmKSkg').decode())
