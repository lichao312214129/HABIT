
import base64
exec(base64.b64decode(b'IiIiDQpBdXRvR2x1b24gVGFidWxhclByZWRpY3RvciBNb2RlbA0KDQpXcmFwcGVyIGZvciBBdXRvR2x1b24ncyBUYWJ1bGFyUHJlZGljdG9yIG1vZGVsDQoiIiINCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBVbmlvbiwgTGlzdA0KaW1wb3J0IG51bXB5IGFzIG5wDQppbXBvcnQgcGFuZGFzIGFzIHBkDQppbXBvcnQgb3MNCmZyb20gLmJhc2UgaW1wb3J0IEJhc2VNb2RlbA0KZnJvbSAuZmFjdG9yeSBpbXBvcnQgTW9kZWxGYWN0b3J5DQoNCnRyeToNCiAgICBmcm9tIGF1dG9nbHVvbi50YWJ1bGFyIGltcG9ydCBUYWJ1bGFyUHJlZGljdG9yDQpleGNlcHQgSW1wb3J0RXJyb3I6DQogICAgcmFpc2UgSW1wb3J0RXJyb3IoIkF1dG9HbHVvbiBpcyBub3QgaW5zdGFsbGVkLiBJbnN0YWxsIGl0IHVzaW5nOiBwaXAgaW5zdGFsbCBhdXRvZ2x1b24iKQ0KDQpATW9kZWxGYWN0b3J5LnJlZ2lzdGVyKCdBdXRvR2x1b25UYWJ1bGFyJykNCmNsYXNzIEF1dG9HbHVvblRhYnVsYXJNb2RlbChCYXNlTW9kZWwpOg0KICAgICIiIldyYXBwZXIgZm9yIEF1dG9HbHVvbidzIFRhYnVsYXJQcmVkaWN0b3IgbW9kZWwiIiINCiAgICANCiAgICBAcHJvcGVydHkNCiAgICBkZWYgbW9kZWxfdHlwZShzZWxmKSAtPiBzdHI6DQogICAgICAgICIiIg0KICAgICAgICBHZXQgdGhlIHR5cGUgb2YgdGhlIG1vZGVsDQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgc3RyOiBNb2RlbCB0eXBlICgnZW5zZW1ibGUnIGZvciBBdXRvR2x1b24pDQogICAgICAgICIiIg0KICAgICAgICByZXR1cm4gJ2Vuc2VtYmxlJw0KICAgIA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25maWc6IERpY3Rbc3RyLCBBbnldKToNCiAgICAgICAgIiIiDQogICAgICAgIEluaXRpYWxpemUgdGhlIG1vZGVsDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgY29uZmlnOiBDb25maWd1cmF0aW9uIGRpY3Rpb25hcnkgd2l0aCBtb2RlbCBwYXJhbWV0ZXJzDQogICAgICAgICIiIg0KICAgICAgICBzdXBlcigpLl9faW5pdF9fKGNvbmZpZykNCiAgICAgICAgDQogICAgICAgICMgRXh0cmFjdCBwYXJhbWV0ZXJzIGZyb20gY29uZmlnDQogICAgICAgIHBhcmFtcyA9IGNvbmZpZy5nZXQoJ3BhcmFtcycsIHt9KQ0KICAgICAgICANCiAgICAgICAgIyBFeHRyYWN0IHByZWRpY3RvciBzcGVjaWZpYyBwYXJhbWV0ZXJzDQogICAgICAgIHNlbGYubGFiZWwgPSBwYXJhbXMuZ2V0KCdsYWJlbCcsIE5vbmUpDQogICAgICAgIHNlbGYucHJvYmxlbV90eXBlID0gcGFyYW1zLmdldCgncHJvYmxlbV90eXBlJywgTm9uZSkgICMgJ2JpbmFyeScsICdtdWx0aWNsYXNzJywgJ3JlZ3Jlc3Npb24nDQogICAgICAgIHNlbGYuZXZhbF9tZXRyaWMgPSBwYXJhbXMuZ2V0KCdldmFsX21ldHJpYycsIE5vbmUpDQogICAgICAgIHNlbGYucGF0aCA9IHBhcmFtcy5nZXQoJ3BhdGgnLCAnLi9BdXRvZ2x1b25Nb2RlbHMnKQ0KICAgICAgICANCiAgICAgICAgIyBNb2RlbCB0cmFpbmluZyBwYXJhbWV0ZXJzDQogICAgICAgIHNlbGYudGltZV9saW1pdCA9IHBhcmFtcy5nZXQoJ3RpbWVfbGltaXQnLCA2MCkgICMgVGltZSBsaW1pdCBpbiBzZWNvbmRzDQogICAgICAgIHNlbGYucHJlc2V0cyA9IHBhcmFtcy5nZXQoJ3ByZXNldHMnLCAnbWVkaXVtX3F1YWxpdHknKSAgIyBxdWFsaXR5L3BlcmZvcm1hbmNlIHRyYWRlb2ZmDQogICAgICAgIHNlbGYuaHlwZXJwYXJhbWV0ZXJzID0gcGFyYW1zLmdldCgnaHlwZXJwYXJhbWV0ZXJzJywgTm9uZSkNCiAgICAgICAgc2VsZi5mZWF0dXJlX2ltcG9ydGFuY2UgPSBwYXJhbXMuZ2V0KCdmZWF0dXJlX2ltcG9ydGFuY2UnLCAnYXV0bycpDQogICAgICAgIA0KICAgICAgICAjIENyZWF0ZSBUYWJ1bGFyUHJlZGljdG9yIGluc3RhbmNlDQogICAgICAgIHNlbGYubW9kZWwgPSBOb25lICAjIFdpbGwgYmUgaW5pdGlhbGl6ZWQgZHVyaW5nIGZpdA0KICAgICAgICANCiAgICBkZWYgZml0KHNlbGYsIFg6IFVuaW9uW3BkLkRhdGFGcmFtZSwgbnAubmRhcnJheV0sIA0KICAgICAgICAgICAgeTogVW5pb25bcGQuU2VyaWVzLCBucC5uZGFycmF5XSkgLT4gTm9uZToNCiAgICAgICAgIiIiDQogICAgICAgIFRyYWluIHRoZSBtb2RlbA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIFg6IFRyYWluaW5nIGZlYXR1cmVzDQogICAgICAgICAgICB5OiBUcmFpbmluZyBsYWJlbHMNCiAgICAgICAgIiIiDQogICAgICAgICMgQ29udmVydCBudW1weSBhcnJheXMgdG8gcGFuZGFzIGlmIG5lZWRlZA0KICAgICAgICBpZiBpc2luc3RhbmNlKFgsIG5wLm5kYXJyYXkpOg0KICAgICAgICAgICAgWCA9IHBkLkRhdGFGcmFtZShYLCBjb2x1bW5zPVtmImZlYXR1cmVfe2l9IiBmb3IgaSBpbiByYW5nZShYLnNoYXBlWzFdKV0pDQogICAgICAgIA0KICAgICAgICBpZiBpc2luc3RhbmNlKHksIG5wLm5kYXJyYXkpOg0KICAgICAgICAgICAgeSA9IHBkLlNlcmllcyh5LCBuYW1lPXNlbGYubGFiZWwgb3IgJ3RhcmdldCcpDQogICAgICAgIA0KICAgICAgICAjIFNhdmUgZmVhdHVyZSBuYW1lcw0KICAgICAgICBzZWxmLmZlYXR1cmVfbmFtZXMgPSBsaXN0KFguY29sdW1ucykNCiAgICAgICAgDQogICAgICAgICMgQ29tYmluZSBmZWF0dXJlcyBhbmQgdGFyZ2V0IGludG8gYSBzaW5nbGUgZGF0YWZyYW1lDQogICAgICAgIHRyYWluX2RhdGEgPSBYLmNvcHkoKQ0KICAgICAgICBpZiBzZWxmLmxhYmVsIGlzIE5vbmU6DQogICAgICAgICAgICBzZWxmLmxhYmVsID0geS5uYW1lIGlmIGhhc2F0dHIoeSwgJ25hbWUnKSBhbmQgeS5uYW1lIGVsc2UgJ3RhcmdldCcNCiAgICAgICAgdHJhaW5fZGF0YVtzZWxmLmxhYmVsXSA9IHkNCiAgICAgICAgDQogICAgICAgICMgSW5pdGlhbGl6ZSBhbmQgdHJhaW4gVGFidWxhclByZWRpY3Rvcg0KICAgICAgICBzZWxmLm1vZGVsID0gVGFidWxhclByZWRpY3RvcigNCiAgICAgICAgICAgIGxhYmVsPXNlbGYubGFiZWwsDQogICAgICAgICAgICBwcm9ibGVtX3R5cGU9c2VsZi5wcm9ibGVtX3R5cGUsDQogICAgICAgICAgICBldmFsX21ldHJpYz1zZWxmLmV2YWxfbWV0cmljLA0KICAgICAgICAgICAgcGF0aD1zZWxmLnBhdGgNCiAgICAgICAgKQ0KICAgICAgICANCiAgICAgICAgIyBUcmFpbiB0aGUgbW9kZWwNCiAgICAgICAgc2VsZi5tb2RlbC5maXQoDQogICAgICAgICAgICB0cmFpbl9kYXRhPXRyYWluX2RhdGEsDQogICAgICAgICAgICB0aW1lX2xpbWl0PXNlbGYudGltZV9saW1pdCwNCiAgICAgICAgICAgIHByZXNldHM9c2VsZi5wcmVzZXRzLA0KICAgICAgICAgICAgaHlwZXJwYXJhbWV0ZXJzPXNlbGYuaHlwZXJwYXJhbWV0ZXJzDQogICAgICAgICkNCiAgICAgICAgDQogICAgZGVmIHByZWRpY3Qoc2VsZiwgWDogVW5pb25bcGQuRGF0YUZyYW1lLCBucC5uZGFycmF5XSkgLT4gbnAubmRhcnJheToNCiAgICAgICAgIiIiDQogICAgICAgIE1ha2UgcHJlZGljdGlvbnMNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBGZWF0dXJlcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBucC5uZGFycmF5OiBQcmVkaWN0ZWQgY2xhc3MgbGFiZWxzDQogICAgICAgICIiIg0KICAgICAgICBpZiBzZWxmLm1vZGVsIGlzIE5vbmU6DQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJNb2RlbCBub3QgdHJhaW5lZC4gQ2FsbCBmaXQoKSBmaXJzdC4iKQ0KICAgICAgICAgICAgDQogICAgICAgICMgQ29udmVydCBudW1weSBhcnJheSB0byBwYW5kYXMgaWYgbmVlZGVkDQogICAgICAgIGlmIGlzaW5zdGFuY2UoWCwgbnAubmRhcnJheSk6DQogICAgICAgICAgICBYID0gcGQuRGF0YUZyYW1lKFgsIGNvbHVtbnM9c2VsZi5mZWF0dXJlX25hbWVzIG9yIFtmImZlYXR1cmVfe2l9IiBmb3IgaSBpbiByYW5nZShYLnNoYXBlWzFdKV0pDQogICAgICAgICAgICANCiAgICAgICAgcmV0dXJuIHNlbGYubW9kZWwucHJlZGljdChYKS52YWx1ZXMNCiAgICAgICAgDQogICAgZGVmIHByZWRpY3RfcHJvYmEoc2VsZiwgWDogVW5pb25bcGQuRGF0YUZyYW1lLCBucC5uZGFycmF5XSkgLT4gbnAubmRhcnJheToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBwcmVkaWN0aW9uIHByb2JhYmlsaXRpZXMNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBYOiBGZWF0dXJlcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBucC5uZGFycmF5OiBQcmVkaWN0ZWQgcHJvYmFiaWxpdGllcw0KICAgICAgICAiIiINCiAgICAgICAgaWYgc2VsZi5tb2RlbCBpcyBOb25lOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTW9kZWwgbm90IHRyYWluZWQuIENhbGwgZml0KCkgZmlyc3QuIikNCiAgICAgICAgICAgIA0KICAgICAgICAjIENvbnZlcnQgbnVtcHkgYXJyYXkgdG8gcGFuZGFzIGlmIG5lZWRlZA0KICAgICAgICBpZiBpc2luc3RhbmNlKFgsIG5wLm5kYXJyYXkpOg0KICAgICAgICAgICAgWCA9IHBkLkRhdGFGcmFtZShYLCBjb2x1bW5zPXNlbGYuZmVhdHVyZV9uYW1lcyBvciBbZiJmZWF0dXJlX3tpfSIgZm9yIGkgaW4gcmFuZ2UoWC5zaGFwZVsxXSldKQ0KICAgICAgICAgICAgDQogICAgICAgIHRyeToNCiAgICAgICAgICAgICMgRm9yIGNsYXNzaWZpY2F0aW9uIHByb2JsZW1zDQogICAgICAgICAgICByZXR1cm4gc2VsZi5tb2RlbC5wcmVkaWN0X3Byb2JhKFgpLnZhbHVlcw0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICAjIEZvciByZWdyZXNzaW9uIHByb2JsZW1zIHdoZXJlIHByZWRpY3RfcHJvYmEgaXNuJ3QgYXZhaWxhYmxlDQogICAgICAgICAgICByZXR1cm4gc2VsZi5tb2RlbC5wcmVkaWN0KFgpLnZhbHVlcy5yZXNoYXBlKC0xLCAxKQ0KICAgICAgICANCiAgICBkZWYgZ2V0X2ZlYXR1cmVfaW1wb3J0YW5jZShzZWxmKSAtPiBEaWN0W3N0ciwgZmxvYXRdOg0KICAgICAgICAiIiINCiAgICAgICAgR2V0IGZlYXR1cmUgaW1wb3J0YW5jZSBzY29yZXMNCiAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBEaWN0W3N0ciwgZmxvYXRdOiBGZWF0dXJlIGltcG9ydGFuY2Ugc2NvcmVzDQogICAgICAgICIiIg0KICAgICAgICBpZiBzZWxmLm1vZGVsIGlzIE5vbmU6DQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJNb2RlbCBub3QgdHJhaW5lZC4gQ2FsbCBmaXQoKSBmaXJzdC4iKQ0KICAgICAgICAgICAgDQogICAgICAgIHRyeToNCiAgICAgICAgICAgICMgVHJ5IHRvIGdldCBmZWF0dXJlIGltcG9ydGFuY2UNCiAgICAgICAgICAgIGltcG9ydGFuY2VfZGYgPSBzZWxmLm1vZGVsLmZlYXR1cmVfaW1wb3J0YW5jZShzZWxmLmZlYXR1cmVfaW1wb3J0YW5jZSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBSZXR1cm4gYXMgZGljdGlvbmFyeQ0KICAgICAgICAgICAgcmV0dXJuIGRpY3QoemlwKGltcG9ydGFuY2VfZGYuaW5kZXgsIGltcG9ydGFuY2VfZGZbJ2ltcG9ydGFuY2UnXS52YWx1ZXMpKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBwcmludChmIkZhaWxlZCB0byBnZXQgZmVhdHVyZSBpbXBvcnRhbmNlOiB7ZX0iKQ0KICAgICAgICAgICAgcmV0dXJuIHt9DQogICAgDQogICAgZGVmIHNhdmUoc2VsZiwgZmlsZXBhdGg6IHN0cikgLT4gTm9uZToNCiAgICAgICAgIiIiDQogICAgICAgIFNhdmUgbW9kZWwgdG8gZmlsZSAob3ZlcnJpZGUgYmFzZSBzYXZlIG1ldGhvZCkNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBmaWxlcGF0aDogRGlyZWN0b3J5IHBhdGggdG8gc2F2ZSBtb2RlbA0KICAgICAgICAiIiINCiAgICAgICAgaWYgc2VsZi5tb2RlbCBpcyBOb25lOg0KICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTW9kZWwgbm90IHRyYWluZWQuIENhbGwgZml0KCkgZmlyc3QuIikNCiAgICAgICAgICAgIA0KICAgICAgICAjIEF1dG9HbHVvbiBoYXMgaXRzIG93biBzYXZpbmcgbWVjaGFuaXNtDQogICAgICAgIG9zLm1ha2VkaXJzKGZpbGVwYXRoLCBleGlzdF9vaz1UcnVlKQ0KICAgICAgICBzZWxmLm1vZGVsLnNhdmUoZmlsZXBhdGgpDQogICAgICAgIA0KICAgIEBjbGFzc21ldGhvZA0KICAgIGRlZiBsb2FkKGNscywgZmlsZXBhdGg6IHN0ciwgY29uZmlnOiBEaWN0W3N0ciwgQW55XSA9IE5vbmUpIC0+ICdBdXRvR2x1b25UYWJ1bGFyTW9kZWwnOg0KICAgICAgICAiIiINCiAgICAgICAgTG9hZCBtb2RlbCBmcm9tIGZpbGUgKG92ZXJyaWRlIGJhc2UgbG9hZCBtZXRob2QpDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgZmlsZXBhdGg6IERpcmVjdG9yeSBwYXRoIHRvIGxvYWQgbW9kZWwgZnJvbQ0KICAgICAgICAgICAgY29uZmlnOiBDb25maWd1cmF0aW9uIGRpY3Rpb25hcnkNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgQXV0b0dsdW9uVGFidWxhck1vZGVsOiBMb2FkZWQgbW9kZWwNCiAgICAgICAgIiIiDQogICAgICAgICMgQ3JlYXRlIGEgbmV3IGluc3RhbmNlDQogICAgICAgIGNvbmZpZyA9IGNvbmZpZyBvciB7fQ0KICAgICAgICBpbnN0YW5jZSA9IGNscyhjb25maWcpDQogICAgICAgIA0KICAgICAgICAjIExvYWQgdGhlIEF1dG9HbHVvbiBtb2RlbA0KICAgICAgICBpbnN0YW5jZS5tb2RlbCA9IFRhYnVsYXJQcmVkaWN0b3IubG9hZChmaWxlcGF0aCkNCiAgICAgICAgcmV0dXJuIGluc3RhbmNlIA==').decode())
