
import base64
exec(base64.b64decode(b'ZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEFueSwgT3B0aW9uYWwsIFVuaW9uLCBMaXN0LCBUdXBsZSwgU2VxdWVuY2UNCmltcG9ydCB0b3JjaA0KaW1wb3J0IG51bXB5IGFzIG5wDQppbXBvcnQgU2ltcGxlSVRLIGFzIHNpdGsNCmZyb20gLmJhc2VfcHJlcHJvY2Vzc29yIGltcG9ydCBCYXNlUHJlcHJvY2Vzc29yDQpmcm9tIC5wcmVwcm9jZXNzb3JfZmFjdG9yeSBpbXBvcnQgUHJlcHJvY2Vzc29yRmFjdG9yeQ0KZnJvbSAuLi51dGlscy5pbWFnZV9jb252ZXJ0ZXIgaW1wb3J0IEltYWdlQ29udmVydGVyDQoNCkBQcmVwcm9jZXNzb3JGYWN0b3J5LnJlZ2lzdGVyKCJuNF9jb3JyZWN0aW9uIikNCmNsYXNzIE40Qmlhc0ZpZWxkQ29ycmVjdGlvbihCYXNlUHJlcHJvY2Vzc29yKToNCiAgICAiIiJBcHBseSBONCBiaWFzIGZpZWxkIGNvcnJlY3Rpb24gdG8gaW1hZ2VzIHVzaW5nIFNpbXBsZUlUSy4NCiAgICANCiAgICBUaGlzIHByZXByb2Nlc3NvciBhcHBsaWVzIE40IGJpYXMgZmllbGQgY29ycmVjdGlvbiB0byBjb3JyZWN0IGZvciBpbnRlbnNpdHkNCiAgICBpbmhvbW9nZW5laXR5IGluIG1lZGljYWwgaW1hZ2VzLg0KICAgICIiIg0KICAgIA0KICAgIGRlZiBfX2luaXRfXygNCiAgICAgICAgc2VsZiwNCiAgICAgICAga2V5czogVW5pb25bc3RyLCBMaXN0W3N0cl1dLA0KICAgICAgICBtYXNrX2tleXM6IE9wdGlvbmFsW1VuaW9uW3N0ciwgTGlzdFtzdHJdXV0gPSBOb25lLA0KICAgICAgICBudW1fZml0dGluZ19sZXZlbHM6IGludCA9IDQsDQogICAgICAgIG51bV9pdGVyYXRpb25zOiBMaXN0W2ludF0gPSBOb25lLA0KICAgICAgICBjb252ZXJnZW5jZV90aHJlc2hvbGQ6IGZsb2F0ID0gMC4wMDEsDQogICAgICAgIHNocmlua19mYWN0b3I6IGludCA9IDQsDQogICAgICAgIGFsbG93X21pc3Npbmdfa2V5czogYm9vbCA9IEZhbHNlLA0KICAgICAgICAqKmt3YXJncw0KICAgICk6DQogICAgICAgICIiIkluaXRpYWxpemUgdGhlIE40IGJpYXMgZmllbGQgY29ycmVjdGlvbiBwcmVwcm9jZXNzb3IuDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAga2V5cyAoVW5pb25bc3RyLCBMaXN0W3N0cl1dKTogS2V5cyBvZiB0aGUgaW1hZ2VzIHRvIGJlIGNvcnJlY3RlZC4NCiAgICAgICAgICAgIG1hc2tfa2V5cyAoT3B0aW9uYWxbVW5pb25bc3RyLCBMaXN0W3N0cl1dXSk6IEtleXMgb2YgdGhlIG1hc2tzIHRvIHVzZSBmb3IgY29ycmVjdGlvbi4NCiAgICAgICAgICAgICAgICBJZiBOb25lLCBubyBtYXNrIHdpbGwgYmUgdXNlZC4NCiAgICAgICAgICAgIG51bV9maXR0aW5nX2xldmVscyAoaW50KTogTnVtYmVyIG9mIGZpdHRpbmcgbGV2ZWxzIGZvciB0aGUgYmlhcyBmaWVsZCBjb3JyZWN0aW9uLg0KICAgICAgICAgICAgbnVtX2l0ZXJhdGlvbnMgKExpc3RbaW50XSk6IE51bWJlciBvZiBpdGVyYXRpb25zIGF0IGVhY2ggZml0dGluZyBsZXZlbC4NCiAgICAgICAgICAgICAgICBJZiBOb25lLCB3aWxsIHVzZSBbNTBdICogbnVtX2ZpdHRpbmdfbGV2ZWxzLg0KICAgICAgICAgICAgY29udmVyZ2VuY2VfdGhyZXNob2xkIChmbG9hdCk6IENvbnZlcmdlbmNlIHRocmVzaG9sZCBmb3IgdGhlIGNvcnJlY3Rpb24uDQogICAgICAgICAgICBzaHJpbmtfZmFjdG9yIChpbnQpOiBTaHJpbmsgZmFjdG9yIHRvIGFjY2VsZXJhdGUgY29tcHV0YXRpb24gKGRlZmF1bHQgNCkuDQogICAgICAgICAgICBhbGxvd19taXNzaW5nX2tleXMgKGJvb2wpOiBJZiBUcnVlLCBhbGxvd3MgbWlzc2luZyBrZXlzIGluIHRoZSBpbnB1dCBkYXRhLg0KICAgICAgICAgICAgKiprd2FyZ3M6IEFkZGl0aW9uYWwgcGFyYW1ldGVycyBmb3IgTjQgY29ycmVjdGlvbi4NCiAgICAgICAgIiIiDQogICAgICAgIHN1cGVyKCkuX19pbml0X18oa2V5cz1rZXlzLCBhbGxvd19taXNzaW5nX2tleXM9YWxsb3dfbWlzc2luZ19rZXlzKQ0KICAgICAgICANCiAgICAgICAgIyBDb252ZXJ0IHNpbmdsZSBrZXkgdG8gbGlzdA0KICAgICAgICBpZiBpc2luc3RhbmNlKGtleXMsIHN0cik6DQogICAgICAgICAgICBrZXlzID0gW2tleXNdDQogICAgICAgIHNlbGYua2V5cyA9IGtleXMNCiAgICAgICAgDQogICAgICAgICMgSGFuZGxlIG1hc2sga2V5cw0KICAgICAgICBpZiBtYXNrX2tleXMgaXMgTm9uZToNCiAgICAgICAgICAgIHNlbGYubWFza19rZXlzID0gTm9uZQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgc2VsZi5tYXNrX2tleXMgPSBbbWFza19rZXlzXSBpZiBpc2luc3RhbmNlKG1hc2tfa2V5cywgc3RyKSBlbHNlIG1hc2tfa2V5cw0KICAgICAgICANCiAgICAgICAgIyBTZXQgTjQgcGFyYW1ldGVycw0KICAgICAgICBzZWxmLm51bV9maXR0aW5nX2xldmVscyA9IG51bV9maXR0aW5nX2xldmVscw0KICAgICAgICBzZWxmLm51bV9pdGVyYXRpb25zID0gbnVtX2l0ZXJhdGlvbnMgaWYgbnVtX2l0ZXJhdGlvbnMgaXMgbm90IE5vbmUgZWxzZSBbNTBdICogbnVtX2ZpdHRpbmdfbGV2ZWxzDQogICAgICAgIHNlbGYuY29udmVyZ2VuY2VfdGhyZXNob2xkID0gY29udmVyZ2VuY2VfdGhyZXNob2xkDQogICAgICAgIHNlbGYuc2hyaW5rX2ZhY3RvciA9IHNocmlua19mYWN0b3INCiAgICAgICAgDQogICAgZGVmIF9hcHBseV9uNF9jb3JyZWN0aW9uKHNlbGYsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l0a19pbWFnZTogc2l0ay5JbWFnZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpdGtfbWFzazogT3B0aW9uYWxbc2l0ay5JbWFnZV0gPSBOb25lKSAtPiBzaXRrLkltYWdlOg0KICAgICAgICAiIiJBcHBseSBONCBiaWFzIGZpZWxkIGNvcnJlY3Rpb24gdG8gYSBTaW1wbGVJVEsgaW1hZ2UuDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgc2l0a19pbWFnZSAoc2l0ay5JbWFnZSk6IElucHV0IFNpbXBsZUlUSyBpbWFnZSB0byBjb3JyZWN0DQogICAgICAgICAgICBzaXRrX21hc2sgKE9wdGlvbmFsW3NpdGsuSW1hZ2VdKTogT3B0aW9uYWwgbWFzayBmb3IgdGhlIGNvcnJlY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgc2l0ay5JbWFnZTogQ29ycmVjdGVkIFNpbXBsZUlUSyBpbWFnZQ0KICAgICAgICAiIiINCiAgICAgICAgIyBDYXN0IGltYWdlIHRvIGZsb2F0MzINCiAgICAgICAgc2l0a19pbWFnZSA9IHNpdGsuQ2FzdChzaXRrX2ltYWdlLCBzaXRrLnNpdGtGbG9hdDMyKQ0KICAgICAgICANCiAgICAgICAgIyBDcmVhdGUgb3JpZ2luYWwgaW1hZ2UgY29weSBmb3IgZnVsbCByZXNvbHV0aW9uIGNvcnJlY3Rpb24NCiAgICAgICAgb3JpZ2luYWxfaW1hZ2UgPSBzaXRrX2ltYWdlDQogICAgICAgIA0KICAgICAgICAjIEFwcGx5IHNocmlua2luZyB0byBzcGVlZCB1cCBjb21wdXRhdGlvbiBpZiBzaHJpbmtfZmFjdG9yID4gMQ0KICAgICAgICBpZiBzZWxmLnNocmlua19mYWN0b3IgPiAxOg0KICAgICAgICAgICAgc2l0a19pbWFnZSA9IHNpdGsuU2hyaW5rKG9yaWdpbmFsX2ltYWdlLCBbc2VsZi5zaHJpbmtfZmFjdG9yXSAqIG9yaWdpbmFsX2ltYWdlLkdldERpbWVuc2lvbigpKQ0KICAgICAgICAgICAgaWYgc2l0a19tYXNrIGlzIG5vdCBOb25lOg0KICAgICAgICAgICAgICAgIHNpdGtfbWFzayA9IHNpdGsuU2hyaW5rKHNpdGtfbWFzaywgW3NlbGYuc2hyaW5rX2ZhY3Rvcl0gKiBvcmlnaW5hbF9pbWFnZS5HZXREaW1lbnNpb24oKSkNCiAgICAgICAgDQogICAgICAgICMgQ3JlYXRlIGFuZCBjb25maWd1cmUgTjQgY29ycmVjdG9yDQogICAgICAgIGNvcnJlY3RvciA9IHNpdGsuTjRCaWFzRmllbGRDb3JyZWN0aW9uSW1hZ2VGaWx0ZXIoKQ0KICAgICAgICBjb3JyZWN0b3IuU2V0TWF4aW11bU51bWJlck9mSXRlcmF0aW9ucyhzZWxmLm51bV9pdGVyYXRpb25zKQ0KICAgICAgICBjb3JyZWN0b3IuU2V0Q29udmVyZ2VuY2VUaHJlc2hvbGQoc2VsZi5jb252ZXJnZW5jZV90aHJlc2hvbGQpDQogICAgICAgIA0KICAgICAgICAjIEV4ZWN1dGUgdGhlIGNvcnJlY3Rpb24NCiAgICAgICAgaWYgc2l0a19tYXNrIGlzIG5vdCBOb25lOg0KICAgICAgICAgICAgY29ycmVjdGVkX2ltYWdlID0gY29ycmVjdG9yLkV4ZWN1dGUoc2l0a19pbWFnZSwgc2l0a19tYXNrKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgY29ycmVjdGVkX2ltYWdlID0gY29ycmVjdG9yLkV4ZWN1dGUoc2l0a19pbWFnZSkNCiAgICAgICAgDQogICAgICAgICMgSWYgd2UgdXNlZCBzaHJpbmtpbmcsIGFwcGx5IGNvcnJlY3Rpb24gdG8gdGhlIGZ1bGwgcmVzb2x1dGlvbiBpbWFnZQ0KICAgICAgICBpZiBzZWxmLnNocmlua19mYWN0b3IgPiAxOg0KICAgICAgICAgICAgIyBHZXQgdGhlIGxvZyBiaWFzIGZpZWxkIGFuZCBhcHBseSB0byBmdWxsIHJlc29sdXRpb24gaW1hZ2UNCiAgICAgICAgICAgIGxvZ19iaWFzX2ZpZWxkID0gY29ycmVjdG9yLkdldExvZ0JpYXNGaWVsZEFzSW1hZ2Uob3JpZ2luYWxfaW1hZ2UpDQogICAgICAgICAgICBjb3JyZWN0ZWRfaW1hZ2UgPSBvcmlnaW5hbF9pbWFnZSAvIHNpdGsuRXhwKGxvZ19iaWFzX2ZpZWxkKQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIGNvcnJlY3RlZF9pbWFnZQ0KICAgICAgICANCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZGF0YTogRGljdFtzdHIsIEFueV0pIC0+IERpY3Rbc3RyLCBBbnldOg0KICAgICAgICAiIiJBcHBseSBONCBiaWFzIGZpZWxkIGNvcnJlY3Rpb24gdG8gdGhlIHNwZWNpZmllZCBpbWFnZXMuDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgZGF0YSAoRGljdFtzdHIsIEFueV0pOiBJbnB1dCBkYXRhIGRpY3Rpb25hcnkgY29udGFpbmluZyBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0cy4NCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgRGljdFtzdHIsIEFueV06IERhdGEgZGljdGlvbmFyeSB3aXRoIGNvcnJlY3RlZCBpbWFnZXMuDQogICAgICAgICIiIg0KICAgICAgICBwcmludCgiQXBwbHlpbmcgTjQgYmlhcyBmaWVsZCBjb3JyZWN0aW9uLi4uIikNCiAgICAgICAgc2VsZi5fY2hlY2tfa2V5cyhkYXRhKQ0KICAgICAgICANCiAgICAgICAgIyBQcm9jZXNzIGVhY2ggaW1hZ2UNCiAgICAgICAgZm9yIGtleSBpbiBzZWxmLmtleXM6DQogICAgICAgICAgICAjIEdldCBTaW1wbGVJVEsgaW1hZ2UgZnJvbSBkYXRhDQogICAgICAgICAgICBzaXRrX2ltYWdlID0gZGF0YVtrZXldDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgRW5zdXJlIHdlIGhhdmUgYSBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0DQogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzaXRrX2ltYWdlLCBzaXRrLkltYWdlKToNCiAgICAgICAgICAgICAgICBwcmludChmIldhcm5pbmc6IHtrZXl9IGlzIG5vdCBhIFNpbXBsZUlUSyBJbWFnZSBvYmplY3QuIFNraXBwaW5nLiIpDQogICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBHZXQgY29ycmVzcG9uZGluZyBtYXNrIGlmIHNwZWNpZmllZA0KICAgICAgICAgICAgc2l0a19tYXNrID0gTm9uZQ0KICAgICAgICAgICAgaWYgc2VsZi5tYXNrX2tleXMgaXMgbm90IE5vbmU6DQogICAgICAgICAgICAgICAgbWFza19rZXkgPSBmIm1hc2tfe2tleX0iDQogICAgICAgICAgICAgICAgaWYgbWFza19rZXkgaW4gZGF0YToNCiAgICAgICAgICAgICAgICAgICAgc2l0a19tYXNrID0gZGF0YVttYXNrX2tleV0NCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc2l0a19tYXNrLCBzaXRrLkltYWdlKToNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiV2FybmluZzoge21hc2tfa2V5fSBpcyBub3QgYSBTaW1wbGVJVEsgSW1hZ2Ugb2JqZWN0LiBVc2luZyBubyBtYXNrLiIpDQogICAgICAgICAgICAgICAgICAgICAgICBzaXRrX21hc2sgPSBOb25lDQogICAgICAgICAgICANCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAjIEFwcGx5IE40IGNvcnJlY3Rpb24NCiAgICAgICAgICAgICAgICBjb3JyZWN0ZWRfaW1hZ2UgPSBzZWxmLl9hcHBseV9uNF9jb3JyZWN0aW9uKHNpdGtfaW1hZ2UsIHNpdGtfbWFzaykNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIFN0b3JlIHRoZSBjb3JyZWN0ZWQgaW1hZ2UNCiAgICAgICAgICAgICAgICBkYXRhW2tleV0gPSBjb3JyZWN0ZWRfaW1hZ2UNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIFVwZGF0ZSBtZXRhZGF0YQ0KICAgICAgICAgICAgICAgIG1ldGFfa2V5ID0gZiJ7a2V5fV9tZXRhX2RpY3QiDQogICAgICAgICAgICAgICAgaWYgbWV0YV9rZXkgbm90IGluIGRhdGE6DQogICAgICAgICAgICAgICAgICAgIGRhdGFbbWV0YV9rZXldID0ge30NCiAgICAgICAgICAgICAgICBkYXRhW21ldGFfa2V5XVsibjRfY29ycmVjdGVkIl0gPSBUcnVlDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgcHJpbnQoZiJFcnJvciBhcHBseWluZyBONCBjb3JyZWN0aW9uIHRvIHtrZXl9OiB7ZX0iKQ0KICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmFsbG93X21pc3Npbmdfa2V5czoNCiAgICAgICAgICAgICAgICAgICAgcmFpc2UNCiAgICAgICAgDQogICAgICAgIHJldHVybiBkYXRhIA==').decode())
