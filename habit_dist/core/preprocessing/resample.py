
import base64
exec(base64.b64decode(b'ZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEFueSwgT3B0aW9uYWwsIFNlcXVlbmNlLCBVbmlvbiwgTGlzdCwgVHVwbGUNCmltcG9ydCBudW1weSBhcyBucA0KaW1wb3J0IFNpbXBsZUlUSyBhcyBzaXRrDQppbXBvcnQgb3MNCmZyb20gLmJhc2VfcHJlcHJvY2Vzc29yIGltcG9ydCBCYXNlUHJlcHJvY2Vzc29yDQpmcm9tIC5wcmVwcm9jZXNzb3JfZmFjdG9yeSBpbXBvcnQgUHJlcHJvY2Vzc29yRmFjdG9yeQ0KDQpAUHJlcHJvY2Vzc29yRmFjdG9yeS5yZWdpc3RlcigicmVzYW1wbGUiKQ0KY2xhc3MgUmVzYW1wbGVQcmVwcm9jZXNzb3IoQmFzZVByZXByb2Nlc3Nvcik6DQogICAgIiIiUmVzYW1wbGUgaW1hZ2VzIHRvIGEgdGFyZ2V0IHNwYWNpbmcgdXNpbmcgU2ltcGxlSVRLLg0KICAgIA0KICAgIFRoaXMgcHJlcHJvY2Vzc29yIHJlc2FtcGxlcyBpbWFnZXMgYW5kIG1hc2tzIHRvIGEgc3BlY2lmaWVkIHRhcmdldCBzcGFjaW5nLg0KICAgIEltYWdlcyBhbmQgbWFza3MgYXJlIHByb2Nlc3NlZCBzZXBhcmF0ZWx5IHdpdGggZGlmZmVyZW50IGludGVycG9sYXRpb24gbW9kZXM6DQogICAgLSBJbWFnZXM6IHVzZSBzcGVjaWZpZWQgaW50ZXJwb2xhdGlvbiBtb2RlIChkZWZhdWx0OiBiaWxpbmVhcikNCiAgICAtIE1hc2tzOiB1c2UgbmVhcmVzdCBuZWlnaGJvciBpbnRlcnBvbGF0aW9uDQogICAgIiIiDQogICAgDQogICAgZGVmIF9faW5pdF9fKA0KICAgICAgICBzZWxmLA0KICAgICAgICBrZXlzOiBVbmlvbltzdHIsIExpc3Rbc3RyXV0sDQogICAgICAgIHRhcmdldF9zcGFjaW5nOiBTZXF1ZW5jZVtmbG9hdF0sDQogICAgICAgIGltZ19tb2RlOiBzdHIgPSAiYmlsaW5lYXIiLA0KICAgICAgICBwYWRkaW5nX21vZGU6IHN0ciA9ICJib3JkZXIiLA0KICAgICAgICBhbGlnbl9jb3JuZXJzOiBib29sID0gRmFsc2UsDQogICAgICAgIGFsbG93X21pc3Npbmdfa2V5czogYm9vbCA9IEZhbHNlLA0KICAgICAgICAqKmt3YXJncw0KICAgICk6DQogICAgICAgICIiIkluaXRpYWxpemUgdGhlIHJlc2FtcGxlIHByZXByb2Nlc3Nvci4NCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBrZXlzIChVbmlvbltzdHIsIExpc3Rbc3RyXV0pOiBLZXlzIG9mIHRoZSBjb3JyZXNwb25kaW5nIGl0ZW1zIHRvIGJlIHRyYW5zZm9ybWVkLg0KICAgICAgICAgICAgICAgIFNob3VsZCBpbmNsdWRlIGJvdGggaW1hZ2UgYW5kIG1hc2sga2V5cy4NCiAgICAgICAgICAgIHRhcmdldF9zcGFjaW5nIChTZXF1ZW5jZVtmbG9hdF0pOiBUYXJnZXQgc3BhY2luZyB0byByZXNhbXBsZSB0bywgZS5nLiwgKDIuMCwgMi4wLCAyLjApLg0KICAgICAgICAgICAgaW1nX21vZGUgKHN0cik6IEludGVycG9sYXRpb24gbW9kZSBmb3IgaW1hZ2UgZGF0YS4gRGVmYXVsdHMgdG8gImJpbGluZWFyIi4NCiAgICAgICAgICAgIHBhZGRpbmdfbW9kZSAoc3RyKTogUGFkZGluZyBtb2RlIGZvciBvdXQtb2YtYm91bmQgdmFsdWVzLiBEZWZhdWx0cyB0byAiYm9yZGVyIi4NCiAgICAgICAgICAgIGFsaWduX2Nvcm5lcnMgKGJvb2wpOiBXaGV0aGVyIHRvIGFsaWduIGNvcm5lcnMuIERlZmF1bHRzIHRvIEZhbHNlLg0KICAgICAgICAgICAgYWxsb3dfbWlzc2luZ19rZXlzIChib29sKTogSWYgVHJ1ZSwgYWxsb3dzIG1pc3Npbmcga2V5cyBpbiB0aGUgaW5wdXQgZGF0YS4NCiAgICAgICAgICAgICoqa3dhcmdzOiBBZGRpdGlvbmFsIHBhcmFtZXRlcnMgZm9yIHJlc2FtcGxpbmcuDQogICAgICAgICIiIg0KICAgICAgICBzdXBlcigpLl9faW5pdF9fKGtleXM9a2V5cywgYWxsb3dfbWlzc2luZ19rZXlzPWFsbG93X21pc3Npbmdfa2V5cykNCiAgICAgICAgDQogICAgICAgICMgQ29udmVydCBzaW5nbGUga2V5IHRvIGxpc3QNCiAgICAgICAgaWYgaXNpbnN0YW5jZShrZXlzLCBzdHIpOg0KICAgICAgICAgICAga2V5cyA9IFtrZXlzXQ0KICAgICAgICBzZWxmLmtleXMgPSBrZXlzDQogICAgICAgIA0KICAgICAgICAjIFNlcGFyYXRlIGltYWdlIGFuZCBtYXNrIGtleXMNCiAgICAgICAgc2VsZi5pbWdfa2V5cyA9IHNlbGYua2V5cw0KICAgICAgICBzZWxmLm1hc2tfa2V5cyA9IFtmIm1hc2tfe2tleX0iIGZvciBrZXkgaW4gc2VsZi5rZXlzXQ0KICAgICAgICANCiAgICAgICAgIyBHZXQgcGFyYW1ldGVycyBmcm9tIGt3YXJncyBvciB1c2UgZGVmYXVsdHMNCiAgICAgICAgc2VsZi50YXJnZXRfc3BhY2luZyA9IGt3YXJncy5wb3AoJ3RhcmdldF9zcGFjaW5nJywgdGFyZ2V0X3NwYWNpbmcpDQogICAgICAgIHNlbGYuaW1nX21vZGUgPSBrd2FyZ3MucG9wKCdpbWdfbW9kZScsIGltZ19tb2RlKQ0KICAgICAgICBzZWxmLnBhZGRpbmdfbW9kZSA9IGt3YXJncy5wb3AoJ3BhZGRpbmdfbW9kZScsIHBhZGRpbmdfbW9kZSkNCiAgICAgICAgc2VsZi5hbGlnbl9jb3JuZXJzID0ga3dhcmdzLnBvcCgnYWxpZ25fY29ybmVycycsIGFsaWduX2Nvcm5lcnMpDQogICAgICAgIA0KICAgICAgICAjIE1hcCBpbnRlcnBvbGF0aW9uIG1vZGVzIHRvIFNpbXBsZUlUSyBpbnRlcnBvbGF0b3Igb2JqZWN0cw0KICAgICAgICBzZWxmLmludGVycF9tYXAgPSB7DQogICAgICAgICAgICAibmVhcmVzdCI6IHNpdGsuc2l0a05lYXJlc3ROZWlnaGJvciwNCiAgICAgICAgICAgICJsaW5lYXIiOiBzaXRrLnNpdGtMaW5lYXIsDQogICAgICAgICAgICAiYmlsaW5lYXIiOiBzaXRrLnNpdGtMaW5lYXIsDQogICAgICAgICAgICAiYnNwbGluZSI6IHNpdGsuc2l0a0JTcGxpbmUsDQogICAgICAgICAgICAiYmljdWJpYyI6IHNpdGsuc2l0a0JTcGxpbmUsDQogICAgICAgICAgICAiZ2F1c3NpYW4iOiBzaXRrLnNpdGtHYXVzc2lhbiwNCiAgICAgICAgICAgICJsYW5jem9zIjogc2l0ay5zaXRrTGFuY3pvc1dpbmRvd2VkU2luYywNCiAgICAgICAgICAgICJoYW1taW5nIjogc2l0ay5zaXRrSGFtbWluZ1dpbmRvd2VkU2luYywNCiAgICAgICAgICAgICJjb3NpbmUiOiBzaXRrLnNpdGtDb3NpbmVXaW5kb3dlZFNpbmMsDQogICAgICAgICAgICAid2VsY2giOiBzaXRrLnNpdGtXZWxjaFdpbmRvd2VkU2luYywNCiAgICAgICAgICAgICJibGFja21hbiI6IHNpdGsuc2l0a0JsYWNrbWFuV2luZG93ZWRTaW5jDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICMgRGVmYXVsdCB0byBsaW5lYXIgaWYgbW9kZSBub3QgZm91bmQNCiAgICAgICAgc2VsZi5pbWdfaW50ZXJwID0gc2VsZi5pbnRlcnBfbWFwLmdldChzZWxmLmltZ19tb2RlLCBzaXRrLnNpdGtMaW5lYXIpDQogICAgICAgIA0KICAgIGRlZiBfcmVzYW1wbGVfaW1hZ2Uoc2VsZiwgDQogICAgICAgICAgICAgICAgICAgICAgIHNpdGtfaW1hZ2U6IHNpdGsuSW1hZ2UsIA0KICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRfc3BhY2luZzogU2VxdWVuY2VbZmxvYXRdLA0KICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnBvbGF0b3IpIC0+IFR1cGxlW25wLm5kYXJyYXksIFNlcXVlbmNlW2Zsb2F0XV06DQogICAgICAgICIiIlJlc2FtcGxlIGEgU2ltcGxlSVRLIGltYWdlLg0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIHNpdGtfaW1hZ2UgKHNpdGsuSW1hZ2UpOiBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0IHRvIHJlc2FtcGxlDQogICAgICAgICAgICB0YXJnZXRfc3BhY2luZyAoU2VxdWVuY2VbZmxvYXRdKTogVGFyZ2V0IHNwYWNpbmcgdG8gcmVzYW1wbGUgdG8NCiAgICAgICAgICAgIGludGVycG9sYXRvcjogU2ltcGxlSVRLIGludGVycG9sYXRvciBvYmplY3QgKGUuZy4sIHNpdGsuc2l0a0xpbmVhcikNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgVHVwbGVbbnAubmRhcnJheSwgU2VxdWVuY2VbZmxvYXRdXTogDQogICAgICAgICAgICAgICAgLSBSZXNhbXBsZWQgYXJyYXkgaW4gb3JpZ2luYWwgZm9ybWF0DQogICAgICAgICAgICAgICAgLSBPcmlnaW5hbCBzcGFjaW5nIG9mIHRoZSBpbWFnZQ0KICAgICAgICAiIiINCiAgICAgICAgIyBHZXQgb3JpZ2luYWwgc3BhY2luZyBmcm9tIHRoZSBpbWFnZQ0KICAgICAgICBvcmlnaW5hbF9zcGFjaW5nID0gc2l0a19pbWFnZS5HZXRTcGFjaW5nKCkNCiAgICAgICAgDQogICAgICAgICMgR2V0IGltYWdlIHNpemUNCiAgICAgICAgc2l6ZSA9IHNpdGtfaW1hZ2UuR2V0U2l6ZSgpDQogICAgICAgIA0KICAgICAgICAjIENhbGN1bGF0ZSB0aGUgbmV3IHNpemUgYWZ0ZXIgcmVzYW1wbGluZw0KICAgICAgICB6b29tX2ZhY3RvciA9IFtvcmlnX3N6IC8gdGFyZ2V0X3N6IGZvciBvcmlnX3N6LCB0YXJnZXRfc3ogaW4gemlwKG9yaWdpbmFsX3NwYWNpbmcsIHRhcmdldF9zcGFjaW5nKV0NCiAgICAgICAgbmV3X3NpemUgPSBbaW50KHJvdW5kKHN6ICogZmFjdG9yKSkgZm9yIHN6LCBmYWN0b3IgaW4gemlwKHNpemUsIHpvb21fZmFjdG9yKV0NCiAgICAgICAgDQogICAgICAgICMgQ3JlYXRlIHJlZmVyZW5jZSBpbWFnZSB3aXRoIHRhcmdldCBzcGFjaW5nDQogICAgICAgIHJlZmVyZW5jZV9pbWFnZSA9IHNpdGsuSW1hZ2UobmV3X3NpemUsIHNpdGtfaW1hZ2UuR2V0UGl4ZWxJRCgpKQ0KICAgICAgICByZWZlcmVuY2VfaW1hZ2UuU2V0U3BhY2luZyh0YXJnZXRfc3BhY2luZykNCiAgICAgICAgcmVmZXJlbmNlX2ltYWdlLlNldE9yaWdpbihzaXRrX2ltYWdlLkdldE9yaWdpbigpKQ0KICAgICAgICByZWZlcmVuY2VfaW1hZ2UuU2V0RGlyZWN0aW9uKHNpdGtfaW1hZ2UuR2V0RGlyZWN0aW9uKCkpDQogICAgICAgIA0KICAgICAgICAjIFBlcmZvcm0gcmVzYW1wbGluZw0KICAgICAgICByZXNhbXBsZXIgPSBzaXRrLlJlc2FtcGxlSW1hZ2VGaWx0ZXIoKQ0KICAgICAgICByZXNhbXBsZXIuU2V0UmVmZXJlbmNlSW1hZ2UocmVmZXJlbmNlX2ltYWdlKQ0KICAgICAgICByZXNhbXBsZXIuU2V0SW50ZXJwb2xhdG9yKGludGVycG9sYXRvcikNCiAgICAgICAgcmVzYW1wbGVkX3NpdGsgPSByZXNhbXBsZXIuRXhlY3V0ZShzaXRrX2ltYWdlKSAgICAgICAgDQogICAgICAgIHJldHVybiByZXNhbXBsZWRfc2l0aywgb3JpZ2luYWxfc3BhY2luZw0KICAgICAgICANCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZGF0YTogRGljdFtzdHIsIEFueV0pIC0+IERpY3Rbc3RyLCBBbnldOg0KICAgICAgICAiIiJSZXNhbXBsZSB0aGUgaW1hZ2VzIGFuZCBtYXNrcyB0byB0aGUgdGFyZ2V0IHNwYWNpbmcuDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgZGF0YSAoRGljdFtzdHIsIEFueV0pOiBJbnB1dCBkYXRhIGRpY3Rpb25hcnkgY29udGFpbmluZyBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0cyBhbmQgbWV0YWRhdGEuDQogICAgICAgICAgICAgICAgVGhlIHZhbHVlcyBmb3IgaW1hZ2UgYW5kIG1hc2sga2V5cyBzaG91bGQgYmUgU2ltcGxlSVRLIEltYWdlIG9iamVjdHMuDQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIERpY3Rbc3RyLCBBbnldOiBEYXRhIGRpY3Rpb25hcnkgd2l0aCByZXNhbXBsZWQgaW1hZ2VzIGFuZCBtYXNrcy4NCiAgICAgICAgIiIiDQogICAgICAgIHByaW50KGYiUmVzYW1wbGluZyBpbWFnZXMgdG8ge3NlbGYudGFyZ2V0X3NwYWNpbmd9Li4uIikNCiAgICAgICAgc2VsZi5fY2hlY2tfa2V5cyhkYXRhKQ0KICAgICAgICANCiAgICAgICAgIyBQcm9jZXNzIGltYWdlcw0KICAgICAgICBmb3Iga2V5IGluIHNlbGYuaW1nX2tleXM6DQogICAgICAgICAgICBtZXRhX2tleSA9IGYie2tleX1fbWV0YV9kaWN0Ig0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIEdldCBTaW1wbGVJVEsgaW1hZ2UgZnJvbSBkYXRhDQogICAgICAgICAgICBzaXRrX2ltYWdlID0gZGF0YVtrZXldDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgRW5zdXJlIHdlIGhhdmUgYSBTaW1wbGVJVEsgaW1hZ2Ugb2JqZWN0DQogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzaXRrX2ltYWdlLCBzaXRrLkltYWdlKToNCiAgICAgICAgICAgICAgICBwcmludChmIldhcm5pbmc6IHtrZXl9IGlzIG5vdCBhIFNpbXBsZUlUSyBJbWFnZSBvYmplY3QuIFNraXBwaW5nLiIpDQogICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBQZXJmb3JtIHJlc2FtcGxpbmcgd2l0aCBTaW1wbGVJVEsNCiAgICAgICAgICAgIHJlc2FtcGxlZF9pbWcsIG9yaWdpbmFsX3NwYWNpbmcgPSBzZWxmLl9yZXNhbXBsZV9pbWFnZSgNCiAgICAgICAgICAgICAgICBzaXRrX2ltYWdlPXNpdGtfaW1hZ2UsDQogICAgICAgICAgICAgICAgdGFyZ2V0X3NwYWNpbmc9c2VsZi50YXJnZXRfc3BhY2luZywNCiAgICAgICAgICAgICAgICBpbnRlcnBvbGF0b3I9c2VsZi5pbWdfaW50ZXJwDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgICMgU3RvcmUgdGhlIHJlc2FtcGxlZCBhcnJheSBpbiB0aGUgZGF0YQ0KICAgICAgICAgICAgZGF0YVtrZXldID0gcmVzYW1wbGVkX2ltZw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgIyBQcm9jZXNzIG1hc2tzIHdpdGggbmVhcmVzdCBuZWlnaGJvciBpbnRlcnBvbGF0aW9uDQogICAgICAgIGZvciBtYXNrX2tleSBpbiBzZWxmLm1hc2tfa2V5czoNCiAgICAgICAgICAgIGlmIG1hc2tfa2V5IG5vdCBpbiBkYXRhOg0KICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgR2V0IFNpbXBsZUlUSyBtYXNrIGZyb20gZGF0YQ0KICAgICAgICAgICAgc2l0a19tYXNrID0gZGF0YVttYXNrX2tleV0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBFbnN1cmUgd2UgaGF2ZSBhIFNpbXBsZUlUSyBpbWFnZSBvYmplY3QNCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNpdGtfbWFzaywgc2l0ay5JbWFnZSk6DQogICAgICAgICAgICAgICAgcHJpbnQoZiJXYXJuaW5nOiB7bWFza19rZXl9IGlzIG5vdCBhIFNpbXBsZUlUSyBJbWFnZSBvYmplY3QuIFNraXBwaW5nLiIpDQogICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBQZXJmb3JtIHJlc2FtcGxpbmcgd2l0aCBTaW1wbGVJVEsgdXNpbmcgbmVhcmVzdCBuZWlnaGJvciBmb3IgbWFza3MNCiAgICAgICAgICAgIHJlc2FtcGxlZF9pbWcsIG9yaWdpbmFsX3NwYWNpbmcgPSBzZWxmLl9yZXNhbXBsZV9pbWFnZSgNCiAgICAgICAgICAgICAgICBzaXRrX2ltYWdlPXNpdGtfbWFzaywNCiAgICAgICAgICAgICAgICB0YXJnZXRfc3BhY2luZz1zZWxmLnRhcmdldF9zcGFjaW5nLA0KICAgICAgICAgICAgICAgIGludGVycG9sYXRvcj1zaXRrLnNpdGtOZWFyZXN0TmVpZ2hib3INCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBTdG9yZSB0aGUgcmVzYW1wbGVkIGFycmF5IGluIHRoZSBkYXRhDQogICAgICAgICAgICBkYXRhW21hc2tfa2V5XSA9IHJlc2FtcGxlZF9pbWc=').decode())
