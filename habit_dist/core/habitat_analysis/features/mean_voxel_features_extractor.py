
import base64
exec(base64.b64decode(b'IiIiDQpNZWFuIHZveGVsIGZlYXR1cmVzIGV4dHJhY3RvciBmb3Igc3VwZXJ2b3hlbHMNCiIiIg0KDQppbXBvcnQgb3MNCmltcG9ydCBudW1weSBhcyBucA0KaW1wb3J0IHBhbmRhcyBhcyBwZA0KaW1wb3J0IFNpbXBsZUlUSyBhcyBzaXRrDQpmcm9tIHR5cGluZyBpbXBvcnQgVW5pb24sIExpc3QsIERpY3QsIE9wdGlvbmFsLCBBbnkNCg0KZnJvbSAuYmFzZV9mZWF0dXJlX2V4dHJhY3RvciBpbXBvcnQgQmFzZUZlYXR1cmVFeHRyYWN0b3IsIHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yDQoNCg0KQHJlZ2lzdGVyX2ZlYXR1cmVfZXh0cmFjdG9yKCdtZWFuX3ZveGVsX2ZlYXR1cmVzJykNCmNsYXNzIE1lYW5Wb3hlbEZlYXR1cmVzRXh0cmFjdG9yKEJhc2VGZWF0dXJlRXh0cmFjdG9yKToNCiAgICAiIiINCiAgICBFeHRyYWN0IG1lYW4gdm94ZWwgZmVhdHVyZXMgZm9yIGVhY2ggc3VwZXJ2b3hlbCBpbiB0aGUgc3VwZXJ2b3hlbCBtYXANCiAgICANCiAgICBUaGlzIGV4dHJhY3RvciBjYWxjdWxhdGVzIHRoZSBtZWFuIHZhbHVlcyBvZiB2b3hlbCBmZWF0dXJlcyB3aXRoaW4gZWFjaCBzdXBlcnZveGVsLg0KICAgIEl0J3MgYSBzaW1wbGVyIGFsdGVybmF0aXZlIHRvIHJhZGlvbWljcyBmZWF0dXJlcywganVzdCB1c2luZyB0aGUgYXZlcmFnZSB2YWx1ZXMuDQogICAgIiIiDQogICAgDQogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzOiBBbnkpIC0+IE5vbmU6DQogICAgICAgICIiIg0KICAgICAgICBJbml0aWFsaXplIG1lYW4gdm94ZWwgZmVhdHVyZXMgZXh0cmFjdG9yDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgKiprd2FyZ3M6IEFkZGl0aW9uYWwgcGFyYW1ldGVycw0KICAgICAgICAiIiINCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykNCiAgICAgICAgc2VsZi5mZWF0dXJlX25hbWVzID0gW10NCiAgICAgICAgDQogICAgZGVmIGV4dHJhY3RfZmVhdHVyZXMoc2VsZiwgaW1hZ2VfZGF0YTogVW5pb25bc3RyLCBzaXRrLkltYWdlXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBzdXBlcnZveGVsX21hcDogVW5pb25bc3RyLCBzaXRrLkltYWdlXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJnczogQW55KSAtPiBwZC5EYXRhRnJhbWU6DQogICAgICAgICIiIg0KICAgICAgICBFeHRyYWN0IG1lYW4gdm94ZWwgZmVhdHVyZXMgZm9yIGVhY2ggc3VwZXJ2b3hlbA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGltYWdlX2RhdGE6IFBhdGggdG8gaW1hZ2UgZmlsZSwgU2ltcGxlSVRLIGltYWdlIG9iamVjdCwgb3IgRGF0YUZyYW1lIG9mIHZveGVsIGZlYXR1cmVzDQogICAgICAgICAgICBzdXBlcnZveGVsX21hcDogUGF0aCB0byBzdXBlcnZveGVsIG1hcCBmaWxlIG9yIFNpbXBsZUlUSyBpbWFnZSBvYmplY3QNCiAgICAgICAgICAgICoqa3dhcmdzOiBBZGRpdGlvbmFsIHBhcmFtZXRlcnMNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgcGQuRGF0YUZyYW1lOiBEYXRhRnJhbWUgd2l0aCBtZWFuIHZveGVsIGZlYXR1cmVzIGZvciBlYWNoIHN1cGVydm94ZWwNCiAgICAgICAgIiIiDQogICAgICAgICMgTG9hZCBzdXBlcnZveGVsIG1hcA0KICAgICAgICBpZiBpc2luc3RhbmNlKHN1cGVydm94ZWxfbWFwLCBzdHIpOg0KICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoc3VwZXJ2b3hlbF9tYXApOg0KICAgICAgICAgICAgICAgIHN2X21hcCA9IHNpdGsuUmVhZEltYWdlKHN1cGVydm94ZWxfbWFwKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICByYWlzZSBGaWxlTm90Rm91bmRFcnJvcihmIlN1cGVydm94ZWwgbWFwIGZpbGUgbm90IGZvdW5kOiB7c3VwZXJ2b3hlbF9tYXB9IikNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHN2X21hcCA9IHN1cGVydm94ZWxfbWFwDQogICAgICAgICAgICANCiAgICAgICAgIyBHZXQgc3VwZXJ2b3hlbCBtYXAgYXMgbnVtcHkgYXJyYXkNCiAgICAgICAgc3ZfYXJyYXkgPSBzaXRrLkdldEFycmF5RnJvbUltYWdlKHN2X21hcCkNCiAgICAgICAgDQogICAgICAgICMgSGFuZGxlIGRpZmZlcmVudCB0eXBlcyBvZiBpbWFnZV9kYXRhDQogICAgICAgIGlmIGlzaW5zdGFuY2UoaW1hZ2VfZGF0YSwgcGQuRGF0YUZyYW1lKToNCiAgICAgICAgICAgICMgSWYgaW1hZ2VfZGF0YSBpcyBhbHJlYWR5IGEgRGF0YUZyYW1lIG9mIHZveGVsIGZlYXR1cmVzLCB1c2UgaXQgZGlyZWN0bHkNCiAgICAgICAgICAgIHZveGVsX2ZlYXR1cmVzX2RmID0gaW1hZ2VfZGF0YQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgIyBPdGhlcndpc2UsIGxvYWQgdGhlIGltYWdlIGFuZCBleHRyYWN0IGludGVuc2l0eSB2YWx1ZXMNCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaW1hZ2VfZGF0YSwgc3RyKToNCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhpbWFnZV9kYXRhKToNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBzaXRrLlJlYWRJbWFnZShpbWFnZV9kYXRhKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHJhaXNlIEZpbGVOb3RGb3VuZEVycm9yKGYiSW1hZ2UgZmlsZSBub3QgZm91bmQ6IHtpbWFnZV9kYXRhfSIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGltYWdlID0gaW1hZ2VfZGF0YQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBHZXQgaW1hZ2UgYXJyYXkNCiAgICAgICAgICAgIGltYWdlX2FycmF5ID0gc2l0ay5HZXRBcnJheUZyb21JbWFnZShpbWFnZSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBDcmVhdGUgRGF0YUZyYW1lIHdpdGggaW50ZW5zaXR5IHZhbHVlcw0KICAgICAgICAgICAgIyBGaXJzdCwgZmxhdHRlbiBhcnJheXMNCiAgICAgICAgICAgIHN2X2ZsYXQgPSBzdl9hcnJheS5mbGF0dGVuKCkNCiAgICAgICAgICAgIGltZ19mbGF0ID0gaW1hZ2VfYXJyYXkuZmxhdHRlbigpDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgQ3JlYXRlIERhdGFGcmFtZSB3aXRoIHN1cGVydm94ZWwgbGFiZWxzIGFuZCBpbnRlbnNpdHkgdmFsdWVzDQogICAgICAgICAgICB2b3hlbF9mZWF0dXJlc19kZiA9IHBkLkRhdGFGcmFtZSh7DQogICAgICAgICAgICAgICAgJ3N1cGVydm94ZWwnOiBzdl9mbGF0LA0KICAgICAgICAgICAgICAgICdpbnRlbnNpdHknOiBpbWdfZmxhdA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBSZW1vdmUgYmFja2dyb3VuZCB2b3hlbHMgKHN1cGVydm94ZWwgbGFiZWwgPSAwKQ0KICAgICAgICAgICAgdm94ZWxfZmVhdHVyZXNfZGYgPSB2b3hlbF9mZWF0dXJlc19kZlt2b3hlbF9mZWF0dXJlc19kZlsnc3VwZXJ2b3hlbCddID4gMF0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBTZXQgZmVhdHVyZSBuYW1lcw0KICAgICAgICAgICAgc2VsZi5mZWF0dXJlX25hbWVzID0gWydpbnRlbnNpdHknXQ0KICAgICAgICAgICAgDQogICAgICAgICMgQ2FsY3VsYXRlIG1lYW4gZmVhdHVyZXMgZm9yIGVhY2ggc3VwZXJ2b3hlbA0KICAgICAgICAjIEZpbmQgdW5pcXVlIHN1cGVydm94ZWwgbGFiZWxzDQogICAgICAgIHN2X2xhYmVscyA9IG5wLnVuaXF1ZShzdl9hcnJheSkNCiAgICAgICAgc3ZfbGFiZWxzID0gc3ZfbGFiZWxzW3N2X2xhYmVscyA+IDBdICAjIEV4Y2x1ZGUgYmFja2dyb3VuZCAobGFiZWwgMCkNCiAgICAgICAgDQogICAgICAgIGlmIGxlbihzdl9sYWJlbHMpID09IDA6DQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJTdXBlcnZveGVsIG1hcCBoYXMgbm8gbm9uLXplcm8gdmFsdWVzLCBjYW5ub3QgZXh0cmFjdCBmZWF0dXJlcyIpDQogICAgICAgIA0KICAgICAgICAjIEluaXRpYWxpemUgZmVhdHVyZSBkYXRhIHN0b3JhZ2UNCiAgICAgICAgZmVhdHVyZV9kYXRhID0gW10NCiAgICAgICAgDQogICAgICAgICMgRm9yIGVhY2ggc3VwZXJ2b3hlbCwgY2FsY3VsYXRlIG1lYW4gb2YgZmVhdHVyZXMNCiAgICAgICAgZm9yIHN2X2xhYmVsIGluIHN2X2xhYmVsczoNCiAgICAgICAgICAgICMgSWYgaW5wdXQgaXMgRGF0YUZyYW1lLCBnZXQgcm93cyBmb3IgY3VycmVudCBzdXBlcnZveGVsDQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGltYWdlX2RhdGEsIHBkLkRhdGFGcmFtZSk6DQogICAgICAgICAgICAgICAgIyBHZXQgZmVhdHVyZSBjb2x1bW4gbmFtZXMgKGV4Y2x1ZGUgJ3N1cGVydm94ZWwnIGNvbHVtbiBpZiBwcmVzZW50KQ0KICAgICAgICAgICAgICAgIGZlYXR1cmVfY29scyA9IFtjb2wgZm9yIGNvbCBpbiB2b3hlbF9mZWF0dXJlc19kZi5jb2x1bW5zIGlmIGNvbCAhPSAnc3VwZXJ2b3hlbCddDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgIyBVcGRhdGUgZmVhdHVyZSBuYW1lcyBpZiBub3QgYWxyZWFkeSBzZXQNCiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5mZWF0dXJlX25hbWVzOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLmZlYXR1cmVfbmFtZXMgPSBmZWF0dXJlX2NvbHMNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIEdldCB2b3hlbHMgZm9yIGN1cnJlbnQgc3VwZXJ2b3hlbA0KICAgICAgICAgICAgICAgIHN2X3ZveGVscyA9IHZveGVsX2ZlYXR1cmVzX2RmW3ZveGVsX2ZlYXR1cmVzX2RmWydzdXBlcnZveGVsJ10gPT0gc3ZfbGFiZWxdDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgbGVuKHN2X3ZveGVscykgPT0gMDoNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIENhbGN1bGF0ZSBtZWFuIG9mIGVhY2ggZmVhdHVyZSBmb3IgY3VycmVudCBzdXBlcnZveGVsDQogICAgICAgICAgICAgICAgZmVhdHVyZV9yb3cgPSB7IlN1cGVydm94ZWxJRCI6IGludChzdl9sYWJlbCl9DQogICAgICAgICAgICAgICAgZm9yIGNvbCBpbiBmZWF0dXJlX2NvbHM6DQogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVfcm93W2NvbF0gPSBzdl92b3hlbHNbY29sXS5tZWFuKCkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmZWF0dXJlX2RhdGEuYXBwZW5kKGZlYXR1cmVfcm93KQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAjIEZvciBpbWFnZSBpbnRlbnNpdHkgZGF0YQ0KICAgICAgICAgICAgICAgICMgR2V0IGluZGljZXMgZm9yIGN1cnJlbnQgc3VwZXJ2b3hlbA0KICAgICAgICAgICAgICAgIGluZGljZXMgPSBzdl9hcnJheSA9PSBzdl9sYWJlbA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIG5wLnN1bShpbmRpY2VzKSA9PSAwOg0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICMgQ2FsY3VsYXRlIG1lYW4gaW50ZW5zaXR5DQogICAgICAgICAgICAgICAgbWVhbl9pbnRlbnNpdHkgPSBucC5tZWFuKGltYWdlX2FycmF5W2luZGljZXNdKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICMgQ3JlYXRlIGZlYXR1cmUgcm93DQogICAgICAgICAgICAgICAgZmVhdHVyZV9yb3cgPSB7DQogICAgICAgICAgICAgICAgICAgICJTdXBlcnZveGVsSUQiOiBpbnQoc3ZfbGFiZWwpLA0KICAgICAgICAgICAgICAgICAgICAiaW50ZW5zaXR5IjogbWVhbl9pbnRlbnNpdHkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgZmVhdHVyZV9kYXRhLmFwcGVuZChmZWF0dXJlX3JvdykNCiAgICAgICAgDQogICAgICAgICMgQ3JlYXRlIERhdGFGcmFtZSBmcm9tIGZlYXR1cmUgZGF0YQ0KICAgICAgICBmZWF0dXJlX2RmID0gcGQuRGF0YUZyYW1lKGZlYXR1cmVfZGF0YSkNCiAgICAgICAgDQogICAgICAgIHJldHVybiBmZWF0dXJlX2RmDQogICAgDQogICAgZGVmIGdldF9mZWF0dXJlX25hbWVzKHNlbGYpIC0+IExpc3Rbc3RyXToNCiAgICAgICAgIiIiDQogICAgICAgIEdldCBmZWF0dXJlIG5hbWVzDQogICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgTGlzdFtzdHJdOiBMaXN0IG9mIGZlYXR1cmUgbmFtZXMNCiAgICAgICAgIiIiDQogICAgICAgIHJldHVybiBzZWxmLmZlYXR1cmVfbmFtZXMg').decode())
