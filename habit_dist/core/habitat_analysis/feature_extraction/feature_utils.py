
import base64
exec(base64.b64decode(b'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoiIiINClV0aWxpdHkgZnVuY3Rpb25zIGZvciBoYWJpdGF0IGZlYXR1cmUgZXh0cmFjdGlvbg0KIiIiDQoNCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIExpc3QsIE9wdGlvbmFsDQppbXBvcnQgcGFuZGFzIGFzIHBkDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBsb2dnaW5nDQoNCmNsYXNzIEZlYXR1cmVVdGlsczoNCiAgICAiIiJVdGlsaXR5IGNsYXNzIGZvciBmZWF0dXJlIGV4dHJhY3Rpb24iIiINCiAgICANCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIGZsYXR0ZW5fZGljdChkOiBEaWN0W3N0ciwgQW55XSwgcGFyZW50X2tleTogc3RyID0gJycsIHNlcDogc3RyID0gJ18nKSAtPiBEaWN0W3N0ciwgQW55XToNCiAgICAgICAgIiIiDQogICAgICAgIEZsYXR0ZW4gYSBuZXN0ZWQgZGljdGlvbmFyeQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGQ6IERpY3Rpb25hcnkgdG8gZmxhdHRlbg0KICAgICAgICAgICAgcGFyZW50X2tleTogS2V5IG9mIHBhcmVudCBkaWN0aW9uYXJ5ICh1c2VkIGluIHJlY3Vyc2lvbikNCiAgICAgICAgICAgIHNlcDogU2VwYXJhdG9yIGJldHdlZW4ga2V5cyBpbiBmbGF0dGVuZWQgZGljdGlvbmFyeQ0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBEaWN0OiBGbGF0dGVuZWQgZGljdGlvbmFyeQ0KICAgICAgICAiIiINCiAgICAgICAgaXRlbXMgPSBbXQ0KICAgICAgICBmb3IgaywgdiBpbiBkLml0ZW1zKCk6DQogICAgICAgICAgICBuZXdfa2V5ID0gZiJ7cGFyZW50X2tleX17c2VwfXtrfSIgaWYgcGFyZW50X2tleSBlbHNlIGsNCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodiwgZGljdCk6DQogICAgICAgICAgICAgICAgaXRlbXMuZXh0ZW5kKEZlYXR1cmVVdGlscy5mbGF0dGVuX2RpY3QodiwgbmV3X2tleSwgc2VwPXNlcCkuaXRlbXMoKSkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgaXRlbXMuYXBwZW5kKChuZXdfa2V5LCB2KSkNCiAgICAgICAgcmV0dXJuIGRpY3QoaXRlbXMpDQogICAgDQogICAgQHN0YXRpY21ldGhvZA0KICAgIGRlZiBnZXRfbl9oYWJpdGF0c19mcm9tX2NzdihoYWJpdGF0X2ZvbGRlcjogc3RyKSAtPiBPcHRpb25hbFtpbnRdOg0KICAgICAgICAiIiINCiAgICAgICAgUmVhZCB0aGUgbnVtYmVyIG9mIGhhYml0YXRzIGZyb20gaGFiaXRhdHMuY3N2IGZpbGUNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICBoYWJpdGF0X2ZvbGRlcjogUGF0aCB0byB0aGUgZm9sZGVyIGNvbnRhaW5pbmcgaGFiaXRhdHMuY3N2DQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIGludDogTnVtYmVyIG9mIGhhYml0YXRzIGlmIGZvdW5kLCBOb25lIG90aGVyd2lzZQ0KICAgICAgICAiIiINCiAgICAgICAgaW1wb3J0IG9zDQogICAgICAgIA0KICAgICAgICB0cnk6DQogICAgICAgICAgICBjc3ZfcGF0aCA9IG9zLnBhdGguam9pbihoYWJpdGF0X2ZvbGRlciwgJ2hhYml0YXRzLmNzdicpDQogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhjc3ZfcGF0aCk6DQogICAgICAgICAgICAgICAgZGYgPSBwZC5yZWFkX2Nzdihjc3ZfcGF0aCkNCiAgICAgICAgICAgICAgICBpZiAnSGFiaXRhdHMnIGluIGRmLmNvbHVtbnM6DQogICAgICAgICAgICAgICAgICAgICMgQXNzdW1lIHRoZSBIYWJpdGF0cyBjb2x1bW4gY29udGFpbnMgaGFiaXRhdCBsYWJlbHMsIGNvdW50IHVuaXF1ZSB2YWx1ZXMNCiAgICAgICAgICAgICAgICAgICAgdW5pcXVlX2hhYml0YXRzID0gZGZbJ0hhYml0YXRzJ10ubnVuaXF1ZSgpDQogICAgICAgICAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmIlJlYWQge3VuaXF1ZV9oYWJpdGF0c30gaGFiaXRhdHMgZnJvbSBoYWJpdGF0cy5jc3YiKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5pcXVlX2hhYml0YXRzDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgbG9nZ2luZy5lcnJvcigiSGFiaXRhdHMgY29sdW1uIG5vdCBmb3VuZCBpbiBoYWJpdGF0cy5jc3YiKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiaGFiaXRhdHMuY3N2IGZpbGUgbm90IGZvdW5kOiB7Y3N2X3BhdGh9IikNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgbG9nZ2luZy5lcnJvcihmIkVycm9yIHJlYWRpbmcgaGFiaXRhdHMuY3N2OiB7c3RyKGUpfSIpDQogICAgICAgIA0KICAgICAgICByZXR1cm4gTm9uZQ0KICAgIA0KICAgIEBzdGF0aWNtZXRob2QNCiAgICBkZWYgY3JlYXRlX2VtcHR5X2RhdGFmcmFtZV9saWtlKHJlZmVyZW5jZV9kZjogcGQuRGF0YUZyYW1lLCBpbmRleDogTGlzdFtzdHJdID0gTm9uZSkgLT4gcGQuRGF0YUZyYW1lOg0KICAgICAgICAiIiINCiAgICAgICAgQ3JlYXRlIGFuIGVtcHR5IERhdGFGcmFtZSB3aXRoIHRoZSBzYW1lIHN0cnVjdHVyZSBhcyBhIHJlZmVyZW5jZSBEYXRhRnJhbWUNCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICByZWZlcmVuY2VfZGY6IFJlZmVyZW5jZSBEYXRhRnJhbWUgdG8gY29weSBzdHJ1Y3R1cmUgZnJvbQ0KICAgICAgICAgICAgaW5kZXg6IExpc3Qgb2YgaW5kZXggdmFsdWVzIGZvciB0aGUgbmV3IERhdGFGcmFtZQ0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBwZC5EYXRhRnJhbWU6IEVtcHR5IERhdGFGcmFtZSB3aXRoIHNhbWUgc3RydWN0dXJlIGFzIHJlZmVyZW5jZV9kZg0KICAgICAgICAiIiINCiAgICAgICAgaWYgaW5kZXggaXMgTm9uZToNCiAgICAgICAgICAgIGluZGV4ID0gWzBdDQogICAgICAgICAgICANCiAgICAgICAgcmV0dXJuIHBkLkRhdGFGcmFtZSgNCiAgICAgICAgICAgIGRhdGE9bnAubmFuLCANCiAgICAgICAgICAgIGluZGV4PWluZGV4LCANCiAgICAgICAgICAgIGNvbHVtbnM9cmVmZXJlbmNlX2RmLmNvbHVtbnMNCiAgICAgICAgKSA=').decode())
