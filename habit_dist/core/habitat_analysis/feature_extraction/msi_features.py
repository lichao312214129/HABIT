
import base64
exec(base64.b64decode(b'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoiIiINCk1TSSAoTXV0dWFsIFNwYXRpYWwgSW50ZWdyaXR5KSBGZWF0dXJlcyBFeHRyYWN0aW9uDQpUaGlzIG1vZHVsZSBwcm92aWRlcyBmdW5jdGlvbmFsaXR5IGZvciBleHRyYWN0aW5nIE1TSSBmZWF0dXJlcyBmcm9tIGhhYml0YXQgbWFwcw0KIiIiDQoNCmltcG9ydCBsb2dnaW5nDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBTaW1wbGVJVEsgYXMgc2l0aw0KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QNCg0KY2xhc3MgTVNJRmVhdHVyZUV4dHJhY3RvcjoNCiAgICAiIiJFeHRyYWN0b3IgY2xhc3MgZm9yIE1TSSBmZWF0dXJlcyIiIg0KICAgIA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2b3hlbF9jdXRvZmY9MTApOg0KICAgICAgICAiIiINCiAgICAgICAgSW5pdGlhbGl6ZSBNU0kgZmVhdHVyZSBleHRyYWN0b3INCiAgICAgICAgDQogICAgICAgIEFyZ3M6DQogICAgICAgICAgICB2b3hlbF9jdXRvZmY6IFZveGVsIHRocmVzaG9sZCBmb3IgZmlsdGVyaW5nIHNtYWxsIHJlZ2lvbnMgaW4gTVNJIGZlYXR1cmUgY2FsY3VsYXRpb24NCiAgICAgICAgIiIiDQogICAgICAgIHNlbGYudm94ZWxfY3V0b2ZmID0gdm94ZWxfY3V0b2ZmDQogICAgDQogICAgZGVmIGNhbGN1bGF0ZV9NU0lfbWF0cml4KHNlbGYsIGhhYml0YXRfYXJyYXk6IG5wLm5kYXJyYXksIHVuaXF1ZV9jbGFzczogaW50KSAtPiBucC5uZGFycmF5Og0KICAgICAgICAiIiINCiAgICAgICAgQ2FsY3VsYXRlIHRoZSBNU0kgbWF0cml4IGZyb20gaGFiaXRhdCBhcnJheQ0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIGhhYml0YXRfYXJyYXk6IEFycmF5IHJlcHJlc2VudGluZyB0aGUgaGFiaXRhdCBtYXANCiAgICAgICAgICAgIHVuaXF1ZV9jbGFzczogTnVtYmVyIG9mIGhhYml0YXQgY2xhc3NlcyAoaW5jbHVkaW5nIGJhY2tncm91bmQpDQogICAgICAgICAgICANCiAgICAgICAgUmV0dXJuczoNCiAgICAgICAgICAgIG1zaV9tYXRyaXg6IENhbGN1bGF0ZWQgTVNJIG1hdHJpeA0KICAgICAgICAiIiINCiAgICAgICAgIyBGaW5kIHRoZSBtaW5pbXVtIGJvdW5kaW5nIGJveCBvZiBub24temVybyByZWdpb25zIGluIGhhYml0YXRfYXJyYXkNCiAgICAgICAgcm9pX3osIHJvaV95LCByb2lfeCA9IG5wLndoZXJlKGhhYml0YXRfYXJyYXkgIT0gMCkNCiAgICAgICAgDQogICAgICAgIGlmIGxlbihyb2lfeikgPT0gMDoNCiAgICAgICAgICAgIGxvZ2dpbmcud2FybmluZygiTm8gbm9uLXplcm8gZWxlbWVudHMgZm91bmQgaW4gaGFiaXRhdCBhcnJheSIpDQogICAgICAgICAgICByZXR1cm4gbnAuemVyb3MoKHVuaXF1ZV9jbGFzcywgdW5pcXVlX2NsYXNzKSwgZHR5cGU9bnAuaW50NjQpDQogICAgICAgICAgICANCiAgICAgICAgel9taW4sIHpfbWF4ID0gbnAubWluKHJvaV96KSwgbnAubWF4KHJvaV96KQ0KICAgICAgICB5X21pbiwgeV9tYXggPSBucC5taW4ocm9pX3kpLCBucC5tYXgocm9pX3kpDQogICAgICAgIHhfbWluLCB4X21heCA9IG5wLm1pbihyb2lfeCksIG5wLm1heChyb2lfeCkNCg0KICAgICAgICAjIEV4dHJhY3QgZGF0YSB3aXRoaW4gdGhlIGJvdW5kaW5nIGJveA0KICAgICAgICBib3hfb2ZfVk9JID0gaGFiaXRhdF9hcnJheVt6X21pbjp6X21heCsxLCB5X21pbjp5X21heCsxLCB4X21pbjp4X21heCsxXQ0KICAgICAgICANCiAgICAgICAgIyBBZGQgYSBsYXllciBvZiB6ZXJvcyBhcm91bmQgdGhlIGJveCB0byBjYXB0dXJlIGJvdW5kYXJ5IGluZm9ybWF0aW9uDQogICAgICAgIGJveF9vZl9WT0kgPSBucC5wYWQoYm94X29mX1ZPSSwgKCgxLCAxKSwgKDEsIDEpLCAoMSwgMSkpLCAnY29uc3RhbnQnLCBjb25zdGFudF92YWx1ZXM9MCkNCg0KICAgICAgICAjIERlZmluZSAzRCBuZWlnaGJvcmhvb2QgKGZhY2UtY29ubmVjdGVkIG9ubHkpDQogICAgICAgIG5laWdoYm9yaG9vZF8zZF9jdWJlX29ubHkgPSBbDQogICAgICAgICAgICAoLTEsIDAsIDApLCAoMSwgMCwgMCksICAjIFVwIGFuZCBkb3duIG5laWdoYm9ycw0KICAgICAgICAgICAgKDAsIC0xLCAwKSwgKDAsIDEsIDApLCAgIyBMZWZ0IGFuZCByaWdodCBuZWlnaGJvcnMNCiAgICAgICAgICAgICgwLCAwLCAtMSksICgwLCAwLCAxKSAgICMgRnJvbnQgYW5kIGJhY2sgbmVpZ2hib3JzDQogICAgICAgIF0NCg0KICAgICAgICAjIEluaXRpYWxpemUgTVNJIG1hdHJpeA0KICAgICAgICBtc2lfbWF0cml4ID0gbnAuemVyb3MoKHVuaXF1ZV9jbGFzcywgdW5pcXVlX2NsYXNzKSwgZHR5cGU9bnAuaW50NjQpDQogICAgICAgIA0KICAgICAgICAjIFRyYXZlcnNlIHRoZSAzRCBpbWFnZSBhbmQgY291bnQgbmVpZ2hib3IgcmVsYXRpb25zaGlwcw0KICAgICAgICBmb3IgeiBpbiByYW5nZShib3hfb2ZfVk9JLnNoYXBlWzBdKTogIA0KICAgICAgICAgICAgZm9yIHkgaW4gcmFuZ2UoYm94X29mX1ZPSS5zaGFwZVsxXSk6ICANCiAgICAgICAgICAgICAgICBmb3IgeCBpbiByYW5nZShib3hfb2ZfVk9JLnNoYXBlWzJdKTogDQogICAgICAgICAgICAgICAgICAgICMgR2V0IGN1cnJlbnQgdm94ZWwgdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudF92b3hlbF92YWx1ZSA9IGJveF9vZl9WT0lbeiwgeSwgeF0NCg0KICAgICAgICAgICAgICAgICAgICAjIENoZWNrIGFsbCBuZWlnaGJvcnMNCiAgICAgICAgICAgICAgICAgICAgZm9yIGR6LCBkeSwgZHggaW4gbmVpZ2hib3Job29kXzNkX2N1YmVfb25seToNCiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yX3ogPSB6ICsgZHoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yX3kgPSB5ICsgZHkNCiAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yX3ggPSB4ICsgZHgNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgIyBDaGVjayBpZiBuZWlnaGJvciBpcyB3aXRoaW4gaW1hZ2UgYm91bmRzDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAwIDw9IG5laWdoYm9yX3ogPCBib3hfb2ZfVk9JLnNoYXBlWzBdIGFuZCBcDQogICAgICAgICAgICAgICAgICAgICAgICAwIDw9IG5laWdoYm9yX3kgPCBib3hfb2ZfVk9JLnNoYXBlWzFdIGFuZCBcDQogICAgICAgICAgICAgICAgICAgICAgICAwIDw9IG5laWdoYm9yX3ggPCBib3hfb2ZfVk9JLnNoYXBlWzJdOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5laWdoYm9yX3ZveGVsX3ZhbHVlID0gYm94X29mX1ZPSVtuZWlnaGJvcl96LCBuZWlnaGJvcl95LCBuZWlnaGJvcl94XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgVXBkYXRlIE1TSSBtYXRyaXgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2lfbWF0cml4W2N1cnJlbnRfdm94ZWxfdmFsdWUsIG5laWdoYm9yX3ZveGVsX3ZhbHVlXSArPSAxDQoNCiAgICAgICAgcmV0dXJuIG1zaV9tYXRyaXgNCg0KICAgIGRlZiBjYWxjdWxhdGVfTVNJX2ZlYXR1cmVzKHNlbGYsIG1zaV9tYXRyaXg6IG5wLm5kYXJyYXksIG5hbWU6IHN0cikgLT4gRGljdDoNCiAgICAgICAgIiIiDQogICAgICAgIENhbGN1bGF0ZSBNU0kgZmVhdHVyZXMgZnJvbSB0aGUgTVNJIG1hdHJpeA0KICAgICAgICANCiAgICAgICAgQXJnczoNCiAgICAgICAgICAgIG1zaV9tYXRyaXg6IE1TSSBtYXRyaXgNCiAgICAgICAgICAgIG5hbWU6IFByZWZpeCBmb3IgZmVhdHVyZSBuYW1lcw0KICAgICAgICAgICAgDQogICAgICAgIFJldHVybnM6DQogICAgICAgICAgICBEaWN0OiBDYWxjdWxhdGVkIE1TSSBmZWF0dXJlcw0KICAgICAgICAiIiINCiAgICAgICAgIyBBc3NlcnQgdGhhdCBtc2lfbWF0cml4IGlzIHNxdWFyZSBhbmQgY29udGFpbnMgbm8gbmVnYXRpdmUgdmFsdWVzDQogICAgICAgIGFzc2VydCBtc2lfbWF0cml4LnNoYXBlWzBdID09IG1zaV9tYXRyaXguc2hhcGVbMV0sIGYnbXNpX21hdHJpeCBvZiB7bmFtZX0gaXMgbm90IGEgc3F1YXJlIG1hdHJpeCcNCiAgICAgICAgYXNzZXJ0IG5wLmFsbChtc2lfbWF0cml4ID49IDApLCBmJ21zaV9tYXRyaXggb2Yge25hbWV9IGhhcyBuZWdhdGl2ZSB2YWx1ZScNCiAgICAgICAgDQogICAgICAgICMgRmlyc3Qtb3JkZXIgZmVhdHVyZXM6IFZvbHVtZSBvZiBlYWNoIHN1YnJlZ2lvbiAoZGlhZ29uYWwpIGFuZCBib3JkZXJzIG9mIHR3byBkaWZmZXJpbmcgc3VicmVnaW9ucyAob2ZmLWRpYWdvbmFsKQ0KICAgICAgICBmaXJzdG9yZGVyX2ZlYXR1cmUgPSB7fQ0KICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBtc2lfbWF0cml4LnNoYXBlWzBdKToNCiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKGkrMSwgbXNpX21hdHJpeC5zaGFwZVswXSk6DQogICAgICAgICAgICAgICAgZmlyc3RvcmRlcl9mZWF0dXJlWydmaXJzdG9yZGVyX3t9X2FuZF97fScuZm9ybWF0KGksIGopXSA9IG1zaV9tYXRyaXhbaSwgal0NCg0KICAgICAgICAjIENhbGN1bGF0ZSBkaWFnb25hbCBlbGVtZW50cywgZXhjbHVkaW5nIGJhY2tncm91bmQNCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMSwgbXNpX21hdHJpeC5zaGFwZVswXSk6DQogICAgICAgICAgICBmaXJzdG9yZGVyX2ZlYXR1cmVbJ2ZpcnN0b3JkZXJfe31fYW5kX3t9Jy5mb3JtYXQoaSwgaSldID0gbXNpX21hdHJpeFtpLCBpXQ0KDQogICAgICAgICMgTm9ybWFsaXplZCBmaXJzdC1vcmRlciBmZWF0dXJlcywgZGVub21pbmF0b3IgaW5jbHVkZXMgb25seSB0aGUgbG93ZXIgdHJpYW5ndWxhciBwYXJ0IGV4Y2x1ZGluZyB0aGUgZmlyc3QgZWxlbWVudA0KICAgICAgICBkZW5vbWluYXRvcl9tYXQgPSBucC50cmlsKG1zaV9tYXRyaXgsIGs9MCkNCiAgICAgICAgZGVub21pbmF0b3JfbWF0WzBdID0gMA0KICAgICAgICBkZW5vbWluYXRvciA9IG5wLnN1bShkZW5vbWluYXRvcl9tYXQpDQogICAgICAgIA0KICAgICAgICBpZiBkZW5vbWluYXRvciA9PSAwOg0KICAgICAgICAgICAgbG9nZ2luZy53YXJuaW5nKGYiTVNJIG1hdHJpeCBkZW5vbWluYXRvciBpcyAwIGZvciB7bmFtZX0sIGNhbm5vdCBjYWxjdWxhdGUgbm9ybWFsaXplZCBmZWF0dXJlcyIpDQogICAgICAgICAgICBub3JtYWxfbXNpX21hdHJpeCA9IG5wLnplcm9zX2xpa2UobXNpX21hdHJpeCwgZHR5cGU9ZmxvYXQpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBub3JtYWxfbXNpX21hdHJpeCA9IG1zaV9tYXRyaXggLyBkZW5vbWluYXRvcg0KICAgICAgICAgICAgDQogICAgICAgIGZpcnN0b3JkZXJfZmVhdHVyZV9ub3JtYWxpemVkID0ge30NCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbm9ybWFsX21zaV9tYXRyaXguc2hhcGVbMF0pOg0KICAgICAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSsxLCBub3JtYWxfbXNpX21hdHJpeC5zaGFwZVsxXSk6DQogICAgICAgICAgICAgICAgZmlyc3RvcmRlcl9mZWF0dXJlX25vcm1hbGl6ZWRbJ2ZpcnN0b3JkZXJfbm9ybWFsaXplZF97fV9hbmRfe30nLmZvcm1hdChpLCBqKV0gPSBub3JtYWxfbXNpX21hdHJpeFtpLCBqXQ0KDQogICAgICAgIGZvciBpIGluIHJhbmdlKDEsIG5vcm1hbF9tc2lfbWF0cml4LnNoYXBlWzBdKToNCiAgICAgICAgICAgIGZpcnN0b3JkZXJfZmVhdHVyZV9ub3JtYWxpemVkWydmaXJzdG9yZGVyX25vcm1hbGl6ZWRfe31fYW5kX3t9Jy5mb3JtYXQoaSwgaSldID0gbm9ybWFsX21zaV9tYXRyaXhbaSwgaV0NCiAgICAgICAgDQogICAgICAgICMgU2Vjb25kLW9yZGVyIGZlYXR1cmVzIGJhc2VkIG9uIG5vcm1hbGl6ZWQgTVNJIG1hdHJpeA0KICAgICAgICBwID0gbm9ybWFsX21zaV9tYXRyaXguY29weSgpDQogICAgICAgIA0KICAgICAgICAjIENhbGN1bGF0ZSBjb250cmFzdA0KICAgICAgICBpX2luZGljZXMsIGpfaW5kaWNlcyA9IG5wLmluZGljZXMocC5zaGFwZSkNCiAgICAgICAgY29udHJhc3QgPSBucC5zdW0oKGlfaW5kaWNlcyAtIGpfaW5kaWNlcykqKjIgKiBwKQ0KICAgICAgICANCiAgICAgICAgIyBDYWxjdWxhdGUgaG9tb2dlbmVpdHkNCiAgICAgICAgaG9tb2dlbmVpdHkgPSBucC5zdW0ocCAvICgxLjAgKyAoaV9pbmRpY2VzIC0gal9pbmRpY2VzKSoqMikpDQogICAgICAgIA0KICAgICAgICAjIENhbGN1bGF0ZSBjb3JyZWxhdGlvbg0KICAgICAgICBweCA9IG5wLnN1bShwLCBheGlzPTEpDQogICAgICAgIHB5ID0gbnAuc3VtKHAsIGF4aXM9MCkNCiAgICAgICAgDQogICAgICAgIHV4ID0gbnAuc3VtKHB4ICogbnAuYXJhbmdlKGxlbihweCkpKQ0KICAgICAgICB1eSA9IG5wLnN1bShweSAqIG5wLmFyYW5nZShsZW4ocHkpKSkNCiAgICAgICAgDQogICAgICAgIHNpZ21heCA9IG5wLnNxcnQobnAuc3VtKHB4ICogKG5wLmFyYW5nZShsZW4ocHgpKSAtIHV4KSoqMikpDQogICAgICAgIHNpZ21heSA9IG5wLnNxcnQobnAuc3VtKHB5ICogKG5wLmFyYW5nZShsZW4ocHkpKSAtIHV5KSoqMikpDQogICAgICAgIA0KICAgICAgICBpZiBzaWdtYXggPiAwIGFuZCBzaWdtYXkgPiAwOg0KICAgICAgICAgICAgc3VtX3BfaWogPSBucC5zdW0ocCAqIGlfaW5kaWNlcyAqIGpfaW5kaWNlcykNCiAgICAgICAgICAgIGNvcnJlbGF0aW9uID0gKHN1bV9wX2lqIC0gdXggKiB1eSkgLyAoc2lnbWF4ICogc2lnbWF5KQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgY29ycmVsYXRpb24gPSAxLjANCiAgICAgICAgDQogICAgICAgICMgQ2FsY3VsYXRlIGVuZXJneQ0KICAgICAgICBlbmVyZ3kgPSBucC5zdW0ocCoqMikNCiAgICAgICAgDQogICAgICAgIHNlY29uZG9yZGVyX2ZlYXR1cmUgPSB7IA0KICAgICAgICAgICAgJ2NvbnRyYXN0JzogY29udHJhc3QsDQogICAgICAgICAgICAnaG9tb2dlbmVpdHknOiBob21vZ2VuZWl0eSwNCiAgICAgICAgICAgICdjb3JyZWxhdGlvbic6IGNvcnJlbGF0aW9uLA0KICAgICAgICAgICAgJ2VuZXJneSc6IGVuZXJneQ0KICAgICAgICB9DQoNCiAgICAgICAgIyBDb21iaW5lIGFsbCBmZWF0dXJlcw0KICAgICAgICBtc2lfZmVhdHVyZSA9IHsqKmZpcnN0b3JkZXJfZmVhdHVyZSwgKipmaXJzdG9yZGVyX2ZlYXR1cmVfbm9ybWFsaXplZCwgKipzZWNvbmRvcmRlcl9mZWF0dXJlfQ0KICAgICAgICByZXR1cm4gbXNpX2ZlYXR1cmUNCg0KICAgIGRlZiBleHRyYWN0X01TSV9mZWF0dXJlcyhzZWxmLCBoYWJpdGF0X3BhdGg6IHN0ciwgbl9oYWJpdGF0czogaW50LCBzdWJqOiBzdHIpIC0+IERpY3Q6DQogICAgICAgICIiIg0KICAgICAgICBFeHRyYWN0IE1TSSBmZWF0dXJlcyBmcm9tIGEgc2luZ2xlIGhhYml0YXQgbWFwDQogICAgICAgIA0KICAgICAgICBBcmdzOg0KICAgICAgICAgICAgaGFiaXRhdF9wYXRoOiBQYXRoIHRvIHRoZSBoYWJpdGF0IG1hcCBmaWxlDQogICAgICAgICAgICBuX2hhYml0YXRzOiBOdW1iZXIgb2YgaGFiaXRhdHMNCiAgICAgICAgICAgIHN1Ymo6IFN1YmplY3QgSUQNCiAgICAgICAgICAgIA0KICAgICAgICBSZXR1cm5zOg0KICAgICAgICAgICAgRGljdDogRXh0cmFjdGVkIE1TSSBmZWF0dXJlcw0KICAgICAgICAiIiINCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgaW1nID0gc2l0ay5SZWFkSW1hZ2UoaGFiaXRhdF9wYXRoKQ0KICAgICAgICAgICAgYXJyYXkgPSBzaXRrLkdldEFycmF5RnJvbUltYWdlKGltZykNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdW5pcXVlX2NsYXNzID0gbl9oYWJpdGF0cysxICAjIE51bWJlciBvZiBoYWJpdGF0cyArIDEgKGluY2x1ZGluZyBiYWNrZ3JvdW5kKQ0KDQogICAgICAgICAgICAjIENhbGN1bGF0ZSBNU0kgbWF0cml4DQogICAgICAgICAgICBtc2lfbWF0cml4ID0gc2VsZi5jYWxjdWxhdGVfTVNJX21hdHJpeChhcnJheSwgdW5pcXVlX2NsYXNzKQ0KDQogICAgICAgICAgICAjIENhbGN1bGF0ZSBNU0kgZmVhdHVyZXMNCiAgICAgICAgICAgIG1zaV9mZWF0dXJlID0gc2VsZi5jYWxjdWxhdGVfTVNJX2ZlYXR1cmVzKG1zaV9tYXRyaXgsIHN1YmopDQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiBtc2lfZmVhdHVyZQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBsb2dnaW5nLmVycm9yKGYiRXJyb3IgZXh0cmFjdGluZyBNU0kgZmVhdHVyZXMgZm9yIHN1YmplY3Qge3N1Ymp9OiB7c3RyKGUpfSIpDQogICAgICAgICAgICByZXR1cm4geyJlcnJvciI6IHN0cihlKX0g').decode())
